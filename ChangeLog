2006-03-02 23:16  gb

	* compiler/arch.lisp: add big-endian field to target-arch.

2006-03-02 23:16  gb

	* compiler/PPC/: PPC32/ppc32-arch.lisp, PPC64/ppc64-arch.lisp: Big
	endian.

2006-03-02 23:14  gb

	* compiler/X86/: X8664/x8664-vinsns.lisp, x862.lisp: &lexpr stuff,
	mostly.

2006-03-02 23:14  gb

	* compiler/X86/X8664/x8664-arch.lisp: We're not big-endian.

2006-03-02 23:13  gb

	* lib/macros.lisp: Comment formatting.

2006-03-02 23:12  gb

	* level-0/: l0-cfm-support.lisp, l0-hash.lisp, l0-init.lisp,
	l0-io.lisp, l0-misc.lisp, l0-numbers.lisp, l0-pred.lisp,
	l0-symbol.lisp, l0-utils.lisp, nfasload.lisp: Conditionalization
	changes.

2006-03-02 23:11  gb

	* lisp-kernel/thread_manager.c: Change thread creation/activation,
	so that new_tcr() call happens on the new thread.

2006-03-02 22:51  gb

	* lisp-kernel/Threads.h: Fix new_tcr() prototype.  Why did this
	compile in FreeBSD/x86-64 ?

2006-03-02 22:28  gb

	* lisp-kernel/freebsd8664/Makefile: Depend on the linker script. 
	Use some make variables to make changing/ ignoring that script
	easier.

2006-03-02 22:27  gb

	* lisp-kernel/thread_manager.c: Conditionalize some for FreeBSD.

2006-03-02 22:27  gb

	* lisp-kernel/pmcl-kernel.c: FreeBSD can also map (at least) 512GB.
	
	Not sure how to get real name of executable in FreeBSd, so use
	argv[0] for now.
	
	CPUID instruction returns cache block size in ebx, not eax.

2006-03-02 22:25  gb

	* lisp-kernel/freebsd8664/elf_x86_64.x: Output file wasn't
	executable if subprims were mapped to low memory; map them to a
	fixed address (0x410000).  Will need to change subprims base in
	arch definition, and things (bad_funcall) that may depend on it.

2006-03-02 19:19  gb

	* lisp-kernel/x86-spentry64.s: Try to avoid use of %temp0 (which
	may contain next_method_context); use %temp1 instead.

2006-03-02 19:18  gb

	* lisp-kernel/x86-constants64.s: next_method_context is temp0, not
	temp1 (according to lisp).

2006-03-01 12:42  gb

	* level-0/nfasload.lisp: One lousy missing #\)!  All this fuss over
	one lousy missing #\) !

2006-03-01 12:39  gb

	* xdump/faslenv.lisp: Define $fasl-clfun.

2006-03-01 12:38  gb

	* level-1/ppc-threads-utils.lisp: Rename %FIXNUM-SET-U32 ->
	%FIXNUM-SET-NATURAL.

2006-03-01 12:37  gb

	* level-0/X86/x86-def.lisp: Translate most of this, except for the
	lexpr stuff.

2006-03-01 12:37  gb

	* level-0/PPC/ppc-def.lisp: Delete a few things that seem to be
	totally unused.  Rename %FIXNUM-SET-U32 -> %FIXNUM-SET-NATURAL.

2006-03-01 12:36  gb

	* level-0/nfasload.lisp: $fasl-clfun.

2006-03-01 12:33  gb

	* compiler/X86/: x862.lisp, X8664/x8664-vinsns.lisp: %ilogbitp,
	inline multiplication.

2006-03-01 12:32  gb

	* compiler/X86/x86-lap.lisp: %define-x86-lap-function: "function
	creator" isn't a parameter, so signature matches what the compiler
	expects.

2006-03-01 12:31  gb

	* compiler/X86/x86-asm.lisp: Insert register operand correctly in
	immeditate bt/btc/btr/bts.  Some imul variants (at least the
	64/32/16-bit versions.)

2006-03-01 12:19  gb

	* compiler/nx1.lisp: Don't require SPARC-LAP in nx-x86-lap-function
	...

2006-02-28 19:46  gb

	* compiler/X86/x862.lisp: Always build/ensure that a frame exists
	before calling a subprim.  Handle &key, other/harder &optional
	cases.
	
	Todo: &lexpr, %ilogbitp, ??

2006-02-28 19:44  gb

	* compiler/X86/X8664/x8664-vinsns.lisp: &optional defaulting and
	supplied-p handling; keywords subprims.

2006-02-28 19:43  gb

	* level-1/l1-reader.lisp: Signal IMPOSSIBLE-NUMBER conditions if
	parsing an potential number yields an ARITHMETIC-ERROR.

2006-02-28 19:43  gb

	* level-1/l1-error-system.lisp: Define IMPOSSIBLE-NUMBER as a
	subtype of READER-ERROR.

2006-02-28 19:42  gb

	* lib/numbers.lisp: If we'd get overflow or underflow when creating
	a float and the corresponding exception is enabled, generate the
	appropriate condition rather than CERRORing unconditionally.

2006-02-28 19:40  gb

	* lib/macros.lisp: Use target-word-size-case in %ilogbitp.

2006-02-28 19:37  gb

	* lisp-kernel/x86-spentry64.s: stkconslist, stkconslist_star,
	mkstackv, fix in heap_cons_rest_arg, simple_keywords, keyword_args,
	keyword_bind, fix in stack_cons_rest_arg, spreadargz, tfuncallgen,
	tfuncallslide,tfuncallvsp,tcallsymgen, tcallsymslide, tcallsymvsp,
	tcallnfngen, tcallnfnslide, tcallnfnvsp.
	
	todo: ffcall, syscall, callback, lexprs.

2006-02-28 19:33  gb

	* lisp-kernel/x86-macros.s: compare_reg_to_nil, discard_temp_frame.

2006-02-28 19:32  gb

	* lisp-kernel/x86-constants64.s: function_header_offset,
	function_data_offset

2006-02-28 19:32  gb

	* lisp-kernel/x86-constants64.h: TCR flags are a natural.

2006-02-28 19:31  gb

	* lisp-kernel/x86-constants64.h: TCR flags are unsigned.

2006-02-28 19:31  gb

	* lisp-kernel/x86-constants.h: TCR flags.

2006-02-28 19:31  gb

	* lisp-kernel/ppc-spentry.s: Fix comment (have never used temp0 for
	closure data).

2006-02-27 14:14  gb

	* compiler/PPC/ppc2.lisp: Hadn't saved the buffer; ppc2-%aset2
	changes were incomplete.

2006-02-26 23:30  gb

	* lisp-kernel/pmcl-kernel.c: Suppress compiler warning.

2006-02-26 22:51  gb

	* release-notes.txt: Update.

2006-02-26 22:51  gb

	* level-1/: l1-application.lisp, l1-boot-lds.lisp,
	l1-lisp-threads.lisp: Exercise more control over the stack sizes of
	listener threads (especially the initial listener.)
	
	(The --thread-stack-size argument affects the size of the initial
	listener's stacks only.)

2006-02-26 22:49  gb

	* lisp-kernel/pmcl-kernel.c: Fix the usage message.

2006-02-26 21:58  gb

	* lisp-kernel/pmcl-kernel.c: Split --stack-size and
	--thread-stack-size args, to avoid rlimit problems (and because
	they're really separate issues.)

2006-02-26 21:23  gb

	* lib/macros.lisp: Remove (most) support for tracing callbacks. 
	(Having the functionality isn't a bad idea, but the way that it was
	implemented made the code hard to read and maintain.  Maybe redo
	this.)

2006-02-26 21:21  gb

	* lisp-kernel/pmcl-kernel.c: Can't reserve 512GB on LinuxPPC64; try
	256GB instead.

2006-02-26 20:59  gb

	* level-1/version.lisp: Bump.

2006-02-26 20:37  gb

	* lisp-kernel/: darwinppc/Makefile, darwinppc64/Makefile: Restore
	COPT setting, clobbered on last (accidental) checkin.

2006-02-26 20:35  gb

	* lisp-kernel/lisp_globals.h: stack-size global

2006-02-26 20:35  gb

	* lisp-kernel/ppc-asmutils.s: atomic_and

2006-02-26 20:35  gb

	* lisp-kernel/pmcl-kernel.c: more mappable memory on 64-bit
	platforms.  Set stack-size global from command line arg

2006-02-26 20:35  gb

	* lisp-kernel/gc.c: check_range() takes a headers_allowed arg (not
	allowed on vsp).  Some debugging fprintfs.

2006-02-26 20:35  gb

	* lisp-kernel/: ppc-constants32.h, ppc-constants64.h: tcr flags are
	natural

2006-02-26 20:35  gb

	* lisp-kernel/ppc-exceptions.c: fixes in pc_luser_xp. Defer
	exceptions if we don't have the lock on Darwin

2006-02-26 20:35  gb

	* lisp-kernel/thread_manager.c: simpler suspend ack, other changes,
	heavy, unreadable conditionalization

2006-02-26 20:35  gb

	* lisp-kernel/: plbt.c, plsym.c: bug fixes

2006-02-26 20:35  gb

	* lisp-kernel/ppc-spentry.s: change defs of C write-barrier exports

2006-02-26 20:35  gb

	* lisp-kernel/: darwinppc64/Makefile, darwinppc/Makefile,
	Threads.h, bits.h: Prototype atomic_and(), atomic_ior() here.  Use
	them to set/clear TCR flag bits.

2006-02-26 20:34  gb

	* lib/encapsulate.lisp: Print trace level in trace output.

2006-02-26 20:34  gb

	* lib/compile-ccl.lisp: Add :reload-arguments arg to REBUILD-CCL.

2006-02-26 20:33  gb

	* level-1/l1-lisp-threads.lisp: Adjust default stack sizes based on
	--stack-size argument.

2006-02-26 20:32  gb

	* level-0/l0-misc.lisp: ROOM: don't report hons-space size if it's
	0.

2006-02-26 20:32  gb

	* level-0/l0-array.lisp: Use #+64-bit-target instead of
	#+ppc64-target in a few places.

2006-02-26 20:31  gb

	* examples/hons-example.lisp: Still needs work, but not quite so
	brain-dead.

2006-02-26 20:30  gb

	* compiler/X86/X8664/x8664-vinsns.lisp: A few bug fixes.

2006-02-26 20:30  gb

	* compiler/X86/x862.lisp: Fix typos in unwind-protect; use the same
	general scheme for PROGV.

2006-02-26 20:29  gb

	* compiler/PPC/ppc2.lisp: In PPC2-%ASET2, typename is quoted in
	acode.

2006-02-26 20:28  gb

	* compiler/PPC/ppc-arch.lisp: Replace BAD-CURRENT-VS global with
	STACK-SIZE.

2006-02-16 15:49  gb

	* lisp-kernel/thread_manager.c: Wait for acknowledgement after
	suspend_tcr.  Probably needs some testing, but this may be the
	right approach.

2006-02-16 15:48  gb

	* lisp-kernel/ppc-exceptions.c: catch_exception_raise maintains
	TCR_FLAG_BIT_PENDING_EXCEPTION.  (There's also some half-finished
	Mach-based code here for doing interrupts via suspend/resume, but
	it's probably a bad idea.)

2006-02-16 15:45  gb

	* lisp-kernel/ppc-constants.h: Define a few more tcr flags.

2006-02-14 23:56  gb

	* compiler/PPC/ppc-asm.lisp: Define LWSYNC.  Less sure how to tell
	if it's available.

2006-02-14 23:51  gb

	* level-1/l1-lisp-threads.lisp: Define GET-INTERNAL-REAL-TIME here;
	define GET-TICK-COUNT in terms of it (less likely to cons.)
	
	Define %TCR-INTERRUPT, so the lisp doesn't know how the guts of
	PROCESS-INTERRUPT are implemented (and so the kernel does.)

2006-02-14 23:49  gb

	* lib/time.lisp: Define GET-INTERNAL-REAL-TIME earlier in the load
	sequence.

2006-02-14 23:48  gb

	* compiler/: PPC/PPC32/ppc32-arch.lisp, PPC/PPC64/ppc64-arch.lisp,
	X86/X8664/x8664-arch.lisp: Replace unused condemn-area kernel
	global with raise-thread-interrupt.

2006-02-14 23:47  gb

	* lisp-kernel/imports.s: Export raise_thread_interrupt.

2006-02-14 23:47  gb

	* lisp-kernel/thread_manager.c: Define raise_thread_interrupt.

2006-02-14 03:23  gb

	* lisp-kernel/thread_manager.c: Try using Mach suspend/resume
	again.

2006-02-14 03:20  gb

	* compiler/X86/: x862.lisp, X8664/x8664-vinsns.lisp: default
	&optionals, unwind-protect: push %ra0 "manually".

2006-02-14 03:17  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp: New inline
	REF-SYMBOL-VALUE: don't use a 64-bit trap on ppc32.

2006-02-13 22:29  gb

	* lisp-kernel/gc.c: Conditionalize references to subtag_code_vector
	in purify(),impurify(); code_vectors don't exist on X8664, and
	purify()/impurify() will have to do something different there.

2006-02-13 21:01  gb

	* compiler/X86/X8664/x8664-vinsns.lisp: Closure & vcell stuff, some
	logical ops, tail funcall with no stack args.  Funcall inline.

2006-02-13 20:58  gb

	* compiler/X86/x862.lisp: Closure & vcell stuff, some logical ops,
	tail funcall.

2006-02-13 20:57  gb

	* compiler/X86/x86-arch.lisp: Add bad-funcall kernel global for x86
	funcall.

2006-02-13 20:53  gb

	* lisp-kernel/x86-spentry64.s: Lots-o-stuff (misc_set, etc.)

2006-02-13 20:52  gb

	* lisp-kernel/x86-spjump64.s: Pad jump table to page boundary, so
	bad_funcall() has a known address.

2006-02-13 20:51  gb

	* lisp-kernel/x86-macros.s: new do_funcall().

2006-02-13 20:51  gb

	* lisp-kernel/x86-constants64.s: Define tag_single_float.

2006-02-13 20:50  gb

	* lisp-kernel/pmcl-kernel.c: Setup BAD_FUNCALL, for x86 funcall.

2006-02-13 20:50  gb

	* lisp-kernel/: lisp_globals.h, x86-constants.s: BAD_FUNCALL, for
	x86 funcall.

2006-02-13 20:49  gb

	* compiler/X86/x86-asm.lisp: Don't generate REX prefix on
	uuo_error_vector_bound unless we need one.

2006-02-13 14:32  gb

	* lisp-kernel/gc.c: last change broke purify on ppc too, back out
	of it

2006-02-13 00:18  gb

	* compiler/X86/x862.lisp: More stuff.

2006-02-13 00:15  gb

	* compiler/X86/X8664/x8664-vinsns.lisp: use rcmp aliases for
	comparisons when testing for testing for other than equality.

2006-02-13 00:14  gb

	* compiler/X86/x86-asm.lisp: rcmp aliases for all "cmp[bwlq]"
	instructions.

2006-02-13 00:13  gb

	* compiler/PPC/ppc2.lisp: Always open an undo-frame for
	%stack-block, even if the "zero" flag is variable.

2006-02-13 00:11  gb

	* lisp-kernel/x86-spentry64.s: More stuff.  Getting there ...

2006-02-13 00:11  gb

	* lisp-kernel/x86-macros.s: aligned_bignum_size

2006-02-13 00:10  gb

	* lisp-kernel/x86-constants64.s: target fixnum limits.

2006-02-12 23:08  gb

	* compiler/X86/X8664/x8664-vinsns.lisp: Fix
	%set-z-flag-if-u64-fits-in-fixnum.

2006-02-12 21:42  gb

	* lisp-kernel/x86-spentry64.s: Every day, more stuff.

2006-02-12 21:41  gb

	* lisp-kernel/x86-macros.s: Add a few things, work around $
	conflation.

2006-02-12 21:40  gb

	* lisp-kernel/x86-uuo.s: add uuo_error_reg_not_fixnum.

2006-02-12 21:39  gb

	* lisp-kernel/x86-constants.s: define tstack_alloc_limit.

2006-02-12 15:58  gb

	* level-1/l1-numbers.lisp: NEW-NUMTOKEN: don't allow leading sign
	on denominator when trying to parse a ratio.

2006-02-11 19:56  gb

	* lisp-kernel/x86-subprims64.s: start_lisp, toplevel_loop.

2006-02-11 19:55  gb

	* lisp-kernel/x86-spentry64.s: funcall does so.

2006-02-11 19:55  gb

	* lisp-kernel/: x86-constants64.h, x86-constants64.s: Lose
	code_vector subtag; renumber things so that subtag_double_float has
	lower value.

2006-02-11 19:54  gb

	* lisp-kernel/ppc-subprims.s: Rewrite comment "clarifying" what
	toplevel_loop does.

2006-02-11 19:54  gb

	* lisp-kernel/x86-constants.s: define TCR states.

2006-02-11 19:53  gb

	* lisp-kernel/x86-macros.s: fix do_funcall().

2006-02-11 19:53  gb

	* lisp-kernel/x86_print.c: Don't reference subtag_code_vector.

2006-02-11 19:53  gb

	* lisp-kernel/gc.c: Don't reference subtag_code_vector in
	purify/etc on x8664.

2006-02-11 19:52  gb

	* lib/macros.lisp: Setf inverses for unsigned memory accessors.

2006-02-11 19:51  gb

	* lib/level-2.lisp: eval-redefs for unsigned memory setters.

2006-02-11 19:51  gb

	* level-0/l0-pred.lisp: Start to conditionalize for #+x8664-target.

2006-02-11 19:51  gb

	* compiler/X86/X8664/x8664-vinsns.lisp: REQUIRE-type primitives,
	more stuff, bug fixes.

2006-02-11 19:50  gb

	* compiler/X86/X8664/x8664-arch.lisp: No code-vector.  Renumber
	things, so that SUBTAG-DOUBLE-FLOAT has a smaller value.

2006-02-11 19:50  gb

	* compiler/X86/x862.lisp: Use fp1 (arbitrarily), not fp0 when
	setting double-float vector elements.

2006-02-11 19:49  gb

	* compiler/X86/x86-disassemble.lisp: Tab out further when printing
	instruction address.

2006-02-11 19:48  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: Fix error trap in
	REQUIRE-REAL.

2006-02-11 19:48  gb

	* compiler/nx1.lisp: Memory-setting primitives come in signed and
	unsigned flavors.

2006-02-11 03:34  gb

	* lisp-kernel/x86-spentry64.s: _SPmakes64: more svelte, less buggy.

2006-02-11 03:32  gb

	* level-1/version.lisp: Bump.

2006-02-11 03:32  gb

	* compiler/X86/: X8664/x8664-vinsns.lisp, x862.lisp: Lots-o-stuff:
	most vector access & assignment, etc.  (Some cases need more
	testing, since PPC code this is based on assumed more imm temp
	registers and it's easy to run out when there are only 2 of them.)

2006-02-11 03:30  gb

	* compiler/X86/X8664/x8664-arch.lisp: Cache the foreign SP in %mm5.

2006-02-11 03:29  gb

	* compiler/X86/x86-backend.lisp: Match use of dedicate shift-count
	register (%cl) via :%SHIFT.
	
	It's 2006.  Why do processors have dedicated shift-count registers
	?

2006-02-11 03:28  gb

	* compiler/PPC/ppc2.lisp: Don't call UVREF to access value of
	single-float vector, since single-floats are immediate on 64-bit
	platforms.

2006-02-11 03:26  gb

	* compiler/optimizers.lisp: CHAR-EQUAL.

2006-02-11 03:26  gb

	* compiler/nx0.lisp: ACODE-INTEGER-CONSTANT-P, which may have been
	a bad idea.

2006-02-10 14:07  gb

	* compiler/X86/X8664/x8664-vinsns.lisp: More stuff, especially for
	vector reference.

2006-02-10 14:06  gb

	* compiler/X86/x862.lisp: Propagate some ppc backend fixes; get
	vref working.

2006-02-10 14:05  gb

	* compiler/X86/x86-asm.lisp: setc is an alias for setb.

2006-02-10 14:04  gb

	* compiler/X86/X8664/x8664-arch.lisp: :SINGLE-FLOAT-VECTOR is a
	32-bit ivector type. :SINGLE-FLOAT isn't.

2006-02-10 14:03  gb

	* compiler/PPC/: PPC32/ppc32-arch.lisp, PPC64/ppc64-arch.lisp:
	:SINGLE-FLOAT-VECTOR is a 32-bit ivector type.

2006-02-09 23:55  gb

	* lib/compile-ccl.lisp: Add a :FULL option to REBUILD-CCL.

2006-02-09 23:50  gb

	* lisp-kernel/gc.c: Fix calculation of static_dnodes_for_area (was
	unmapping the wrong memory when dynamic area shrunk.)
	
	Maybe be verbose about GC activity.

2006-02-09 23:48  gb

	* lisp-kernel/thread_manager.c: Disable mach_suspend_tcr again. 
	Mach sucks.

2006-02-09 23:47  gb

	* library/lispequ.lisp, lisp-kernel/ppc-constants32.h,
	lisp-kernel/ppc-constants64.h, lisp-kernel/x86-constants64.h:
	Define constant bits for GC verbosity.

2006-02-09 23:46  gb

	* lib/macros.lisp: For thing that actually macroexpand %SVSET and
	%SET-SCHAR, don't evaluate the new value inside the OPTIMIZE
	declarations.  (COMPILE-FILE does this macroexpansion; COMPILE does
	its own handling of these SETF inverses.)

2006-02-09 23:44  gb

	* lib/ccl-export-syms.lisp: Export GC-VERBOSE, GC-VERBOSE-P.

2006-02-09 23:44  gb

	* level-1/l1-aprims.lisp: Add GC-VERBOSE, GC-VERBOSE-P.

2006-02-09 23:43  gb

	* compiler/PPC/: PPC32/ppc32-vinsns.lisp, PPC64/ppc64-vinsns.lisp:
	MISC-NODE-SET without EGC checks.  Open-code special reference.

2006-02-09 23:42  gb

	* compiler/PPC/ppc2.lisp: Avoid EGC write-barrier checks when
	storing some types of things in node vectors.  Try to do special
	variable lookup inline (helps a little).

2006-02-09 23:40  gb

	* compiler/nx0.lisp: vcell, fcell refs are loop-weighted.

2006-02-09 23:38  gb

	* lisp-kernel/x86-spentry64.s: Most of throw, nthrow.

2006-02-05 22:20  gb

	* lisp-kernel/thread_manager.c: suspend_other_threads() and
	resume_other_threads() take a Boolean "for_gc" arg. 
	lisp_suspend_other_threads() and lisp_resume_other_threads()
	defined here, pass false to the underlying function.

2006-02-05 22:19  gb

	* lisp-kernel/lisp-debug.c: suspend_other_threads() and
	resume_other_threads() take a Boolean "for_gc" arg.   Pass false
	here.

2006-02-05 22:18  gb

	* lisp-kernel/ppc-exceptions.c: suspend_other_threads() and
	resume_other_threads() take a Boolean "for_gc" arg.   Pass true
	here.

2006-02-05 22:18  gb

	* lisp-kernel/lisp-exceptions.h: suspend_other_threads() and
	resume_other_threads() take a Boolean "for_gc" arg.

2006-02-05 22:17  gb

	* lisp-kernel/imports.s: provide lisp_suspend_other_threads() and
	"lisp_resume_other_threads() to lisp.

2006-02-03 07:03  gb

	* lisp-kernel/thread_manager.c: Mach exception lock is a
	pthread_mutex_t *; lock it around suspend/resume.
	
	Enable Mach suspend/suspend resume code, on the assumption that it
	(finally) works reliably.

2006-02-03 07:02  gb

	* lisp-kernel/ppc-exceptions.c: Mach exception lock is a
	pthread_mutex_t *; don't lock it reentrantly.  Define a "demux"
	routine for exception messages, though this probably wasn't
	necessary.
	
	allocptr_displacement needs to be signed_natural, not just an int
	(for ppc64.)
	
	Don't call the (fake) sigcontext a "linux sigcontext struct";
	that's just confusing.	(Rename variables "lss" ->
	"pseudosigcontext".)
	
	In mach_suspend_tcr(), use thread_abort_safely(), recognizing that
	it can have transient failures (including exception messages.) Keep
	trying until pending syscalls are aborted.
	
	Not all of this is really necessary; the old Mach lock_set either
	wasn't getting created correctly, or Mach lock_sets just don't
	work.	Need to ensure that thread_suspension uses the same lock as
	the exception thread does.

2006-02-03 06:53  gb

	* lisp-kernel/ppc-exceptions.h: More Mach exception stuff here. 
	Mach exception lock is a pthread_mutex_t *.

2006-02-03 06:52  gb

	* lisp-kernel/gc.c: Casts in vm_copy call.  (Check these on ppc64
	?).

2006-02-01 05:21  gb

	* lisp-kernel/x86-macros.s: Get tra right; tsp
	allocation/dnode_align stuff.

2006-02-01 05:19  gb

	* lisp-kernel/ppc-spentry.s: comment format

2006-02-01 04:45  gb

	* lisp-kernel/ppc-spentry.s: On return from ff-call, ensure that
	allocptr/allocbase have harmless values before asserting
	TCR_STATE_LISP.

2006-01-31 17:07  gb

	* lisp-kernel/thread_manager.c: Tried a few (conditionalized)
	things to make resume_tcr more reliable; currently, using the
	tcr->resume semaphore seems more reliable than sigsuspend when
	there are lots of active threads.

2006-01-31 17:05  gb

	* lisp-kernel/ppc-macros.s: Zero_TSP_Frame and Zero_TSP_Frame_nz:
	don't zero the frame.type on PPC64.

2006-01-31 17:04  gb

	* lisp-kernel/lisptypes.h: Fix conditinal definition of
	ExceptionInformation

2006-01-31 14:39  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: remove extra blank line.

2006-01-31 14:38  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: UNBOX-S64: get error right.

2006-01-31 14:37  gb

	* compiler/PPC/ppc2.lisp: In PPC2-VREF, in the :SIGNED-BYTE-64 case
	where the index is constant, load into the temporary S64-REG, not
	RZERO!

2006-01-30 19:48  gb

	* lisp-kernel/x86-macros.s: If using "modern" GAS, quote
	expressions in recursive macro calls.

2006-01-30 19:47  gb

	* lisp-kernel/m4macros.m4: __endfn undefines __func_name

2006-01-30 06:59  gb

	* lisp-kernel/: x86-constants64.s, x86-macros.s, x86-spentry64.s:
	More stuff.

2006-01-30 06:59  gb

	* lisp-kernel/ppc-spentry.s: Move a comment.

2006-01-30 02:39  gb

	* lisp-kernel/: lisptypes.h, m4macros.m4, pmcl-kernel.c,
	thread_manager.c, x86-constants64.h, x86-exceptions.h,
	x86-macros.s, x86-spentry64.s, Threads.h, area.h, bits.h, gc.c,
	lisp.h: Conditionalize for FreeBSD/x86-64.

2006-01-30 02:39  gb

	* lisp-kernel/freebsd8664/: Makefile, elf_x86_64.x: New files.
	
	FreeBSD make (and gmake) both want to rebuild all .s files, but
	this otherwise seems to work.

2006-01-29 20:38  gb

	* lisp-kernel/: x86-spentry64.s, x86-constants64.s, x86-macros.s,
	x86-uuo.s: May not even compile at the moment, but (a) my AMD64
	laptop's disk is acting flaky and (b) a new AMD64 X2 dual-core box
	has a weird Windows-centric motherboard and I'm having trouble
	getting Linux running on it.
	
	Any questions ?

2006-01-28 15:37  gb

	* lisp-kernel/: x86-constants64.s, x86-macros.s, x86-spentry64.s:
	Check in some stuff that's not ready yet; HW problems on x86-64
	box.

2006-01-28 02:52  gb

	* compiler/X86/X8664/x8664-vinsns.lisp: Some consing,
	stack-consing, multiple-value things.  Try to limit the number of
	vinsns that actually do heap allocation, to make pc-lusering
	simpler (or possible ...).  Assume that tsp & next-tsp are in
	registers. (MMX registers, but beggars can't be choosers.)

2006-01-28 02:49  gb

	* compiler/X86/X8664/x8664-arch.lisp: Don't enumerate/give pet
	names to MMX registers.  TCR changes.

2006-01-28 02:38  gb

	* compiler/X86/x862.lisp: More stuff works; still need to do: -
	unwind-protect cleanup context stuff - hairy lambda-list stuff -
	more consing, especially stack-consing - ffi - lots of "simple"
	primitives, memory reference stuff.

2006-01-28 02:35  gb

	* compiler/X86/x86-lapmacros.lisp: No more * for indirect jmp
	(there's enough syntax already, without that.) VECTOR-LENGTH: use 2
	args, more carefully.

2006-01-28 02:34  gb

	* compiler/X86/x86-disassemble.lisp: Stop block on UUO.  Handle
	more label-arithmetic cases, new UUO.

2006-01-28 02:33  gb

	* compiler/X86/x86-backend.lisp: Simplify pseudo-op operands, too.

2006-01-28 02:33  gb

	* compiler/X86/x86-asm.lisp: Fix mmx->mmx MOVQ.  Add MOVAPD, a few
	more UUOs.

2006-01-28 02:31  gb

	* lisp-kernel/x86-spentry64.s: More binding stuff: unbinding,
	*interrupt-level* binding.

2006-01-28 02:30  gb

	* lisp-kernel/x86-macros.s: Arg order comment.

2006-01-28 02:29  gb

	* lisp-kernel/x86-constants64.s: tsp, next_tsp in MMX regs.

2006-01-28 02:29  gb

	* lisp-kernel/x86-uuo.s: interrupt_now()

2006-01-27 20:52  gb

	* lisp-kernel/: linuxppc64/Makefile, linuxppc64/elf64ppc.x,
	linuxppc/Makefile, linuxppc/elf32ppclinux.x: Only about an hour was
	wasted, but it somehow seems longer.

2006-01-27 20:39  gb

	* lisp-kernel/: ppc-macros.s, ppc-spbind.s, ppc-spbuiltin.s,
	ppc-spentry.s, ppc-spffi.s, darwinppc/Makefile,
	darwinppc64/Makefile: Splitting ppc-spentry.s into several smaller
	files files wasn't a bad idea, but the fact that Apple's 64-bit
	linker is badly broken (can't handle branches to external symbols,
	has difficulty with forward references, etc.) makes it impractical.
	
	(Yes,  bugs in Apple's 64-bit linker have been reported, many
	months ago.)

2006-01-27 20:05  gb

	* lisp-kernel/: ppc-spentry.s, ppc-spffi.s, linuxppc/Makefile,
	linuxppc/elf32ppclinux.x, linuxppc64/Makefile,
	linuxppc64/elf64ppc.x: Split out ffi subprims to ppc-spffi.s

2006-01-27 19:49  gb

	* lisp-kernel/: ppc-spbind.s, ppc-spentry.s, darwinppc/Makefile,
	darwinppc64/Makefile, linuxppc/Makefile, linuxppc/elf32ppclinux.x,
	linuxppc64/Makefile, linuxppc64/elf64ppc.x: Move binding-related
	subprims to ppc-spbind.o

2006-01-27 19:48  gb

	* lisp-kernel/ppc-spbuiltin.s: Add a comment.

2006-01-27 19:33  gb

	* lisp-kernel/: darwinppc64/Makefile, darwinppc/Makefile,
	linuxppc/Makefile, linuxppc/elf32ppclinux.x, linuxppc64/Makefile,
	linuxppc64/elf64ppc.x: ppc-spbuiltin.o

2006-01-27 19:32  gb

	* lisp-kernel/ppc-spentry.s: Oh, now I remember: there is no
	"subi.", which explains the use of "subic.".

2006-01-27 19:28  gb

	* lisp-kernel/: ppc-macros.s, ppc-spbuiltin.s, ppc-spentry.s: Start
	to split up ppc-spentry.s into several smaller files.  Will need
	makefile changes as well; won't compile cleanly for a while.

2006-01-27 19:27  gb

	* lisp-kernel/x86-uuo.s: xuuo, other small changes.

2006-01-27 19:27  gb

	* lisp-kernel/x86-spentry64.s: Binding stuff.  Will soon split up
	this file and PPC equivalent.

2006-01-27 19:26  gb

	* lisp-kernel/x86-macros.s: Cons arg order.  More
	changes/reorganization to come.

2006-01-27 19:25  gb

	* lisp-kernel/x86-constants64.s: Get registers consistent, again.

2006-01-27 04:01  gb

	* lisp-kernel/x86-spentry64.s: Compile on x8664.

2006-01-27 02:48  gb

	* lisp-kernel/x86-uuo.s: Start to define some of what's in LAP.

2006-01-27 02:47  gb

	* lisp-kernel/x86-spentry64.s: call_closure.

2006-01-27 02:47  gb

	* lisp-kernel/x86-macros.s: Flesh out some more.

2006-01-27 02:47  gb

	* lisp-kernel/x86-constants64.s: Add nargregs.

2006-01-26 23:40  gb

	* lisp-kernel/gc.c: Compile on x8664.

2006-01-26 23:40  gb

	* lisp-kernel/ppc-spentry.s: Use subi. in SPfitvals; no need for
	subic.

2006-01-26 23:39  gb

	* lisp-kernel/x86-constants64.h: Use symbolic (GNU_SOURCE) names
	for register indices.

2006-01-26 23:38  gb

	* lisp-kernel/x86-constants64.s: Lisp_frame, nargs extensions.

2006-01-26 23:37  gb

	* lisp-kernel/x86-macros.s: Change arg order in macros, to match
	LAP.  Some fixes in do_funcall; need to update UUO defs.

2006-01-26 23:36  gb

	* lisp-kernel/x86-spentry64.s: Macro arg order, some multiple-value
	stuff, stub out unused things.

2006-01-26 23:35  gb

	* lisp-kernel/x86-spjump64.s: Flesh this out.

2006-01-26 17:30  gb

	* level-0/l0-hash.lisp: Didn't I check this in already ?  Fix
	CLRHASH locking.

2006-01-25 18:53  gb

	* lib/compile-ccl.lisp: Ellipses to indicate that kernel build may
	take a little while, and delay after successful build to increase
	the chance that the message reporting success is seen before it
	scrolls off.

2006-01-25 18:51  gb

	* release-notes.txt: Update, describing (some) recent changes.

2006-01-25 18:13  gb

	* lisp-kernel/image.h, xdump/heap-image.lisp: Bump kernel abi
	version.

2006-01-25 18:13  gb

	* lib/compile-ccl.lisp: Progress messages around kernel build.

2006-01-25 18:03  gb

	* xdump/faslenv.lisp: Finish bumping fasl version.

2006-01-25 17:57  gb

	* lib/nfcomp.lisp: Next step in bumping FASL version.

2006-01-25 17:52  gb

	* xdump/faslenv.lisp: Start bumping fasl version.

2006-01-25 17:45  gb

	* lib/ccl-export-syms.lisp: export allocation-quantum stuff.

2006-01-25 17:45  gb

	* lisp-kernel/ppc-exceptions.c: new_heap_segment tries to use
	per-thread allocation quantum.

2006-01-25 17:44  gb

	* level-1/l1-processes.lisp: Some more allocation-quantum stuff.

2006-01-25 17:44  gb

	* lib/macros.lisp: %get-natural, %get-signed-natural.

2006-01-25 17:43  gb

	* level-1/version.lisp: Bump.

2006-01-25 15:16  gb

	* level-1/: l1-lisp-threads.lisp, l1-processes.lisp: Start to
	maintain per-process allocation quantum. Still more work to do
	here.

2006-01-25 15:14  gb

	* lisp-kernel/thread_manager.c: initialize tcr's
	log2_allocation_quantum from
	lisp_global(DEFAULT_ALLOCATION_QUANTUM)

2006-01-25 15:12  gb

	* lisp-kernel/pmcl-kernel.c: set
	lisp_global(DEFAULT_ALLOCATION_QUANTUM)

2006-01-25 15:11  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp,
	compiler/PPC/PPC64/ppc64-arch.lisp,
	compiler/X86/X8664/x8664-arch.lisp, lisp-kernel/ppc-constants32.h,
	lisp-kernel/ppc-constants32.s, lisp-kernel/ppc-constants64.h,
	lisp-kernel/ppc-constants64.s, lisp-kernel/x86-constants64.h,
	lisp-kernel/x86-constants64.s: OLDinterrupt-level ->
	log2-allocation-quantum.

2006-01-25 15:10  gb

	* compiler/PPC/ppc-arch.lisp, compiler/X86/x86-arch.lisp,
	lisp-kernel/lisp_globals.h: OLDinterrupt-level ->
	default-allocation-quantum.

2006-01-25 15:09  gb

	* compiler/reg.lisp: Constants again.

2006-01-25 03:15  gb

	* lisp-kernel/linuxppc/elf32ppclinux.x: Don't use SIZEOF_HEADERS,
	since this seems to cause confusion with ld 2.16.91/gcc 4.1.0 on
	FC5.  Define _SDA_BASE_, since some versions of crt1.o reference
	it.  (We don't use a small data area, so it'd be nice if crt1.o
	stopped referencing it. Perhaps there's an option that controls the
	C runtime startup file ?)

2006-01-25 03:10  gb

	* lisp-kernel/pad.s: Add an instruction (a NOP) here.  This seems
	to be necessary to force alignment to work correctly when the
	linker script omits SIZEOF_HEADERS.

2006-01-24 17:45  gb

	* level-1/linux-files.lisp, lisp-kernel/thread_manager.c: Several
	changes, not all of them finished.   Make the primitive which does
	timed semaphore waits use milliseconds (not nanoseconds),  and do
	the multiplication in the kernel.

2006-01-24 17:43  gb

	* compiler/X86/X8664/x8664-vinsns.lisp: A few more things.

2006-01-24 17:43  gb

	* compiler/X86/X8664/x8664-arch.lisp: Don't (canonically) call
	temp0.b "shift".

2006-01-24 13:24  gb

	* level-1/l1-lisp-threads.lisp: In %nanosleep, check if -both-
	remaining seconds/remaining nanos are 0, not -either-.

2006-01-24 13:22  gb

	* compiler/X86/X8664/x8664-vinsns.lisp: Some FP stuff.

2006-01-24 13:20  gb

	* lib/time.lisp: Kinder, gentler seconds-to-nanoseconds conversion
	in SLEEP.

2006-01-24 13:18  gb

	* compiler/X86/x862.lisp: A few float-related (and 2-address vs
	3-address -related) changes.

2006-01-24 13:17  gb

	* compiler/X86/x86-lapmacros.lisp: Go through
	tcr.single-float-convert when boxing/unboxing immediate
	SINGLE-FLOATs.

2006-01-24 13:17  gb

	* compiler/backend.lisp: AVAILABLE-FP-TEMP: don't assume 32 bits in
	"available" mask.

2006-01-24 02:32  gb

	* compiler/reg.lisp: Change the values of those parameters.

2006-01-24 02:13  gb

	* compiler/reg.lisp: Make some bitfields used in fixnums which
	(sometimes) describe physical machine registers variables.  This is
	a little tricky to bootstrap; making them variables (instead of
	constants) is a step towards making it easier to change their
	values without fouling up the running compiler.  (They'll change
	back to constants after the "value" bitfield gets wide enough to
	accomodate interesting architectures.  Not sure about the Itanium,
	but x8664 needs more bits for byte/word/long/quad reg variants and
	for mmx/xmm/x87/seg registers, and making this field wider seems
	better than other alternatives.)

2006-01-24 01:04  gb

	* compiler/X86/X8664/x8664-arch.lisp: Constants for single-float
	tags. single-float-convert in the tcr, so we don't have to push and
	pop so much.

2006-01-23 01:53  gb

	* level-1/version.lisp: bump.

2006-01-23 01:31  gb

	* compiler/X86/x86-asm.lisp: Insert :%mmx registers.  Insert them
	in the right place in MOVD/MOVQ.

2006-01-23 01:30  gb

	* compiler/X86/x86-backend.lisp: Recognize :%mmx, :%xmm registers.

2006-01-23 01:29  gb

	* compiler/X86/x86-disassemble.lisp: New (hard-wired) registers to
	recognize.  op-indire: we're 64-bit.

2006-01-23 01:28  gb

	* compiler/X86/x86-lap.lisp: Relaxation of :ALIGN frags : get diff
	right.

2006-01-23 01:27  gb

	* compiler/X86/x862.lisp: More stuff works.  Need a less-ugly way
	of dealing with the fact that x8864 save regs, x8664 arg regs
	aren't assigned contiguous identifiers.

2006-01-23 01:26  gb

	* compiler/X86/X8664/x8664-arch.lisp: Make a few symbolic register
	names more canonical.

2006-01-23 01:25  gb

	* compiler/X86/X8664/x8664-vinsns.lisp: Fixnum addition, overflow
	handling, etc.

2006-01-23 01:24  gb

	* level-1/l1-lisp-threads.lisp: Move %CONS-FAKE-STACK-FRAME
	elsewhere.

2006-01-23 01:22  gb

	* level-1/linux-files.lisp: TIMED-WAIT-ON-SEMAPHORE: use
	GET-INTERNAL-REAL-TIME, accept an optional semaphore-notification.

2006-01-23 01:21  gb

	* level-1/ppc-trap-support.lisp: Move the %CONS-FAKE-STACK-FRAME
	macro here.
	
	When consing up a fake stack from from an exception context, stick
	the context in the frame's (new) xp slot.

2006-01-23 01:20  gb

	* lib/backtrace.lisp: Warn that much of this is PPC-specific.
	
	When looking for a saved register value, look in the xp of any
	fake-stack-frame we encounter.

2006-01-23 01:18  gb

	* library/lispequ.lisp: Add %fake-stack-frame-xp.  (This causes
	some constants/accessors to be redefined; (COMPILE-CCL T) - and
	continuing through redefinitions - is suggested.)

2006-01-21 11:48  gb

	* examples/hons-example.lisp: Fix
	LARGEST-PRIME-LESS-THAN-OR-EQUAL-TO in the case where the arg is a
	prime.
	
	In HONS, don't wander around looking for new honses in old tables.

2006-01-20 18:57  gb

	* level-1/version.lisp: bump.

2006-01-20 18:56  gb

	* level-1/l1-readloop.lisp: No more ERROR-HEADER.

2006-01-20 18:50  gb

	* level-1/l1-readloop-lds.lisp: Don't use ERROR-HEADER, since error
	messages are now formatted differently.

2006-01-20 18:49  gb

	* level-1/l1-init.lisp: *MAIN-LISTENER-PROCESS-NAME* hasn't been
	correct in years, isn't used now.

2006-01-20 18:48  gb

	* level-1/l1-events.lisp: Call %break-in-frame in response to a
	keyboard interrupt.

2006-01-20 18:47  gb

	* level-1/l1-error-system.lisp: Some stack-walking changes, so
	error message contexts are often more meaningful.

2006-01-20 18:45  gb

	* level-1/l1-dcode.lisp: Define FLATTEN-METHOD-LAMBDA-LIST, which
	removes initforms from the lambda list (making it more suitable for
	use as a gf lambda list).

2006-01-20 18:43  gb

	* level-1/l1-clos-boot.lisp: Change error reporting in
	CHECK-DEFMETHOD-CONGRUENCY.

2006-01-20 18:41  gb

	* compiler/backend.lisp: Lose extra comma.

2006-01-19 13:13  gb

	* lib/numbers.lisp: Check for null expt in PARSE-FLOAT.

2006-01-18 23:31  gb

	* compiler/X86/X8664/x8664-vinsns.lisp: More stuff works.

2006-01-18 23:30  gb

	* compiler/X86/X8664/x8664-arch.lisp: Swap arg_z and temp0, on the
	theory that references to it may be able to avoid REX prefixes
	sometimes.

2006-01-18 23:29  gb

	* compiler/X86/x862.lisp: Get some more stuff working.

2006-01-18 23:29  gb

	* compiler/X86/x86-lapmacros.lisp: Use new UUOs for type - er for
	tag checking.

2006-01-18 23:28  gb

	* compiler/X86/x86-lap.lisp: Get LAP constants in the right order. 
	Indentation fixes, other subtle changes too hard to recognize.

2006-01-18 23:27  gb

	* compiler/X86/x86-disassemble.lisp: Recognize new UUOs; print
	suffixes more often.

2006-01-18 23:26  gb

	* compiler/X86/x86-asm.lisp: Several fixes, still more uuos.

2006-01-18 23:25  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: Fix a constraint.

2006-01-18 23:24  gb

	* compiler/PPC/ppc2.lisp: Use TARGET-WORD-SIZE-CASE, 'cause that's
	what we're testing for,

2006-01-18 23:23  gb

	* compiler/vinsn.lisp: Introduce a :sets-cc vinsn attribute, which
	might (or might not) help to avoid some extra testing of condition
	codes.

2006-01-18 23:22  gb

	* compiler/nx0.lisp: Recognize s32 constants.  (Note that this is
	for comparisons, and includes some non-fixnum cases.)

2006-01-18 23:20  gb

	* compiler/backend.lisp: A few horribly-named macros for register
	targeting, handling u8-targeted primitives (for tag checking.)

2006-01-18 20:29  gb

	* lisp-kernel/: x86-macros.s, x86-uuo.s: Register renumbering.	New
	consing/uuo scheme.  (Looked at other strategies, including a
	spin-lock on a global heap with yield()ing.  The per-thread memory
	pool scheme seems to win.  Big.  So we have to know how to
	interrupt it.)

2006-01-18 20:26  gb

	* lisp-kernel/x86-constants64.h: Register renumbering.

2006-01-18 13:07  gb

	* lisp-kernel/x86-asmutils64.s: Add missing colon after label.

2006-01-18 04:43  gb

	* lisp-kernel/: x86-constants64.s, x86-macros.s, x86-uuo.s: some
	changes; may not compile

2006-01-17 04:41  gb

	* level-1/version.lisp: More bumping; enough for today.  Needs
	work, but I need sleep.

2006-01-17 04:40  gb

	* compiler/optimizers.lisp: Lose target-arch-case.

2006-01-17 04:04  gb

	* compiler/: PPC/PPC32/ppc32-arch.lisp, PPC/PPC64/ppc64-arch.lisp,
	X86/X8664/x8664-arch.lisp: Use the new slots for type info.

2006-01-17 03:45  gb

	* compiler/nx1.lisp: Lose target-arch-case.

2006-01-17 03:44  gb

	* compiler/nx0.lisp: Backend vector type stuff here; lose
	target-arch-case.

2006-01-17 03:43  gb

	* compiler/arch.lisp: More slots for arch-specific type info.

2006-01-17 03:42  gb

	* compiler/backend.lisp: Can use target-word-size-case here.

2006-01-17 03:41  gb

	* compiler/: PPC/ppc2.lisp, X86/x862.lisp: Move vector typecode
	stuff to frontend and rename it.

2006-01-17 02:56  gb

	* level-1/version.lisp: Bump; new binaries soon.

2006-01-17 02:55  gb

	* compiler/: nx0.lisp, nx1.lisp: Start to use alternatives to
	TARGET-ARCH-CASE.

2006-01-17 02:54  gb

	* compiler/X86/: x862.lisp, X8664/x8664-vinsns.lisp: A little more.

2006-01-17 02:54  gb

	* compiler/: PPC/PPC32/ppc32-arch.lisp, PPC/PPC64/ppc64-arch.lisp,
	X86/X8664/x8664-arch.lisp: set the new fields (unbound/slot-unbound
	tokens)

2006-01-17 02:29  gb

	* lib/macros.lisp: target-word-size-case

2006-01-17 02:28  gb

	* compiler/arch.lisp: Add some fields to target-arch structure.

2006-01-17 00:26  gb

	* compiler/X86/x86-asm.lisp: Split things up to simplify vinsn
	expansion.

2006-01-17 00:25  gb

	* compiler/X86/x86-backend.lisp: Vinsn template parsing.

2006-01-17 00:25  gb

	* compiler/X86/x86-disassemble.lisp: Recognize more uuos, syntax
	changes.

2006-01-17 00:25  gb

	* compiler/X86/x86-lap.lisp: Split some thing up for
	vinsn-expansion.  Nuke branches to next instruction, which the
	compiler casually generates.

2006-01-17 00:22  gb

	* compiler/X86/x86-lapmacros.lisp: No "absolute" jump syntax (*
	ea).  Use :^ in label-offset expressions.

2006-01-17 00:21  gb

	* compiler/X86/x862.lisp: Still several compilation warnings, but
	some things work.

2006-01-17 00:21  gb

	* compiler/X86/X8664/x8664-vinsns.lisp: Start to flesh out.  Note
	use of (keyword) "overqualifiers" (tm).

2006-01-17 00:19  gb

	* level-0/X86/x86-pred.lisp: typo in EQL.

2006-01-17 00:18  gb

	* lib/compile-ccl.lisp: x86/x8664 compiler stuff.

2006-01-17 00:18  gb

	* lib/systems.lisp: add x8664-vinsns.  ppc-reg was renamed long
	ago.

2006-01-17 00:17  gb

	* lib/x8664env.lisp: Exactly one cr field.

2006-01-17 00:16  gb

	* level-1/ppc-trap-support.lisp: Use target::node-size (not 4!) in
	xp-argument-list.

2006-01-17 00:16  gb

	* compiler/X86/X8664/x8664-arch.lisp: node-size =
	word-size-in-bytes

2006-01-17 00:15  gb

	* compiler/vreg.lisp: rename s64-const -> s64const, since it's used
	now.

2006-01-13 09:22  gb

	* lib/x8664env.lisp: $undo-x86-c-frame.

2006-01-13 09:21  gb

	* lib/systems.lisp: Add x862.

2006-01-13 09:21  gb

	* compiler/X86/X8664/x8664-vinsns.lisp: New syntax, where operand
	types are heavily qualified (the idea here is to make it possible
	to match opcodes exactly at %define-vinsn time.)

2006-01-13 09:19  gb

	* compiler/X86/X8664/x8664-backend.lisp: Don't use #', since the
	functions are moving targets.

2006-01-13 09:18  gb

	* compiler/X86/x862.lisp: Well, it compiles (with lots of warnings)
	and needs some work ...

2006-01-13 09:17  gb

	* compiler/X86/x86-lap.lisp: Define and use MATCH-TEMPLATE-TYPE.

2006-01-13 09:16  gb

	* compiler/X86/x86-disassemble.lisp: Don't automatically label the
	first instruction (it gets labeled on backward branch.)

2006-01-13 09:15  gb

	* compiler/X86/x86-backend.lisp: First cut at some vinsn-defining
	things.

2006-01-13 09:14  gb

	* compiler/X86/x86-asm.lisp: some alu ops want :imm8s for 8-bit
	immediates, not :imm8.

2006-01-13 09:14  gb

	* compiler/X86/x86-arch.lisp: condition-code constants.

2006-01-13 09:13  gb

	* compiler/PPC/ppc2.lisp: Use renamed operators.

2006-01-13 09:13  gb

	* compiler/PPC/ppc-backend.lisp: Fix some typos, I think ..

2006-01-13 09:12  gb

	* compiler/: nx1.lisp, nxenv.lisp: Rename some operators that had
	PPC in their names to distinguish themselves from the 68K versions,
	10-12 years ago.

2006-01-12 11:30  gb

	* compiler/PPC/ppc2.lisp: ppc2-%i+,%i-,%ineg: when oveflow checking
	out-of-line, don't use <-, but copy arg_z to the (temporary) target
	register.
	
	When targeting "natural" args in poweropen ff-calls, account for
	the possibility that the target isn't what we'd allocated for it.

2006-01-12 01:33  gb

	* compiler/PPC/ppc-backend.lisp: Fix DEFINE-PPC-VINSN.

2006-01-12 01:32  gb

	* level-1/version.lisp: Bump again.  Maybe a little difficult to
	bootstrap; new binaries soon if so.

2006-01-12 01:25  gb

	* level-1/version.lisp: Bump.  Maybe a little difficult to
	bootstrap; new binaries soon if so.

2006-01-12 01:25  gb

	* level-0/X86/: x86-float.lisp, x86-hash.lisp, x86-io.lisp,
	x86-misc.lisp, x86-numbers.lisp, x86-pred.lisp, x86-symbol.lisp,
	x86-utils.lisp, X8664/x8664-bignum.lisp: Most (if not all) things
	that have been translated to x8664 assembler assemble (and,
	according to the dissassembler, do so correctly.)
	
	Maybe about 80% coverage; still a few hard cases.

2006-01-12 01:23  gb

	* level-0/PPC/ppc-misc.lisp: VOID-ALLOCPTR looks like -16 on PPC64.

2006-01-12 01:22  gb

	* compiler/X86/X8664/x8664-backend.lisp: Reference new stub vinsn
	functions.

2006-01-12 01:21  gb

	* compiler/X86/x86-backend.lisp: Stub vinsn functions.

2006-01-12 01:21  gb

	* compiler/X86/X8664/x8664-vinsns.lisp: DEFINE-X8664-VINSN.

2006-01-12 01:19  gb

	* compiler/X86/X8664/x8664-arch.lisp: Change the calling sequence:
	no %nfn, new %ra0.

2006-01-12 01:18  gb

	* compiler/X86/: x86-lap.lisp, x86-lapmacros.lisp,
	x86-disassemble.lisp: No explicit "@entry" label; ^-expressions
	implicitly reference it.

2006-01-12 01:16  gb

	* compiler/X86/x86-asm.lisp: More bug fixes.

2006-01-12 01:12  gb

	* compiler/PPC/: PPC32/ppc32-backend.lisp,
	PPC64/ppc64-backend.lisp: Use DEFINE-PPC-VINSN to define vinsns.

2006-01-12 01:11  gb

	* compiler/PPC/ppc-backend.lisp: Define a DEFINE-VINSN function for
	PPC backends here.

2006-01-12 01:10  gb

	* compiler/vinsn.lisp: Pass all args to the backend's define-vinsn
	function, including the backend

2006-01-12 00:55  gb

	* compiler/PPC/ppc-asm.lisp: Remove ancient commented-out code.

2006-01-12 00:55  gb

	* compiler/vinsn.lisp: %DEFINE-VINSN uses the backend's
	define-vinsn function.

2006-01-12 00:54  gb

	* compiler/backend.lisp: BACKENDs now have a DEFINE-VINSN slot.

2006-01-10 20:37  gb

	* compiler/X86/x86-asm.lisp: testq matches :reg64 not :reg32. 
	Imagine that.

2006-01-10 20:36  gb

	* compiler/X86/X8664/x8664-arch.lisp: Define (minimal) lisp-frame.

2006-01-10 20:36  gb

	* level-0/X86/x86-numbers.lisp: Moved some float stuff from
	x86-numbers to x86-float.  Get most of this translated (except for
	%FIXNUM-GCD.)

2006-01-10 20:35  gb

	* level-0/X86/x86-float.lisp: Moved some float stuff from
	x86-numbers to x86-float.

2006-01-10 20:35  gb

	* level-0/PPC/: ppc-float.lisp, ppc-numbers.lisp: Moved some float
	stuff from ppc-numbers to ppc-float.

2006-01-10 20:34  gb

	* level-0/X86/: x86-clos.lisp, x86-def.lisp: Moved some trampoline
	stuff from x86-def to x86-clos.

2006-01-10 20:33  gb

	* level-0/PPC/: ppc-clos.lisp, ppc-def.lisp: Moved some trampoline
	stuff from ppc-def to ppc-clos.

2006-01-10 20:32  gb

	* lib/systems.lisp: x86-disassemble: source needed extension.

2006-01-10 20:32  gb

	* lib/compile-ccl.lisp: Indentation in NEEDS-COMPILE-P.

2006-01-10 05:57  gb

	* compiler/X86/x86-lapmacros.lisp: more stack-frame stuff,
	%car/%cdr, constant refs, call/jump-symbol.

2006-01-10 05:50  gb

	* compiler/X86/x86-asm.lisp: Use EVAL-WHEN, reorder things so that
	it compiles (still a warning or two, maybe.)
	
	Add UUO-STACK-OVERFLOW.

2006-01-10 05:50  gb

	* level-0/X86/: x86-clos.lisp, x86-def.lisp, x86-io.lisp,
	x86-misc.lisp, x86-numbers.lisp, x86-utils.lisp: initial checkin

2006-01-10 05:46  gb

	* compiler/X86/x86-disassemble.lisp: Recognize uuo-stack-overflow.
	
	When finding pc-relative refs in operands, the constant ref is a
	memory operand, not an immediate operand.

2006-01-10 05:38  gb

	* compiler/X86/X8664/x8664-arch.lisp: Rename a few registers.

2006-01-10 05:37  gb

	* level-0/X86/x86-pred.lisp: x8664 LAP.

2006-01-10 05:37  gb

	* lisp-kernel/x86-macros.s: Add a 'q' suffix.

2006-01-09 05:46  gb

	* compiler/X86/x86-disassemble.lisp: Fixes: register-based shifts
	(#xd3 with different /n in the modrm byte) had the wrong table
	index.
	
	x8664-special (basically, movslq) table and handling of it was
	wrong.

2006-01-09 05:44  gb

	* compiler/X86/x86-asm.lisp: Fix handling of index, scale when base
	register present in INSERT-MEMORY.
	
	More fixes to opcode templates, including movslq and mul.

2006-01-09 05:41  gb

	* level-0/: l0-bignum32.lisp, l0-bignum64.lisp: Fix EVAL-WHEN
	stuff.

2006-01-09 05:29  gb

	* level-0/l0-bignum32.lisp: common for 32-bit targets

2006-01-09 05:27  gb

	* level-0/PPC/PPC32/l0-bignum-ppc32.lisp: moved and renamed

2006-01-09 05:24  gb

	* level-0/l0-bignum64.lisp: common for 64-bit targets

2006-01-09 05:22  gb

	* level-0/PPC/PPC64/l0-bignum-ppc64.lisp: renamed and moved

2006-01-09 05:01  gb

	* level-0/X86/X8664/x8664-bignum.lisp: new file

2006-01-09 04:53  gb

	* compiler/X86/x86-lapmacros.lisp: UNBOX-FIXNUM does arithmetic
	shift.

2006-01-09 04:52  gb

	* compiler/X86/X8664/x8664-arch.lisp: imm1.b is dl, not dx.

2006-01-09 00:40  gb

	* level-0/X86/x86-array.lisp: Still some PPC code here.

2006-01-09 00:37  gb

	* level-0/X86/x86-symbol.lisp: No PPC code.  No x8632 code, either.

2006-01-09 00:36  gb

	* compiler/X86/x86-lapmacros.lisp: Some conditional traps. 
	CMP-TO-NIL for x8664 (where NIL has its own tag.)

2006-01-09 00:33  gb

	* compiler/X86/x86-lap.lisp: Try to handle NIL, T in expressions. 
	Move template-matching to x86-asm (and therefore x86::).

2006-01-09 00:31  gb

	* compiler/X86/x86-disassemble.lisp: Handle UUOs.

2006-01-09 00:31  gb

	* compiler/X86/x86-asm.lisp: More bug fixes.

2006-01-08 02:46  gb

	* level-0/X86/x86-hash.lisp: New file.	No PPC or X8632 code here.

2006-01-08 02:45  gb

	* compiler/X86/: x86-lap.lisp, x86-lapmacros.lisp: Don't use ^ for
	simple label references.

2006-01-08 02:44  gb

	* compiler/X86/x86-disassemble.lisp: Use .pt and .pn for branch
	prediction.  Don't use ^ syntax for simple label references.

2006-01-08 02:42  gb

	* compiler/X86/x86-asm.lisp: Some CMOVxx templates put operands in
	the wrong places.

2006-01-08 02:41  gb

	* compiler/PPC/ppc-lap.lisp: Compulsive comment formatting.

2006-01-07 20:08  gb

	* level-0/X86/x86-float.lisp: No ppc code.  (No 32-bit x86 code,
	either; will need some, eventually.)

2006-01-07 20:07  gb

	* level-0/l0-float.lisp: conditionalize on target word size, which
	is what most/all of the #+ppc32-target/#+ppc64-target stuff was
	concerned with.  (In turn, the word size is trying to say "are
	SINGLE-FLOATs immediate ?" and "do we have to drop into lap to deal
	with 32-bit words efficiently ?")

2006-01-07 20:05  gb

	* compiler/X86/x86-lapmacros.lisp: rcmp, to prevent (or delay the
	onset of) madness.
	
	Use .pt and .pn for static branch prediction.
	
	Add int-to-single.

2006-01-07 20:03  gb

	* compiler/X86/x86-asm.lisp: Flesh out some more, fix some bugs.

2006-01-07 20:03  gb

	* compiler/X86/x86-arch.lisp: Define MXCSR stuff.

2006-01-06 08:32  gb

	* compiler/X86/x86-asm.lisp: More of the new scheme.  Still need to
	flesh out the opcode descriptions (mostly SSE* stuff and other
	newer instructions.)
	
	Should try to sanity check agains old (GAS) template data. 
	Somehow.

2006-01-06 08:30  gb

	* compiler/X86/x86-lap.lisp: Still some leftover code from the old
	scheme, but what's there of the new scheme seems to work.

2006-01-06 08:29  gb

	* compiler/X86/x86-disassemble.lisp: Some bug fixes: op-imreg
	-really- isn't op-reg, sign-extend when getting a signed-byte 32
	...

2006-01-05 07:55  gb

	* library/lispequ.lisp: Remove 68k-MCL comment.

2006-01-05 07:54  gb

	* compiler/X86/: x86-asm.lisp, x86-lap.lisp: Start moving away from
	high-level "instruction templates" and towards more detailed
	"opcode templates".  The latter are intended to make it easier to
	generate code from (e.g.) the compiler.
	
	(This is currently about half there.  The assembler doesn't work at
	the moment, and the "opcode templates" are missing some things that
	might be used in compiled/lap code and their definitions may
	contain typos. It's worth doing, in that it'll allow the compiler
	to generate machine code while bypassing much of the old
	implementation's parse- time side effects and special-cases.)

2006-01-05 07:48  gb

	* compiler/X86/x86-lapmacros.lisp: Some stuff for entering/leaving
	functions.

2006-01-05 07:47  gb

	* level-1/l1-reader.lisp: %unreadable: don't assume that STREAM is
	referenced in format-string arg.

2006-01-05 07:46  gb

	* level-0/l0-float.lisp: A little  conditionalization.

2006-01-05 07:46  gb

	* level-0/X86/x86-float.lisp: A little more code and
	conditionalization.

2006-01-01 20:23  gb

	* level-1/version.lisp: Bump.

2006-01-01 20:20  gb

	* examples/hons-example.lisp: More changes.  Enough for now.

2006-01-01 20:04  gb

	* lisp-kernel/gc.c: Init hons space to #<Unbound>, don't make this
	appear unconditional.

2006-01-01 17:28  gb

	* lisp-kernel/ppc-spentry.s: No cmpd here.

2006-01-01 16:59  gb

	* library/hash-cons.lisp: Correct last comment: real change was
	revival of HONS-FREE-MARKER; it and HONS-DELETED-MARKER are macros.

2006-01-01 16:58  gb

	* examples/hons-example.lisp: Changed, yet again.  Some
	intentionally bad hashing here.

2006-01-01 16:56  gb

	* lisp-kernel/ppc-spentry.s: _SPbuiltin_eql: as far as it goes,
	doesn't have to be conditionalized for ppc32/ppc64.  Should really
	do it all here; the only (slightly) hard cases are ratio & complex.

2006-01-01 16:54  gb

	* lisp-kernel/gc.c: bzero new static dnodes in grow_hons_area.
	
	Skip over them when counting immediate bytes before purify.  (Need
	to do more skipping in purify/impurify.)

2006-01-01 16:52  gb

	* library/hash-cons.lisp: Changed, yet again.  Some intentionally
	bad hashing here.

2005-12-31 13:34  gb

	* examples/hons-example.lisp: Don't write back "for obscure GC
	reasons".

2005-12-31 12:04  gb

	* lisp-kernel/pmcl-kernel.c: Don't touch pages when committing
	them.

2005-12-31 12:04  gb

	* lisp-kernel/gc.c: Don't write to new hons cells in
	grow_hons_area(); let application code fault pages in.

2005-12-31 12:03  gb

	* library/hash-cons.lisp: Don't use "free markers", but do lookup
	indices in the bitmap.

2005-12-31 12:02  gb

	* level-0/l0-init.lisp: add :OPENMCL-HASH-CONSING to *FEATURES*.

2005-12-31 12:01  gb

	* examples/hons-example.lisp: New file.

2005-12-31 12:01  gb

	* compiler/PPC/ppc-lapmacros.lisp: Add TEST-BIT-AT-INDEX.

2005-12-31 07:35  gb

	* lisp-kernel/ppc-exceptions.c: Handle faults in touch_page(), by
	forcing it to return false.

2005-12-31 07:34  gb

	* lisp-kernel/pmcl-kernel.c: try to touch_all_pages() after
	committing memory, to defeat overcommit.

2005-12-31 07:26  gb

	* lisp-kernel/: ppc-asmutils.s, x86-asmutils64.s: touch_page.

2005-12-31 04:12  gb

	* doc/INFO/.cvsignore: new file

2005-12-31 03:37  gb

	* lib/: ccl-export-syms.lisp, compile-ccl.lisp: Rename
	"rebuild-openmcl" to "rebuild-ccl" and export it.

2005-12-31 03:08  gb

	* lib/compile-ccl.lisp: :linuxppc64 standard-boot-image-name is
	ppc-boot64, not ppc64-boot.

2005-12-31 02:55  gb

	* lisp-kernel/pmcl-kernel.c: Lose the (old) metering_control.

2005-12-31 02:54  gb

	* lisp-kernel/imports.s: Don't reference metering_control.

2005-12-31 02:37  gb

	* lisp-kernel/gc.c: when shrinking HONS area, remember that
	delta_in_bytes is negative.

2005-12-31 02:37  gb

	* lisp-kernel/pmcl-kernel.c: Lose old metering stuff.  Don't enter
	debugger on mmap failure in grow_dynamic_area

2005-12-31 02:35  gb

	* lisp-kernel/image.c: Add a newline to an error message.  Retain
	DELETED_STATIC_PAIRS in saved images.

2005-12-31 02:34  gb

	* lib/compile-ccl.lisp: Experimental REBUILD-CCL function.

2005-12-31 02:33  gb

	* level-0/X86/x86-float.lisp: double-float-abs!.  Not sure what to
	do about NaNs, etc.

2005-12-31 02:32  gb

	* level-1/version.lisp: Keep bumping.

2005-12-31 02:32  gb

	* level-0/PPC/ppc-pred.lisp: Try to bum the 32-bit EQUAL a bit. 
	The ppc64 version needs work, too.

2005-12-31 02:30  gb

	* lisp-kernel/x86-macros.s: nargs is a 16-bit register on x86.

2005-12-31 02:30  gb

	* lisp-kernel/x86-constants64.h: define log2_nbits_in_word for
	x8664.

2005-12-31 02:29  gb

	* lisp-kernel/gc.c: AREA_CSTACK is uninteresting to GC on x86.	no
	"nukable" pointers (to HONS space) in AREA_CSTACK on ppc, either.

2005-12-31 02:28  gb

	* .cvsignore: Ignore *x86cl*.

2005-12-30 02:11  gb

	* level-0/l0-misc.lisp: hons-area-size is now in openmcl-hons.

2005-12-30 01:11  gb

	* lisp-kernel/: darwinppc/Makefile, darwinppc64/Makefile: CVS
	mishap.

2005-12-30 01:10  gb

	* lisp-kernel/darwinppc64/Makefile, lisp-kernel/darwinppc/Makefile,
	library/hash-cons.lisp: Missing package prefix.

2005-12-30 01:02  gb

	* library/hash-cons.lisp: Put things in their own package
	(OPENMCL-HONS:), flesh out documentation/doc strings a bit. 
	(more).

2005-12-29 19:44  gb

	* level-1/l1-readloop.lisp: Make :Q  work again.

2005-12-29 04:48  gb

	* lisp-kernel/gc.c: Deal with shrinking the hons area.

2005-12-29 04:48  gb

	* lisp-kernel/ppc-exceptions.c: Handle cleanup of each tcr's
	gc_context in gc_like_from_xp, not in the GC proper.

2005-12-29 04:47  gb

	* lisp-kernel/pmcl-kernel.c: shrink_dynamic_area by a natural, not
	just an unsigned.  When creating the tenured area, move the
	static_used bitvector there from the active dynamic area.

2005-12-29 04:45  gb

	* lisp-kernel/image.c: Deal with the hons-space bitmap (saved in
	the image, after the dynamic section contents).
	
	It's an error if we're on the wrong platform.

2005-12-29 04:36  gb

	* lisp-kernel/image.h: Bump ABI_VERSION_MIN.

2005-12-29 04:34  gb

	* level-0/l0-misc.lisp: %USEDBYTES and ROOM account for hons space.

2005-12-28 16:34  gb

	* xdump/heap-image.lisp: write (target) platform info to header. 
	TODO: endianness of host/target, page size assumptions.

2005-12-28 16:31  gb

	* xdump/: faslenv.lisp, xfasload.lisp: rename $fasl-arch to
	$fasl-platform.

2005-12-28 16:31  gb

	* lisp-kernel/: image.c, image.h: bump max/current abi version, min
	to soon follow.  store target "platform" in header.flags,
	regardless of word size.  check flags when loading; should be fatal
	error after bootstrapping.

2005-12-28 16:29  gb

	* lisp-kernel/pmcl-kernel.c: use new PLATFORM constants to set
	kernel_global(HOST_PLATFORM).

2005-12-28 16:29  gb

	* lisp-kernel/lisp.h: New PLATFORM constants.

2005-12-28 16:28  gb

	* lib/nfcomp.lisp: $fasl-arch -> $fasl-platform, get it from
	backend-target-platform.

2005-12-28 16:28  gb

	* level-1/version.lisp: Bump; new binaries soon.

2005-12-28 16:27  gb

	* level-0/nfasload.lisp: Rename $fasl-arch to $fasl-platform.

2005-12-28 16:27  gb

	* level-0/: l0-misc.lisp, l0-utils.lisp: Referring to
	area-staticlib is soooo 2005, but these constants don't need to be
	in the ppc package in 2006.

2005-12-28 16:26  gb

	* compiler/: PPC/PPC32/ppc32-backend.lisp,
	PPC/PPC64/ppc64-backend.lisp, X86/X8664/x8664-backend.lisp:
	backend-target-architecture -> backend-target-platform; use new
	constants.

2005-12-28 16:25  gb

	* compiler/PPC/ppc-arch.lisp: Fix package in attribute line.

2005-12-28 16:24  gb

	* compiler/backend.lisp: Platform constants;
	backend-target-architecture -> backend-target-platform.

2005-12-28 09:49  gb

	* xdump/heap-image.lisp: Don't set the (was disk-size, now
	static-dnodes) field of section header to non-zero value.

2005-12-27 14:19  gb

	* lib/encapsulate.lisp: ADVISE-GLOBAL-DEF: don't generate
	DYNAMIC-EXTENT declarations, since they're too easy to violate.

2005-12-27 05:29  gb

	* level-1/version.lisp: Bumped (yesterday ...).

2005-12-27 05:28  gb

	* level-0/PPC/ppc-utils.lisp: hons-size stuff moved to HASH-CONS.

2005-12-27 05:26  gb

	* compiler/X86/x862.lisp: Absolutely wrong and useless, but at
	least it's checked in.

2005-12-27 05:25  gb

	* level-0/l0-hash.lisp: Use the 32-bit ROTATE-HASH-CODE on PPC64,
	for now.

2005-12-27 05:25  gb

	* compiler/PPC/: PPC32/ppc32-arch.lisp, PPC64/ppc64-arch.lisp:
	Constants for bitvector operations.

2005-12-27 05:20  gb

	* compiler/PPC/ppc-lapmacros.lisp: Bitvector stuff (used exactly
	once.)

2005-12-27 05:19  gb

	* compiler/PPC/ppc-arch.lisp: Reformat a comment.

2005-12-27 05:18  gb

	* library/hash-cons.lisp: New file.

2005-12-27 05:17  gb

	* lib/compile-ccl.lisp, lib/systems.lisp, level-1/l1-boot-2.lisp:
	Add HASH-CONS.

2005-12-27 05:17  gb

	* lisp-kernel/image.c: Don't use disk_size field of section header.

2005-12-27 05:16  gb

	* lisp-kernel/image.h: replace "disk_size" field in section header
	with "static_dnodes".

2005-12-27 05:15  gb

	* lisp-kernel/gc.c: Keep static_dnodes, static_used in tenured_area
	(never active), use static_dnodes_for_area().
	
	forward_and_resolve_static_references(): only call (paraoia) if not
	EGC.  Retain usedbits set from markbits.
	
	adjust_pointers_in_dynamic_area(): handles static dnodes if
	necessary.
	
	adjust_all_pointers: don't adjust area start/end, since
	grow_dynamic_area() does all that.  Caller adjusts active area
	active field.
	
	Add an mremap() for Darwin.

2005-12-27 04:57  gb

	* lisp-kernel/pmcl-kernel.c: hardlimit field is unused on heap
	areas.

2005-12-27 04:56  gb

	* lisp-kernel/macros.h: box_fixnum, unbox_fixnum:  signed_natural,
	not int.

2005-12-26 03:37  gb

	* lisp-kernel/: linuxppc/Makefile, linuxppc64/Makefile,
	static-linuxppc/Makefile: -D_GNU_SOURCE

2005-12-26 01:18  gb

	* lisp-kernel/gc.c: Lots of stuff of allocating hons area &
	adjusting other addresses.  Tenured_area (and aliases) may now have
	static prefix, so be careful when relocating/forwarding (and use
	new "dynamic" GC pointers.)

2005-12-26 01:16  gb

	* lisp-kernel/gc.h: More GC variables, for relocation of dynamic
	dnodes only.
	
	Extra param on some GC-like functions.
	
	Add GC_TRAP_FUNCTION_SET_HONS_AREA_SIZE

2005-12-26 01:15  gb

	* lisp-kernel/image.c: say "log2_page_size", not "12".

2005-12-26 01:14  gb

	* lisp-kernel/lisp-exceptions.h: gc_like_from_xp functions take an
	extra signed_natural parameter.

2005-12-26 01:13  gb

	* lisp-kernel/lisp.h: Declare page_size, log2_page_size.

2005-12-26 01:12  gb

	* lisp-kernel/pmcl-kernel.c: use "log2_page_size" instead of "12".
	
	Ahem.  Map lots-o-memory on linuxppc64, too.

2005-12-26 01:11  gb

	* lisp-kernel/: ppc-constants.s, lisp_globals.h: bad_go_tag_counter
	is now "deleted_static_pairs".

2005-12-26 01:09  gb

	* lisp-kernel/: ppc-constants64.h, ppc-constants32.h: define
	log2_nbits_in_word.

2005-12-26 01:09  gb

	* lisp-kernel/ppc-exceptions.c: define page_size, log2_page_size.

2005-12-26 01:08  gb

	* lisp-kernel/thread_manager.c: use "log2_page_size" instead of
	"12".

2005-12-26 01:08  gb

	* lisp-kernel/x86-constants.s: bad_go_tag_counter is now
	"deleted_static_pairs".

2005-12-26 01:07  gb

	* lisp-kernel/area.h: Use new name for "managed static" areas.	New
	static_dnodes, static_used fields in areas.

2005-12-26 01:06  gb

	* level-1/l1-lisp-threads.lisp: Use new name for "managed static"
	areas.

2005-12-26 01:05  gb

	* level-0/PPC/ppc-utils.lisp: Use symbolic constants for gc traps. 
	Defin SET-CONS-AREA-SIZE.

2005-12-26 01:05  gb

	* level-0/PPC/ppc-misc.lisp: Use symbolic constants for gc traps.

2005-12-26 01:04  gb

	* compiler/X86/x86-arch.lisp: bad-go-tag-counter ->
	deleted-static-pairs, use "managed-static" area coded instead of
	"staticlib".  (Define area codes, which were missing.)

2005-12-26 01:02  gb

	* compiler/PPC/: PPC32/ppc32-arch.lisp, PPC64/ppc64-arch.lisp: area
	struct: it's been "dnodes" (not "dwords") for a while now.  Add
	static-dnodes, static-used fields.

2005-12-26 01:01  gb

	* compiler/PPC/ppc-arch.lisp: bad-go-tag-counter ->
	deleted-static-pairs, use "managed-static" area coded instead of
	"staticlib"

2005-12-26 00:54  gb

	* compiler/arch.lisp: Define GC trap function constants, including
	new GC-TRAP-FUNCTION-SET-HONS-AREA-SIZE.

2005-12-23 18:23  gb

	* level-1/l1-readloop-lds.lisp: Output of :FORM observes
	*BACKTRACE-PRINT-LEVEL* and *BACKTRACE-PRINT-LENGTH*.

2005-12-23 14:49  gb

	* lib/backtrace.lisp, level-1/l1-readloop-lds.lisp,
	lib/ccl-export-syms.lisp: Add :form and :function backtrace
	commands.

2005-12-22 16:58  gb

	* lib/backtrace.lisp: Try to show something that looks like a
	function call (with required arguments and an indication of other
	arguments) in backtrace.
	
	Use *BACKTRACE-PRINT-LEVEL* and *BACKTRACE-PRINT-LENGTH* to
	constrain printing of arguments and frame contents.

2005-12-22 10:34  gb

	* compiler/X86/x86-asm.lisp: Being compilable is good.

2005-12-22 10:13  gb

	* compiler/X86/x86-asm.lisp: Start trying to separate x86-64 from
	x86-32 stuff, a little.

2005-12-22 10:12  gb

	* compiler/X86/: X8664/x8664-arch.lisp, x86-disassemble.lisp:
	"symbolic registers" map standard reg names (not x86-reg-entrys) to
	lisp reg names.

2005-12-22 10:11  gb

	* compiler/X86/X8664/x8664-backend.lisp: Tweak target features,
	target-arch id.

2005-12-22 10:10  gb

	* lib/: compile-ccl.lisp, systems.lisp: Update a little more.

2005-12-22 10:09  gb

	* x86-headers64/libc/.cvsignore: new

2005-12-21 07:36  gb

	* x86-headers64/libc/C/: .cvsignore, populate.sh: new files

2005-12-21 07:01  gb

	* level-0/X86/x86-float.lisp: A few small changes, mostly to see if
	they'll disassemble.

2005-12-21 06:58  gb

	* compiler/X86/x86-asm.lisp: Lose UNPARSE-OPERAND methods. 
	EVAL-WHEN cleanup.

2005-12-21 06:57  gb

	* compiler/X86/x86-backend.lisp: Don't assume an x86-target.

2005-12-21 06:57  gb

	* compiler/X86/x86-lap.lisp: Lose the PRINT-OBJECT method, now that
	there's a mostly-working disassembler.

2005-12-21 06:55  gb

	* compiler/X86/X8664/: x8664-backend.lisp, x8664-arch.lisp: use
	EVAL-WHEN, so it at least compiles ...

2005-12-21 06:53  gb

	* lib/: systems.lisp, compile-ccl.lisp: Some X86 stuff.

2005-12-21 06:52  gb

	* compiler/backend.lisp: Compulsive comment formatting.

2005-12-21 06:52  gb

	* compiler/PPC/ppc-backend.lisp: *PPC-BACKEND* is nil if not on a
	PPC.

2005-12-20 03:25  gb

	* compiler/X86/X8664/x8664-vinsns.lisp: Fix a typo.

2005-12-20 03:24  gb

	* compiler/X86/X8664/x8664-arch.lisp: Maintain symbolic register
	names, for disassembler.

2005-12-20 03:24  gb

	* compiler/X86/: x86-asm.lisp, x86-disassemble.lisp, x86-lap.lisp,
	x86-lapmacros.lisp: New! Improved! Almost usable!

2005-12-17 02:50  gb

	* compiler/X86/x86-disassemble.lisp: Not quite finished, but not
	-too- far away.

2005-12-17 02:49  gb

	* compiler/X86/x86-backend.lisp: Cloned the PPC version and renamed
	a few things; needs thought/work.

2005-12-17 02:46  gb

	* compiler/X86/x86-asm.lisp: X86-SEGMENT-REGISTER.

2005-12-17 02:45  gb

	* compiler/X86/x86-lap.lisp: LOOKUP-X86-REGISTER accepts strings
	(again.)

2005-12-16 02:15  gb

	* lisp-kernel/: x86-constants64.h, x86-constants64.s: Some changes
	to the TCR.

2005-12-16 01:48  gb

	* lib/x8664env.lisp: New file; might be more-or-less right.  (Might
	want to make some of the bitmasks a bit smaller.)

2005-12-16 01:39  gb

	* level-0/X86/: x86-array.lisp, x86-float.lisp: Mostly just copied
	from PPC versions; just to exercise X86 LAP/LAPMACROS for now.

2005-12-16 01:37  gb

	* compiler/X86/X8664/x8664-arch.lisp: Registers can be referenced
	via small integer as well as by name.

2005-12-16 01:37  gb

	* compiler/X86/X8664/x8664-backend.lisp: First draft, may not even
	compile yet.

2005-12-16 01:36  gb

	* compiler/X86/x86-lapmacros.lisp: More lap macros.

2005-12-16 01:35  gb

	* compiler/X86/x86-lap.lisp: Enough stuff to support cross-compiled
	DEFX86LAPFUNCTION.

2005-12-16 01:35  gb

	* compiler/X86/x86-asm.lisp: Start defining some UUOs (int n,
	n=192-255).
	
	Define more registers in *x8664-register-entries*.

2005-12-14 01:16  gb

	* level-0/l0-init.lisp: Add :clozure to features (Hey! Marketing!)
	
	Other changes to *features*.

2005-12-14 01:15  gb

	* lisp-kernel/x86-constants64.s: use _l suffix for 32-bit regs.
	
	nargs is 16 bits wide, not 32.
	
	Fix comment in tag_list definition.
	
	TCR contains linear_end field as well as linear field.

2005-12-14 01:12  gb

	* lisp-kernel/plbt.c: Try to identify the thread associated with
	each stack.

2005-12-14 01:11  gb

	* level-1/linux-files.lisp: WAIT-ON-SEMAPHORE takes WHOSTATE arg.

2005-12-14 01:10  gb

	* compiler/X86/x86-lap.lisp: Lots-o-changes.  Move to the CCL
	package.

2005-12-14 01:10  gb

	* compiler/X86/x86-asm.lisp: Lots-o-changes.

2005-12-14 01:09  gb

	* compiler/X86/x86-arch.lisp: Kernel globals and
	nil-relative-symbols.

2005-12-14 01:08  gb

	* level-1/l1-processes.lisp: Copy process PSN to CS-AREA.OWNER of
	TCR, so that kernel backtrace can identify stacks by PSN.

2005-12-14 01:06  gb

	* compiler/X86/: X8664/x8664-arch.lisp, x86-lapmacros.lisp: gotta
	start somewhere.

2005-12-14 01:04  gb

	* compiler/PPC/: ppc-arch.lisp, PPC64/ppc64-arch.lisp: Comment.

2005-12-14 01:04  gb

	* compiler/backend.lisp: Indentation.

2005-12-13 01:37  gb

	* compiler/X86/x86-lap.lisp: New scheme for dealing with
	alignment/span-dependent instructions (looks suspiciously like
	GAS's).
	
	Lots of other changes and fixes, handle :ALIGN pseudoop (and :TRA,
	for tagged return addresses), and :long/:byte etc.
	
	A simple test case:
	
	? (load "ccl:compiler;X86;x86-lap")
	
	? (x86::x86-lap '((xchg (% rdi) (% rsi)) (lea (@ (- (^ foo) #xf) (%
	rsi)) (% rsi))			 (jmp (* (% rdi))) (:tra foo)))
	
	should generate output that looks like:
	
	 frag at #x8
	04 00 00 00 00 00 00 00 48 87 FE 48 8D B6 15 00 00 00 FF E7 CC CC
	CC CC  frag at #x20 EB FF FF FF CC CC CC CC  frag at #x28
	
	which seems correct.
	
	Still need to size immediates and emit them, and need
	syntax/support for lisp constants.

2005-12-13 01:20  gb

	* compiler/X86/x86-asm.lisp: Invert the order of templates that
	used to use the :D bit, to match the order that GAS encounters
	them.  (There are multiple ways to encode instructions that take a
	(register or memory address/register) and also (register/register
	or memory address) when both args are registers.)
	
	Revert to using short branches and short conditional branches, for
	new span-dependent-instruction scheme.
	
	Vector of seg-entries, ordered by reg-num.

2005-12-10 00:49  gb

	* compiler/X86/x86-lap.lisp: Constants delimited by +.
	
	Code emission starting to work; need scheme for span-dependent
	instructions (including relative displacements in memory operands),
	forcing alignment, etc.

2005-12-09 23:51  gb

	* compiler/X86/x86-asm.lisp: Constants delimited by +.	Get rid of
	the :D modifier; define some templates redundantly (two-arg
	instructions that can take (reg, memory | reg) or (memory | reg,
	reg)).

2005-12-07 23:22  gb

	* compiler/X86/x86-lap.lisp: Start to think about code generation:
	code fragments, etc.  Some things (modrm-byte/sib-byte generation)
	still unfinished (commented out), but want to get this checked in.

2005-12-07 23:21  gb

	* compiler/X86/x86-asm.lisp: Define and use :label operand type.

2005-12-04 05:45  gb

	* release-notes.txt: Update a little.

2005-12-04 05:42  gb

	* level-1/version.lisp: Time to bump.

2005-12-04 05:28  gb

	* level-1/ppc-threads-utils.lisp: In %FOREIGN-THREAD-INITIALIZE,
	don't assume that we're entered with no bindings in effect (the
	callback trampolines now bind a few specials, mostly having to do
	with tracing.)	Likewise, any catch/unwind-protect frames that were
	made with no bindings should be fixed to point to the end of the
	phony binding chain that this function initializes.

2005-12-04 05:14  gb

	* lisp-kernel/gc.h: WORD_SIZE64 is never defined; WORD_SIZE is
	defined, and may have the value 64.  (This was screwing up the
	64-bit definition of the qnode type, and this screwing up 64-bit
	GC.)

2005-12-04 05:13  gb

	* lisp-kernel/lisp-exceptions.h: Provide ANSI-style prototype for
	install_pmcl_exception_handlers().

2005-12-04 05:12  gb

	* lisp-kernel/: x86-constants.h, ppc-constants.h: Fix definition of
	TCR_FLAG_BIT_PROPAGATE_EXCEPTION.

2005-12-04 05:12  gb

	* lisp-kernel/thread_manager.c: Don't set/test
	TCR_FLAG_BIT_ALT_SUSPEND, do set/test
	(1<<TCR_FLAG_BIT_ALT_SUSPEND).

2005-12-04 05:10  gb

	* lisp-kernel/ppc-exceptions.c: Don't set/test
	TCR_FLAG_BIT_PROPAGATE_EXCEPTION, do set/test
	(1<<TCR_FLAG_BIT_PROPAGATE_EXCEPTION).

2005-12-04 05:07  gb

	* lisp-kernel/Threads.h: Provide more complete prototypes in some
	cases.

2005-11-29 00:49  gb

	* compiler/X86/X8664/x8664-vinsns.lisp: A little bit more, but
	still just an artist's conception.
	
	Note that we may need to do some sort of "expression" stuff with
	vinsn parameters as well.

2005-11-29 00:46  gb

	* compiler/X86/x86-lap.lisp: "expression" stuff, mostly so that we
	can do partial evaluation of expressions involving (relative) label
	addresses.
	
	Memory-operand parsing.

2005-11-29 00:44  gb

	* compiler/X86/x86-asm.lisp: PC-relative jumps that come in more
	than one size: default to the "large" (32-bit) displacement
	version, since (a) this'll always be correct, if sometimes
	inefficient and (b) it may be easier to shorten branches than to
	lengthen them.
	
	Label refs now start with circumflex.
	
	Unparse memory operands.

2005-11-28 11:00  gb

	* lisp-kernel/bits.h: Change arg order in x86 inline asm for
	count_leading_zeros.  Can't easily test this.
	
	(Note that there are all kinds of potential endianness issues in GC
	bitvector/bit-counting stuff.)

2005-11-28 10:05  gb

	* lisp-kernel/bits.h: Conditionalize count_leading_zeros for GCC
	versions < 4.0.

2005-11-21 19:59  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: Noted a couple of cases
	where the destination register should be of class :u64, not :u32.
	(Not sure that this matters much in practice.

2005-11-21 19:55  gb

	* compiler/X86/: x86-asm.lisp, x86-lap.lisp: Slow progress;
	definitely need expression language.  Add a little bit of support
	for referencing registers by ordinal number and mapping between the
	64/32/16/8-bit versions of a register.

2005-11-21 11:43  gb

	* compiler/X86/X8664/x8664-vinsns.lisp: Very far away from
	usability; need to experiment to determine necessary LAP support
	for vinsns.

2005-11-21 10:20  gb

	* compiler/PPC/ppc-lap.lisp, lib/sequences.lisp: Comment
	formatting.

2005-11-20 06:42  gb

	* compiler/X86/: x86-asm.lisp, x86-lap.lisp: Getting closer; can
	parse some forms of x86 instructions and operands and do some
	amount of sanity checking.
	
	Still need to work out memory/displaced-only operands, deal with
	labels, deal with expressions (might want something like a closure/
	suspension/future, might not), code-generation, etc.

2005-11-18 04:05  gb

	* lisp-kernel/darwinppc/Makefile: Pass -arch ppc explicitly to cc
	and as, since that may not be the default.

2005-11-18 04:04  gb

	* lisp-kernel/ppc-exceptions.c: Some #if LINUX conditionalization
	changed to runtime test of the global variable
	'use_mach_exception_handling'.
	
	(On Darwin, use_mach_exception_handling is set false when
	running_under_rosetta is true.	Mach exception handling may be less
	likely to work in that case; signal handling currently doesn't work
	either ...)

2005-11-18 04:01  gb

	* lisp-kernel/pmcl-kernel.c: Static initialization of
	'running_under_rosetta' and 'use_mach_exception_handling' happens
	on both Linux and Darwin, though neither of these things should
	ever be true on Linux.
	
	Cache flushing seems to be unbelievably slow when
	running_under_rosetta is set; don't do it for now, since the first
	call to xMakeDataExecutable() tries to invalidate stuff that was
	probably never in the cache and we die before we get to a
	subsequent call.

2005-11-18 03:55  gb

	* lisp-kernel/lisp.h: Declare running_under_rosetta and
	use_mach_exception_handling globally and unconditionally.  (This
	makes it a little more convenient to check their valus at runtime,
	even though neither could be true under Linux.	(Right now, one of
	the primary reasons for checking running_under_rosetta is to be
	able to insert fprintf's that show how screwed up things are, and I
	don't want to have to surround those tests with additional
	#ifdefs.)

2005-11-17 03:15  gb

	* compiler/X86/x86-asm.lisp: Macros to encode symbolic attributes.

2005-11-17 03:15  gb

	* compiler/X86/x86-lap.lisp: Will probably overlap RISC-LAP a lot,
	but needs to be different (variable-length instructions, alignment,
	etc.)  Maybe merge later.

2005-11-17 03:13  gb

	* level-1/l1-clos-boot.lisp: CLASS-PROTOTYPE method for
	STRUCTURE-CLASS: don't try to call default constructor, since it
	may not exist ...

2005-11-15 02:48  gb

	* lisp-kernel/memory.c: #include <sys/mman.h> unconditionally.

2005-11-15 02:32  gb

	* lisp-kernel/: darwinppc/Makefile, darwinppc64/Makefile,
	linuxppc/Makefile, linuxppc64/Makefile, static-linuxppc/Makefile:
	Depend on memory.o

2005-11-15 02:30  gb

	* lisp-kernel/: x86-exceptions.c, x86-exceptions.h: Stubs for x86
	exception stuff.

2005-11-15 02:29  gb

	* lisp-kernel/: ppc-exceptions.c, ppc-exceptions.h: Migrate some
	stuff elsewhere; conditionalize a bit more.

2005-11-15 02:28  gb

	* lisp-kernel/pmcl-kernel.c: Use CPUID to check x86 features,
	determine cache_block_size, etc.

2005-11-15 02:27  gb

	* lisp-kernel/: ppc-asmutils.s, x86-asmutils64.s:
	get/put_vector_registers.  Probably unused; referenced from the
	kernel imports table.

2005-11-15 02:25  gb

	* lisp-kernel/gc.c: Conditionalize for x86, WORD_SIZE.

2005-11-15 02:24  gb

	* lisp-kernel/lisp-debug.c: Move some code here from the (old)
	lisp-exceptions.c.

2005-11-15 02:24  gb

	* lisp-kernel/lisptypes.h: #define WORD_SIZE as 32 or 64, depending
	on preprocessor definitions.  Stop using #ifdef WORD_SIZE64, here
	and elsewhere.	Note that there are probably still many things that
	are conditionalized on
	
	#ifdef PPC64
	
	when they're really concerned about 64/32-bit issues.  (I've caught
	a few cases, but I'm sure that many still remain.)

2005-11-15 02:23  gb

	* lisp-kernel/imports.s: Expect get/put_vector_registers (not
	necessarily AltiVec.  (I don't think that this is called from Lisp
	code anymore.)

2005-11-15 02:21  gb

	* lisp-kernel/: bits.h, image.c, image.h: Use WORD_SIZE value to
	conditionalize.

2005-11-15 02:20  gb

	* lisp-kernel/area.h: Define IMAGE_BASE_ADDRESS for x86-64 Linux.

2005-11-15 02:20  gb

	* lisp-kernel/: x86-spentry64.s, x86-subprims64.s: Define a few
	externally referenced things.  (Still a ways from being able to put
	code there, but the symbols need to be exported so that the kernel
	can link on x86-64 Linux.

2005-11-15 02:18  gb

	* lisp-kernel/linuxx8664/Makefile: Depend on xlbt.o, not plbt.o

2005-11-15 02:18  gb

	* lisp-kernel/xlbt.c: Implement the kernel debugger's backtrace
	API, such as it is.  (Still need to determine what the lisp stack
	looks like - and how it relates to the foreign stack - before any
	of this could work.)

2005-11-15 02:16  gb

	* lisp-kernel/lisp-exceptions.h: #define WORD_SIZE as 32 or 64,
	depending on preprocessor definitions.	Stop using #ifdef
	WORD_SIZE64, here and elsewhere.  Note that there are probably
	still many things that are conditionalized on
	
	#ifdef PPC64
	
	when they're really concerned about 64/32-bit issues.  (I've caught
	a few cases, but I'm sure that many still remain.)

2005-11-15 02:14  gb

	* lisp-kernel/memory.c: New file: functions related to memory
	allocation/zeroing/mapping/protecting/etc.  (Most of this came from
	the old lisp-exceptions.c, but there are fairly generic
	memory-handling functions in other files that could reasonably
	migrate here.)
	
	Note that stuff having to do with lisp memory allocation (trapping
	into the kernel when the current thread's pool is too small, etc.)
	involves a lot of platform-dependent trap decoding and probably
	doesn't belong in this file.

2005-11-14 23:15  gb

	* lisp-kernel/x86-exceptions.c: New (mostly empty) file.

2005-11-14 23:12  gb

	* lisp-kernel/: darwinppc/Makefile, darwinppc64/Makefile,
	linuxppc/Makefile, linuxppc64/Makefile, static-linuxppc/Makefile:
	PPC makefiles: rename lisp-exceptions.o to ppc-exceptions.o

2005-11-14 23:06  gb

	* lisp-kernel/lisp-exceptions.c: renamed

2005-11-14 23:05  gb

	* lisp-kernel/ppc-exceptions.c: rename

2005-11-14 23:04  gb

	* lisp-kernel/gc.c: More cut-and-paste mishaps.

2005-11-14 22:59  gb

	* lisp-kernel/gc.c: Fix (hopefully ...) botched PPC
	conditionalization.

2005-11-14 22:56  gb

	* lisp-kernel/: gc.c, gc.h, lisp-debug.c, x86-exceptions.h: Some
	X86 conditionalization.

2005-11-14 22:56  gb

	* lisp-kernel/linuxx8664/Makefile: Replace ppc_print.o with
	x86_print.o in DEBUGOBJ.

2005-11-14 22:55  gb

	* lisp-kernel/x86_print.c: New file.

2005-11-14 03:25  gb

	* lisp-kernel/: darwinppc/Makefile, darwinppc64/Makefile,
	linuxppc/Makefile, linuxppc64/Makefile, static-linuxppc/Makefile:
	CHEADERS include ppc-exceptions.h

2005-11-14 03:21  gb

	* lisp-kernel/: lisp-debug.c, lisp-exceptions.c, lisp-exceptions.h,
	ppc-exceptions.h: siginfo_t debugging stuff.  Only likely to be
	useful on Linux, or if signal-based exception handling's used.

2005-11-14 02:10  gb

	* lisp-kernel/lisp-debug.c: Start to make all debugger commands and
	lisp_Debugger() take a (possibly null) siginfo_t argument. 
	Probably won't compile cleanly (yet).

2005-11-14 02:09  gb

	* lisp-kernel/gc.c: Some X86[64] changes, mostly to the way that
	exception frames are accessed and in the ways that ivector sizes
	are determined.
	
	This compiles without warnings on X8664, but there need to be some
	(significant) semantic changes in the ways that the marker
	(especially the DWS marker) treats new types (TRAs, new
	symbol/function pointers.)

2005-11-14 02:03  gb

	* lisp-kernel/lisp-exceptions.h: Split into platform-dependent
	subfiles.

2005-11-14 02:03  gb

	* lisp-kernel/: x86-constants64.h, x86-constants64.s: Fix typos,
	design flaws ...

2005-11-14 02:01  gb

	* lisp-kernel/: ppc-exceptions.h, x86-exceptions.h: New files.

2005-11-14 02:00  gb

	* lisp-kernel/area.h: x86 variant of CS_OVERFLOW_FORCE_LIMIT

2005-11-13 20:35  gb

	* lisp-kernel/bits.h: Intrinsics are named __builtin_clz,
	__builtin_clzll.

2005-11-13 20:30  gb

	* lisp-kernel/: bits.h, gc.h, lisp-debug.c, lisp-exceptions.c,
	lisp-exceptions.h, lisp.h, lisp_globals.h, lisptypes.h, macros.h,
	memprotect.h, pmcl-kernel.c, ppc-constants32.h, ppc-constants64.h,
	thread_manager.c, x86-constants.h, x86-constants64.h,
	x86-constants64.s: Lots-o-changes, so some things are closer to
	compiling on x86-64.  MAY HAVE BROKEN PPC/PPC64 COMPILATION; need
	to check changes in to check that.

2005-11-13 17:50  gb

	* level-1/version.lisp: Bump.

2005-11-12 20:35  gb

	* lisp-kernel/sigcontext.h: nuke this

2005-11-12 18:17  gb

	* lisp-kernel/x86-constants64.s: Tagging: complete, maybe usable.

2005-11-12 18:16  gb

	* lisp-kernel/x86-macros.s: A few more things, mostly just to check
	syntax.

2005-11-12 18:14  gb

	* lisp-kernel/x86-spentry64.s: Fix typo, tighten up a bit
	(cmov...).

2005-11-12 18:13  gb

	* lisp-kernel/m4macros.m4: _structf macro takes an optional
	displacement arg (defaults to -misc_bias).

2005-11-12 18:09  gb

	* lisp-kernel/linuxppc64/Makefile: update ppc-uuo.s dependency

2005-11-12 17:44  gb

	* lisp-kernel/ppc-spentry.s: Fix (several-days-old) typo in ppc64
	code.

2005-11-12 17:09  gb

	* lib/backquote.lisp: Conditionalize-out (rather than comment-out)
	Steele's public-domain backquote implementation.  It'd probably be
	worth switching to this (it's clearer and seems to work better);
	that might require some changes in the printer/pretty-printer to
	provide equivalent support, and probably requires some testing.

2005-11-12 17:06  gb

	* level-1/l1-io.lisp, lib/numbers.lisp: Dan Corkill's patch to
	allow readable printing of NaN's and infinities.  (Bits of this
	were tweaked to require changes to GET-FPU-MODE; rebuild ppc-boot
	and build an image - or mouse on the new GET-FPU-MODE - before
	compiling these changes.

2005-11-12 17:02  gb

	* level-1/ppc-trap-support.lisp: The Darwin PPC64 versions of
	XP-DOUBLE-FLOAT and XP-FPSCR-INFO were looking at a 32-bit machine
	context (and therefore returning garbage); the operands to
	arithmetic errors were usually reported incorrectly.
	
	Not yet sure of Linux PPC64.

2005-11-12 17:00  gb

	* level-0/PPC/ppc-float.lisp: GET-FPU-MODE takes an optional
	argument; if it's provided, it returns information about that
	attribute only.
	
	SET-FPU-MODE returns an unspecified non-NIL value, rather than
	calling GET-FPU-MODE with no arguments.
	
	Bootstrapping note: some higher-level code to be checked in depends
	on this incompatible change to GET-FPU-MODE.  Do (xload-level-0)
	and create a new image before compiling those higher-level sources.

2005-11-10 00:15  gb

	* library/sharp-comma.lisp: Provide #, as a loadable extension.

2005-11-09 01:24  gb

	* lisp-kernel/: lisp-exceptions.c, pmcl-kernel.c, thread_manager.c:
	Detect (in a simple-minded, easily-fooled way ...) if the PPC
	version is running on something that doesn't appear to be a PPC.  
	Limit the amount of reserved heap memory in that case (since an
	emulator seems to be in our way ...).  Disable Mach exception
	handling (using POSIX signals instead) if we believe that we're
	running emulated.  File bugs with Apple, because emulated POSIX
	signal handling's taken a step backward in that emulated
	environment.  Not surprising.

2005-11-08 19:43  gb

	* lisp-kernel/x86-constants64.s: Flip %imm1 and %temp2: making
	%imm1 an alias for %rdx simplifies integer multiplication (which
	clobbers %rdx on this piece-o-crap.)
	
	Remove inconcistencies from tag assignments (so things assemble);
	still need to do a -real- tag assignment pass.

2005-11-08 19:41  gb

	* lisp-kernel/x86-constants.s: Add _builtin_function indices.

2005-11-08 19:40  gb

	* lisp-kernel/x86-macros.s: Try to make arg order of macros
	consistent with PPC (destination precedes source, registers precede
	memory operands, etc.)
	
	Some additions and fixes.

2005-11-08 19:38  gb

	* lisp-kernel/x86-spentry64.s: The little bit that's there
	assembles and looks reasonable.

2005-11-08 19:37  gb

	* lisp-kernel/linuxx8664/Makefile: Depend on x86-uuo.s (since
	"uuo.s" is -so- 11/07.)

2005-11-08 15:53  gb

	* lisp-kernel/ppc-spentry.s: Use aligned_bignum_size() macro when
	allocating fixed-size bignums.	(Some of the hardwired constants
	replaced by use of that macro may have been a bit too large,
	especially on PPC64.) Try to ensure that there's a one-to-one
	correspondence between the header used and the allocated size
	(e.g., in ppc32 _SPmakeu64, don't assume that 2-digit and 3-digit
	bignums have the same physical size.)

2005-11-08 15:47  gb

	* lisp-kernel/ppc-macros.s: Hey! PPC changes! Define
	aligned_bignum_size macro, which returns the size in bytes needed
	for an N-digit bignum (including header and alignment padding.)

2005-11-08 04:46  gb

	* lisp-kernel/x86-spentry64.s: Start to actually write some code;
	still need more infrastructure.  On a 1 to 10 complexity scale,
	.SPbuiltin_plus is probably a 5 or 6; will need to be careful about
	register usage when consing bignums ('cause there aren't enough
	registers.  Stop me if you've heard this one.)

2005-11-08 04:43  gb

	* lisp-kernel/: x86-constants.s, x86-constants64.s, x86-macros.s:
	Flesh out a bit.  x86_64 tagging still needs to be fixed.

2005-11-08 04:40  gb

	* lisp-kernel/lisp.s: Include x86_uuo.s on X86.

2005-11-08 04:39  gb

	* lisp-kernel/x86-uuo.s: Just getting started ...

2005-11-08 04:38  gb

	* lisp-kernel/m4macros.m4: Allow struct sizes to be implicitly
	padded.  (Should maybe check if that's negative padding.)

2005-11-08 04:28  gb

	* lisp-kernel/: lisp.s, darwinppc/Makefile, darwinppc64/Makefile,
	linuxppc/Makefile, static-linuxppc/Makefile: Rename "uuo.s" to
	"ppc-uuo.s".

2005-11-08 04:25  gb

	* lisp-kernel/: ppc-uuo.s, uuo.s: rename

2005-11-07 01:15  gb

	* lisp-kernel/x86-constants64.s: I might believe the register
	assignments here - at least provisionally - but the tagging will
	need work.  (It's mostly pasted from ppc-constants64.s; the good
	news is that x86-64 isn't as constrained as ppc64 is.) Need to fit
	tagged return addresses into the scheme in some way that doesn't
	conflict with other primary tags.  4/12 ? Hybrid function objects ?
	Etc.  Needs some thought.

2005-11-07 00:27  gb

	* lisp-kernel/lisp.s: Conditionally include x86 headers.

2005-11-07 00:24  gb

	* lisp-kernel/linuxx8664/Makefile: Hmm.  x86 executables probably
	shouldn't have "ppc" in their names.  Make up something else.

2005-11-06 20:27  gb

	* lisp-kernel/linuxx8664/: Makefile, elf_x86_64.x: 64-bit specific
	subprims files, since the 32-bit and 64-bit X86 are too dissimilar.

2005-11-06 20:26  gb

	* lisp-kernel/: x86-macros.s, x86-spentry64.s, x86-spjump64.s,
	x86-subprims64.s: More new, empty files.

2005-11-06 19:48  gb

	* lisp-kernel/linuxx8664/Makefile: x86-asmutils64.o

2005-11-06 19:47  gb

	* lisp-kernel/x86-asmutils64.s: New file.  If there's ever a 32-bit
	version, it'd likely be substantially different.  (This is
	certainly different from the PPC version.)

2005-11-06 19:46  gb

	* lisp-kernel/: x86-constants.h, x86-constants.s,
	x86-constants64.h, x86-constants64.s: New files; mostly empty, for
	now.

2005-11-06 19:39  gb

	* lisp-kernel/m4macros.m4: Tweak _emit_ELF_source_line_stab: use
	(m4 macro) __func_name instead of (as-defined) func_start; invert
	order of label and .stabn.
	
	This seems to generate good line number information on linuxx8664;
	need to check linuxppc, linuxppc64 as well.

2005-11-06 19:29  gb

	* lisp-kernel/: darwinppc/Makefile, darwinppc64/Makefile,
	linuxppc/Makefile, linuxppc64/Makefile, static-linuxppc/Makefile:
	Depend on ppc-macros.s, not macros.s.

2005-11-06 19:27  gb

	* lisp-kernel/lisp.s: Conditionally include for PPC, so far.

2005-11-06 19:16  gb

	* lisp-kernel/: ppc-macros.s, macros.s: renamed

2005-11-06 12:21  gb

	* lisp-kernel/: darwinppc/Makefile, darwinppc64/Makefile: Fix other
	reference to asmutils.o in Makefiles.

2005-11-06 12:19  gb

	* lisp-kernel/: linuxppc/Makefile, linuxppc64/Makefile,
	static-linuxppc/Makefile: Fix other reference to "asmutils.o" in
	Makefiles.

2005-11-06 12:07  gb

	* lisp-kernel/imports.s: Use .quad on X8664 as well.

2005-11-06 12:06  gb

	* lisp-kernel/: darwinppc/Makefile, darwinppc64/Makefile,
	linuxppc/Makefile, linuxppc64/Makefile, static-linuxppc/Makefile:
	Reference ppc-asmutils.[so] in PPC makefiles.

2005-11-06 12:01  gb

	* lisp-kernel/: ppc-asmutils.s, asmutils.s: renamed

2005-11-06 00:11  gb

	* lisp-kernel/linuxx8664/: Makefile, elf_x86_64.x: artist's
	conception; still lots of PPC-specific code, still no
	x86-64-specific code ...

2005-11-06 00:04  gb

	* lisp-kernel/: linuxppc/Makefile, linuxppc/elf32ppclinux.x,
	linuxppc64/Makefile, linuxppc64/elf64ppc.x,
	static-linuxppc/Makefile: Update for platform-dependent SPOBJ.

2005-11-05 23:59  gb

	* lisp-kernel/: darwinppc/Makefile, darwinppc64/Makefile: Rename
	SPOBJ in Darwin makefiles.

2005-11-05 23:48  gb

	* lisp-kernel/: ppc-subprims.s, ppc-spentry.s, ppc-spjump.s,
	spentry.s, spjump.s, subprims.s: rename

2005-11-05 21:54  gb

	* lisp-kernel/: linuxppc/Makefile, linuxppc64/Makefile,
	static-linuxppc/Makefile: Update dependencies on platform-dependent
	*-constants*.[hs] files.

2005-11-05 21:35  gb

	* lisp-kernel/: darwinppc/Makefile, darwinppc64/Makefile: Update
	dependencies on constants headers.

2005-11-05 21:32  gb

	* lisp-kernel/lisp.s: Inclde platform-dependent constants.s file.

2005-11-05 21:30  gb

	* lisp-kernel/ppc-constants.s: rename, include new files

2005-11-05 21:29  gb

	* lisp-kernel/: ppc-constants64.s, ppc-constants32.s, constants.s,
	constants32.s, constants64.s: rename

2005-11-05 21:23  gb

	* lisp-kernel/: lisp.h, memprotect.h: Inclde platform-dependent
	constants.h file.

2005-11-05 21:22  gb

	* lisp-kernel/: ppc-constants64.h, ppc-constants32.h: rename

2005-11-05 21:21  gb

	* lisp-kernel/constants.h: Removed.

2005-11-05 21:18  gb

	* lisp-kernel/: ppc-constants.h, constants32.h, constants64.h:
	rename

2005-11-05 19:34  gb

	* lib/compile-ccl.lisp: Try to get XCOMPILE-CCL back in synch.

2005-11-05 19:34  gb

	* level-1/ppc-callback-support.lisp: Subprim name not constant in
	linuxppc64 MAKE-CALLBACK-TRAMPOLINE.
	
	(Conditionalize this a little more explicitly, though #+(and
	linux-target poweropen-target) is pretty much the same as #+(and
	linuxppc-target poweropen-target), since nothing else would use
	poweropen conventions.)

2005-11-05 18:40  gb

	* compiler/PPC/: PPC32/ppc32-arch.lisp, PPC64/ppc64-arch.lisp:
	Define subprimitive stuff in the backend.

2005-11-05 18:39  gb

	* compiler/PPC/ppc2.lisp: Subprim names aren't constant anymore, so
	look them up at (compiler) runtime in the backend.
	
	Map between the names of builtin functions and the subprimitives
	that implement them via the backed.

2005-11-05 18:37  gb

	* compiler/PPC/ppc-lap.lisp: *PPC-SUBPRIMS* is in the "PPC"
	package.

2005-11-05 18:33  gb

	* compiler/PPC/ppc-disassemble.lisp: *PPC-SUBPRIMS* is in the "PPC"
	package.

2005-11-05 18:33  gb

	* compiler/PPC/ppc-arch.lisp: PPC subprim defs (common to ppc32 and
	ppc64) moved here.

2005-11-05 18:32  gb

	* compiler/vinsn.lisp: Subprim names aren't constants anymore, so
	look them up when parsing vinsn templates.

2005-11-05 18:31  gb

	* compiler/subprims.lisp: Subprim defs are architecture and/or
	backend-specific.

2005-11-05 18:31  gb

	* compiler/arch.lisp: PROVIDE's been back in the CL package for the
	last decade or so.

2005-11-05 18:30  gb

	* level-1/version.lisp: Bump to 051105.

2005-11-05 18:30  gb

	* level-1/l1-boot-2.lisp: Change the load order (subprims before
	arch stuff) a little.  Load the target ppc??-arch explicitly,
	though some circular REQUIRES will load both ppc32-arch and
	ppc64-arch, currently.

2005-11-05 16:23  gb

	* compiler/: arch.lisp, subprims.lisp, PPC/ppc-disassemble.lisp,
	PPC/ppc-lap.lisp, PPC/ppc2.lisp: Start to isolate PPC subprims.

2005-11-05 16:20  gb

	* examples/objc-runtime.lisp: REVIVE-OBJC-CLASSES: don't be so dumb
	about reviving metaclass pointers (addresses may change.)

2005-11-05 09:22  gb

	* lisp-kernel/static-linuxppc/Makefile: Define PPC (via -DPPC)
	explicitly.

2005-11-05 09:18  gb

	* lisp-kernel/: darwinppc64/Makefile, linuxppc/Makefile,
	linuxppc64/Makefile: Define PPC (via -DPPC) explicitly.

2005-11-05 09:15  gb

	* lisp-kernel/darwinppc/Makefile: Define PPC (via -DPPC)
	explicitly.

2005-11-05 08:44  gb

	* lisp-kernel/: static-linuxppc/.cvsignore,
	static-linuxppc/Makefile, static-linuxppc/staticlib.c,
	static-linux/.cvsignore, static-linux/Makefile,
	static-linux/staticlib.c: directory rename

2005-11-05 08:39  gb

	* lisp-kernel/: linuxppc64/.cvsignore, linuxppc64/Makefile,
	linuxppc64/elf64ppc.x, linux64/.cvsignore, linux64/Makefile,
	linux64/elf64ppc.x: directory rename

2005-11-05 08:30  gb

	* lisp-kernel/: linuxppc/elf32ppclinux.x, linuxppc/Makefile,
	linuxppc/.gdbinit, linuxppc/.cvsignore, linux/.cvsignore,
	linux/.gdbinit, linux/Makefile, linux/elf32ppclinux.x: directory
	rename

2005-11-05 08:20  gb

	* lisp-kernel/: darwinppc64/Makefile, darwinppc64/.cvsignore,
	darwin64/.cvsignore, darwin64/Makefile: directory renaming

2005-11-05 08:14  gb

	* lisp-kernel/darwin/: .cvsignore, .gdb_history, .gdbinit: finish
	rename darwin -> darwinppc

2005-11-05 08:11  gb

	* lisp-kernel/darwinppc/: .gdbinit, .cvsignore: more directory
	renaming

2005-11-05 08:07  gb

	* lisp-kernel/darwin/: Makefile, retain: rename darwin directory to
	darwinppc

2005-11-05 08:05  gb

	* lisp-kernel/darwinppc/retain: Awkward CVS directory rename

2005-11-05 08:05  gb

	* lisp-kernel/darwinppc/Makefile: Awkward CVS directory rename.

2005-11-04 11:34  gb

	* level-0/PPC/ppc-misc.lisp: In #+ppc32 version of
	%%SET-SIGNED-LONGLONG, trap if the pointer's not a
	PPC32::SUBTAG-MACPTR (not a PPC64::SUBTAG-MACPTR).  Sheesh.

2005-10-30 17:58  gb

	* lisp-kernel/thread_manager.c: Reason to suspect that
	mach_suspend_tcr is still unreliable.

2005-10-30 00:28  gb

	* tools/defsystem.lisp: Lots of conditionalization assumed that
	:MCL implies :OPENMCL.

2005-10-29 15:58  gb

	* level-1/version.lisp: Bump to 051029b.

2005-10-29 15:57  gb

	* level-0/l0-init.lisp: Remove :CCL*, :MCL, etc from *FEATURES*.

2005-10-29 15:57  gb

	* level-0/l0-hash.lisp: Change order of tests in %HASH-PROBE, so
	that test functions other than EQUAL/EQUALP don't have to compare
	keys to missing/deleted tokens.

2005-10-29 14:40  gb

	* release-notes.txt: Confess to the day's problems ...

2005-10-29 14:39  gb

	* level-1/version.lisp: Bump.

2005-10-29 14:39  gb

	* lib/prepare-mcl-environment.lisp: Fix %RESTORE-OUTERMOST-BINDING.

2005-10-29 14:39  gb

	* compiler/optimizers.lisp: The ASH compiler macro made 32-bit
	assumptions and doesn't do anything that the compiler doesn't do by
	itself.
	
	The LSH compiler macro made those same assumptions.  LSH isn't
	really used enough to justify having a compiler macro, much less a
	buggy one ...

2005-10-28 06:33  gb

	* compiler/PPC/ppc2.lisp: PPC2-SYMBOL-VALUE-CELL calls
	ENSURE-BINDING-INDEX.

2005-10-28 05:23  gb

	* level-1/version.lisp: Bump.

2005-10-28 05:23  gb

	* release-notes.txt: Yesterday's images didn't work on ppc32 on
	non-G5s.

2005-10-28 05:17  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp: Don't use 64-bit
	instructions (tdgti) in a 32-bit lisp.

2005-10-27 02:22  gb

	* release-notes.txt: Say something about LinuxPPC64 and about some
	bug fixes.

2005-10-27 01:18  gb

	* level-1/version.lisp: Bump; claim to be a "pre-1.1" release.

2005-10-27 01:17  gb

	* release-notes.txt: Fix some typos.

2005-10-27 00:19  gb

	* lib/setf.lisp: DEFINE-MODIFY-MACRO: don't try to special-case
	"place" being a simple (non-symbol-macro) symbol and expand into
	SETQ, since we don't know anything about side-effects in other
	arguments in the lambda list.
	
	INCF & DECF: -do- special case simple symbols as places, if the
	delta is also either a constant or a simple symbol; do the more
	general expansion otherwise (Bryan's code.)

2005-10-26 18:40  gb

	* release-notes.txt: Some notes; hopefully, maintaining this file
	between releases will make it easier/quicker to prepare real
	release notes.

2005-10-26 17:52  gb

	* level-0/PPC/: PPC32/l0-bignum-ppc32.lisp,
	PPC64/l0-bignum-ppc64.lisp: maybe questionable INCF/fixnum stuff

2005-10-26 17:43  gb

	* lib/db-io.lisp: avoid INCF/fixnum-arithmetic-sleaze issues in
	CDB-HASH.

2005-10-26 17:35  gb

	* level-1/: l1-boot-2.lisp, level-1.lisp: Load l1-typesys &
	sysutils earlier, to make more of the type system available.

2005-10-26 17:32  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp,
	compiler/PPC/PPC64/ppc64-arch.lisp, lib/ccl-export-syms.lisp,
	lisp-kernel/constants32.h, lisp-kernel/constants32.s,
	lisp-kernel/constants64.h, lisp-kernel/constants64.s,
	lisp-kernel/lisp-exceptions.c, lisp-kernel/thread_manager.c,
	level-1/l1-lisp-threads.lisp, level-1/l1-processes.lisp:
	PROCESS-TERMINATION-SEMAPHORE stuff.

2005-10-26 14:51  gb

	* lisp-kernel/spentry.s: Maintain tcr.unwinding during nthrow.

2005-10-26 14:50  gb

	* lisp-kernel/lisp-exceptions.c: interrupt_handler() : defer
	interrupts if tcr.unwinding is set.

2005-10-26 14:49  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp,
	compiler/PPC/PPC64/ppc64-arch.lisp, lisp-kernel/constants32.h,
	lisp-kernel/constants32.s, lisp-kernel/constants64.h,
	lisp-kernel/constants64.s: Replace the (unused)
	tcr.suspend-total-on-exception-entry field with tcr.unwinding.

2005-10-26 13:59  gb

	* compiler/PPC/ppc2.lisp: References to *INTERRUPT-LEVEL* are
	inlined.  UNWIND-PROTECT plays with *INTERRUPT-LEVEL*, so that
	cleanup forms run with interrupts disabled.  New scheme for special
	payback, so that restration of *INTERRUPT-LEVEL* polls for deferred
	interrupts.  Remove some old (unused) interrupt handling stuff.

2005-10-26 13:51  gb

	* lib/dumplisp.lisp: Enable interrupts before calling the first
	user toplevel function (not in RESTORE-LISP-POINTERS' cleanup form,
	since that's now ineffectual.)

2005-10-26 13:50  gb

	* lib/: ccl-export-syms.lisp, macros.lisp: Define & export
	WITH-INTERRUPTS-ENABLED.

2005-10-26 13:49  gb

	* level-0/l0-symbol.lisp: Minor indentation change.

2005-10-26 13:48  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: No such thing as :ADDRESS
	in vreg specs.	Get words size right in REF-INTERRUPT-LEVEL.

2005-10-26 13:47  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp: No such thing as :ADDRESS
	in vreg specs.

2005-10-26 13:46  gb

	* compiler/nx1.lisp: Remove a few old interrupt-handling things.

2005-10-26 05:51  gb

	* lib/macros.lisp: Define WITHOUT-INTERRUPTS and friends in terms
	binding CCL::*INTERRUPT-LEVEL*.

2005-10-26 04:44  gb

	* compiler/PPC/ppc2.lisp: Handling binding/unbinding of
	*interrupt-level* specially.

2005-10-26 04:43  gb

	* compiler/PPC/: PPC32/ppc32-vinsns.lisp, PPC64/ppc64-vinsns.lisp:
	*INTERRUPT-LEVEL* binding, unbinding, and reference.

2005-10-26 04:43  gb

	* compiler/nxenv.lisp: $undointerruptlevel.

2005-10-26 04:41  gb

	* lisp-kernel/macros.h: TCR_INTERRUPT_LEVEL is signed ...

2005-10-26 03:09  gb

	* lisp-kernel/spjump.s, compiler/subprims.lisp: Remove svar
	subprims; identify unused subprims; add support for binding/
	unbinding *interrupt-level* and associated polling for pending
	interrupts.

2005-10-26 03:05  gb

	* lisp-kernel/: constants32.s, constants64.h, constants64.s,
	spentry.s: Disavow all knowledge of svars.

2005-10-25 11:23  gb

	* compiler/PPC/: PPC32/ppc32-vinsns.lisp, PPC64/ppc64-vinsns.lisp:
	EVENT-POLL vinsn checks for pending interrupts.

2005-10-25 11:02  gb

	* xdump/xfasload.lisp: Arrgh.  (Duplicate binding index #1,
	sometimes.)

2005-10-25 05:03  gb

	* compiler/PPC/ppc-lapmacros.lisp,
	compiler/PPC/PPC32/ppc32-arch.lisp,
	compiler/PPC/PPC32/ppc32-vinsns.lisp,
	compiler/PPC/PPC64/ppc64-arch.lisp,
	compiler/PPC/PPC64/ppc64-vinsns.lisp, level-0/PPC/ppc-misc.lisp:
	replace references to tcr.interrupt level with (effectively)
	thread-specific binding of CCL::*INTERRUPT-LEVEL* on the lisp side,
	as well.

2005-10-25 03:40  gb

	* lisp-kernel/: constants32.h, constants32.s, constants64.h,
	constants64.s, lisp-exceptions.c, macros.h, macros.s,
	pmcl-kernel.c, spentry.s, thread_manager.c: deprecate (and stop
	using, at least in the kernel) tcr.interrupt_level; use
	tcr->tlb_pointer[INTERRUPT_LEVEL_BINDING_INDEX] instead (which just
	happens to be the dynamic value of CCL::*INTERRUPT-LEVEL*.)

2005-10-25 03:03  gb

	* lib/nfcomp.lisp, xdump/faslenv.lisp: Finish bumping FASL version.

2005-10-25 02:44  gb

	* lisp-kernel/thread_manager.c: tlb[INTERRUPT_LEVEL_BINDING_INDEX]
	== fixnum -1 in each new tcr.

2005-10-25 02:42  gb

	* lisp-kernel/constants.h: INTERRUPT_LEVEL_BINDING_INDEX ==
	(symbol-binding-index ccl::*interrupt-level*).
	
	(This means that the end of this bootstrapping cycle is in sight;
	perhaps after some food ...)

2005-10-25 02:39  gb

	* level-1/l1-readloop.lisp: QUIT needs to force-output on
	ccl::*stdout*, as many people have mentioned.

2005-10-25 02:38  gb

	* xdump/xfasload.lisp: Reserved binding index scheme, finally.

2005-10-25 00:51  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp,
	compiler/PPC/PPC64/ppc64-arch.lisp, level-0/l0-pred.lisp,
	level-0/l0-symbol.lisp, level-0/nfasload.lisp,
	level-1/l1-clos-boot.lisp, level-1/l1-io.lisp,
	level-1/l1-lisp-threads.lisp, lib/nfcomp.lisp, xdump/faslenv.lisp,
	xdump/xfasload.lisp: Remove SVAR type/class.  Use
	BINDING-INDEX-SYMBOL instead of INDEX-SVAR.

2005-10-24 23:49  gb

	* lib/prepare-mcl-environment.lisp: Don't use svars in
	%RESET-OUTERMOST-BINDING (which looks wrong, btw.)

2005-10-24 23:47  gb

	* compiler/PPC/: ppc2.lisp, PPC32/ppc32-vinsns.lisp,
	PPC64/ppc64-vinsns.lisp: Don't use svars in binding, special
	reference/assignment.

2005-10-24 23:04  gb

	* level-0/l0-symbol.lisp: No more SVAR-CHECK-SYMBOL-LIST.

2005-10-24 22:52  gb

	* compiler/PPC/: PPC32/ppc32-vinsns.lisp, PPC64/ppc64-vinsns.lisp:
	PROGVSAVE vinsn uses non-svar subprim.

2005-10-24 22:51  gb

	* compiler/subprims.lisp: Was out of synch with spjump.s.

2005-10-24 22:51  gb

	* compiler/nx1.lisp: Don't use svars in PROGV.

2005-10-24 22:10  gb

	* xdump/xfasload.lisp: When setting xload binding addresses, set
	symbol.binding-index cell (not svar.idx-cell ...)

2005-10-24 22:07  gb

	* level-0/PPC/ppc-symbol.lisp, level-1/l1-lisp-threads.lisp,
	level-1/ppc-threads-utils.lisp: Don't use svars at runtime.

2005-10-24 22:06  gb

	* level-0/nfasload.lisp: Keep track of binding indices assigned in
	the cold load.	(Could do this another way ...)

2005-10-24 22:05  gb

	* level-0/l0-symbol.lisp: CHECK-SYMBOL-LIST (used in PROGV) calls
	ENSURE-BINDING-INDEX.
	
	Don't use svars in %SYM-VALUE, etc.
	
	Keep binding indices and svar indices in synch.
	
	Add SYMBOL-BINDING-INDEX accessor, for debugging.

2005-10-24 07:00  gb

	* level-1/runtime.lisp: No need to clean up symbol.package-plist,
	which no longer exists.

2005-10-24 06:59  gb

	* lisp-kernel/: spjump.s, spentry.s: New (non-svar) subprims for
	special binding/access.

2005-10-24 06:58  gb

	* level-0/l0-symbol.lisp: New binding-index stuff.  May need to
	keep in synch with svar indices while weaning ourselves of svars;
	may need to do that weaning cold turkey.

2005-10-24 06:55  gb

	* xdump/faslenv.lisp, xdump/xfasload.lisp, level-0/nfasload.lisp,
	lib/nfcomp.lisp: New fasl ops: intern, create symbols and update
	their binding indices.

2005-10-24 06:54  gb

	* level-0/PPC/ppc-misc.lisp: .SPSVAR-UNBIND-TO is now just
	.SPUNBIND-TO.

2005-10-24 06:53  gb

	* compiler/PPC/ppc2.lisp: SVAR-DPAYBACK is now just DPAYBACK.

2005-10-24 06:53  gb

	* compiler/PPC/: PPC32/ppc32-vinsns.lisp, PPC64/ppc64-vinsns.lisp:
	Rename some unbinding vinsns, use new subprim names.

2005-10-24 06:52  gb

	* compiler/subprims.lisp: New subprims, to phase out svar-based
	special binding/access.  (Note that unbinding works the same way
	for svars/symbol-binding-indices; svar-based unbinding routines
	were just renamed.)

2005-10-23 04:44  gb

	* xdump/xfasload.lisp: New low-level plist stuff.

2005-10-23 04:44  gb

	* xdump/faslenv.lisp: Accept a slightly newer fasl version (not
	finished bootstrapping yet.)

2005-10-23 04:43  gb

	* lisp-kernel/linux64/Makefile: Depend on constants64.?

2005-10-23 04:42  gb

	* level-0/l0-symbol.lisp, level-0/nfasload.lisp,
	lib/source-files.lisp: Move symbol-plist to new symbol slot;
	simplify access to symbol package, type-predicate.

2005-10-23 04:41  gb

	* compiler/PPC/: PPC32/ppc32-arch.lisp, PPC64/ppc64-arch.lisp:
	Remove old symbol.package-plist constants.

2005-10-23 04:40  gb

	* compiler/: nx1.lisp, nxenv.lisp, PPC/ppc2.lisp,
	PPC/PPC32/ppc32-vinsns.lisp, PPC/PPC64/ppc64-vinsns.lisp: Open-code
	%SYMBOL->SYMPTR.

2005-10-23 01:42  gb

	* lisp-kernel/: constants64.h, constants64.s: New symbol slots on
	ppc64, too.

2005-10-23 01:41  gb

	* level-0/nfasload.lisp: Remove the crude bootstrapping hack (at
	least the most recent one ...)

2005-10-22 23:49  gb

	* xdump/xfasload.lisp: Start new symbol stuff.	More to be done
	here.

2005-10-22 23:49  gb

	* xdump/heap-image.lisp: ABI version change.

2005-10-22 23:49  gb

	* lisp-kernel/linux/Makefile: Depend on constants32.?

2005-10-22 23:49  gb

	* lisp-kernel/ppc_print.c: Symbol package isn't where it used to
	be.

2005-10-22 23:48  gb

	* lisp-kernel/image.h: New "abi" version, for symbol size/format
	changes.

2005-10-22 23:47  gb

	* lisp-kernel/gc.c: Anticipate the symbol-package/plist breakup.

2005-10-22 23:46  gb

	* level-0/nfasload.lisp: Add a very ugly bootstrapping hack, and a
	warning reminding that it should be removed.

2005-10-22 23:45  gb

	* level-0/l0-symbol.lisp: Initialize new symbol slots in
	MAKE-SYMBOL.

2005-10-22 23:45  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp, lisp-kernel/constants32.h,
	lisp-kernel/constants32.s: New symbol slots.

2005-10-22 23:44  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp: Add a couple of new fields to
	symbols; this is intended to help get rid of svar objects for
	thread-specific special bindings, and to make accessing a symbol's
	plist a little faster/simpler.
	
	Changing the size of a symbol introduces some bootstrapping issues;
	the bleeding-edge sources may not build until that bootstrapping
	process is complete (on all platforms); there will be new binaries
	then (probably sometime on October 23.)

2005-10-22 18:58  gb

	* lisp-kernel/spentry.s: newblocktag/newgotag have been obsolete
	for a few years now.

2005-10-22 18:57  gb

	* lisp-kernel/: constants.s, lisp_globals.h: A little kernel-global
	cleanup.

2005-10-22 18:17  gb

	* lib/macros.lisp: Add
	UNWIND-PROTECT-DISABLE-INTERRUPTS-DURING-CLEANUP, at least for the
	time being ...

2005-10-22 18:15  gb

	* level-1/l1-readloop-lds.lisp: An EOF in the REPL isn't
	"transient" if --batch is in effect.

2005-10-22 18:15  gb

	* compiler/X86/x86-asm.lisp: Still a ways from reality, but a
	little closer.

2005-10-22 18:14  gb

	* compiler/PPC/ppc-arch.lisp: go-tag-counter & block-tag counter
	have been obsolete for a few years.

2005-10-18 17:03  gb

	* level-1/l1-lisp-threads.lisp: THREAD-INTERRUPT: checked in
	unsaved buffer, bad version always returned NIL.

2005-10-17 22:52  gb

	* lisp-kernel/thread_manager.c: In xNewThread, try to detect
	stack/thread initialization failures.  SEM_WAIT_FOREVER for new
	thread activation.

2005-10-17 22:51  gb

	* lisp-kernel/lisp-exceptions.c: Don't maintain
	tcr.suspend_total_on_exception_entry.

2005-10-17 22:50  gb

	* library/lispequ.lisp: SEMAPHORE-NOTIFICATION stuff.

2005-10-17 22:49  gb

	* lib/ccl-export-syms.lisp: PROCESS-KILL-ISSUED,
	SEMAPHORE-NOTIFICATION-STATUS, CLEAR-SEMAPHORE-NOTIFICATION-STATUS,
	SEMAPHORE-NOTIFICATION, MAKE-SEMAPHORE-NOTIFICATION.

2005-10-17 22:47  gb

	* level-1/version.lisp: Bump.

2005-10-17 22:46  gb

	* level-1/linux-files.lisp: WAIT-ON-SEMAPHORE can accept a
	SEMAPHORE-NOTIFICATION object and set its status atomically.

2005-10-17 22:46  gb

	* level-1/l1-processes.lisp: SEMAPHORE-NOTIFICATION stuff. 
	PROCESS-INTERRIPT returns T on success.  Add PROCESS-KILL-ISSUED
	and SETF of it; make PROCESS-KILL set PROCESS-KILL-ISSUED.

2005-10-17 22:37  gb

	* level-1/l1-lisp-threads.lisp: INIT-THREAD-FROM-TCR, NEW-TCR:
	maybe no TCR, maybe no stack areas if out of memory/ out of thread
	resources.  THREAD-INTERRUPT returns T if a thread exists and a
	signal is successfully delivered.

2005-10-17 22:35  gb

	* level-1/l1-clos-boot.lisp: SEMAPHORE-NOTIFICATION objects.

2005-10-15 16:14  gb

	* compiler/PPC/ppc2.lisp: On PPC64, 64-bit memory accesses
	(accesses to signed/unsigned 64-bit integers or to pointers) with a
	constant 16-bit offset can only use LD/STD if the low 2 bits of
	that offset are 0.  Something like:
	
	(%get-ptr p 3)
	
	would have elicited a warning from the assembler that it's clearing
	those low 2 bits for you; that's maybe better than generating the
	wrong instruction, but it doesn't lead to "the pointer 3 bytes from
	p" being returned, either ...

2005-10-06 12:53  gb

	* level-1/version.lisp: Bump: "post-051006".

2005-10-06 12:27  gb

	* lib/macros.lisp: DEFCALLBACK-BODY: ppc64 changes: store all (64
	of 'em) bits of an integer return value. Store float return values
	2 natural words (16 bytes) into the argument area.

2005-10-05 12:17  gb

	* level-1/l1-processes.lisp: Fix typo.

2005-09-30 12:51  gb

	* library/chud-metering.txt: Flesh out a bit more.

2005-09-30 03:31  gb

	* library/chud-metering.txt: new file

2005-09-27 10:20  bryan

	* tools/asdf-install/: COPYRIGHT, defpackage.lisp, installer.lisp,
	port.lisp, doc/index.html: import latest asdf-install from cclan.

2005-09-26 08:57  gb

	* lib/macros.lisp: In DEFCALLBACK-BODY, coerce SINGLE-FLOAT result
	to DOUBLE-FLOAT, store in argument area via (SETF
	(%GET-DOUBLE-FLOAT ,stack-ptr ,offset)).  (E.g., un-break what got
	broken a month or so ago.)

2005-09-24 16:05  gb

	* level-1/version.lisp: Bump.

2005-09-24 15:53  gb

	* lisp-kernel/image.h: Bump ABI_VERSION_MIN.

2005-09-24 15:52  gb

	* level-0/l0-hash.lisp, lib/hash.lisp: Thread-private hash tables
	store/check *CURRENT-PROCESS* instead of (%CURRENT-TCR), since TCRs
	get recycled.

2005-09-24 05:03  gb

	* lisp-kernel/gc.c: Clear hash-table-vector caches if the
	hash-table is weak (on key or value.)
	
	Could be smarter about this (e.g., treat them as weak references),
	but don't want things to stay around just because they're
	referenced from the cache.

2005-09-24 04:43  gb

	* lisp-kernel/plbt.c: #include <stdint.h>, so that this compiles
	under Jaguar.

2005-09-22 22:39  gb

	* level-1/version.lisp: Bump, 1.0-rc1.

2005-09-22 22:39  gb

	* lib/setf.lisp: Back out of change to DECF, 'til after 1.0.

2005-09-21 04:37  gb

	* lib/hash.lisp: START-HASH-TABLE-ITERATOR: use LOCK-HASH-TABLE
	instead of manipulating the exclusion lock directly.
	
	FINISH-HASH-TABLE-ITERATOR: use UNLOCK-HASH-TABLE.

2005-09-21 02:57  gb

	* lisp-kernel/spentry.s: In _SPset_hash_key, ensure that a local
	label "2" is defined (so that "(bne 2f)" branches to the right
	place.)

2005-09-13 22:37  gb

	* level-1/version.lisp: Bump; call it a "test" release.

2005-09-13 22:36  gb

	* xdump/heap-image.lisp: ABI-VERSION 1003.

2005-09-13 22:30  gb

	* lib/macros.lisp: %WITH-RECURSIVE-LOCK-PTR uses a
	LOCK-ACQUISITION.

2005-09-13 22:29  gb

	* level-1/l1-processes.lisp: Locking primitives accept optional
	LOCK-ACQUISITION objects.
	
	Accesors (get, clear) for LOCK-ACQUISITION objects; PRINT-OBJECT
	method.

2005-09-13 22:27  gb

	* level-0/l0-misc.lisp: Accept and update a LOCK-ACQUISITION object
	when locking (or trying to).

2005-09-13 22:26  gb

	* level-0/l0-hash.lisp: PUTHASH: don't complain about mapping
	conflicts unless we try to remove something and it's not at the
	current iteration index.

2005-09-13 22:20  gb

	* lib/ccl-export-syms.lisp: Export LOCK-ACQUISITION,
	MAKE-LOCK-ACQUISITION, LOCK-ACQUISITION-STATUS, and
	CLEAR-LOCK-ACQUISITION-STATUS.

2005-09-13 21:12  gb

	* library/lispequ.lisp: Accessor, constructor for LOCK-ACQUISITION.

2005-09-13 21:11  gb

	* level-1/l1-clos-boot.lisp: BUILT-IN-CLASS for LOCK-ACQUISITION.

2005-09-13 21:08  gb

	* release-notes.txt: Mention CPU-COUNT.

2005-09-13 19:32  gb

	* lisp-kernel/image.c: On PPC64, save_application() writes the
	image and section headers after writing the section contents,
	maintains the offset from the end of those headers to the start of
	section data in the (split) 64-bit section_data_offset field(s) of
	the header.  (This should allow very large sections to be written;
	the offset from the trailer at the end of the file to the header
	has to fit in 32 bits, and - if the header preceded the section
	data - would have constained the entire image to about 2GB.)

2005-09-13 19:28  gb

	* lisp-kernel/image.h: high half of PPC64 section_data_offset field
	is signed, low half unsigned.

2005-09-13 16:15  gb

	* lisp-kernel/: image.h, image.c: Split section_data_offset in
	half, to deal with alignment issues.

2005-09-13 16:01  gb

	* lisp-kernel/lisp-exceptions.c: If gc is inhibited on entry,
	ensure that GC_INHIBIT_COUNT looks negative.  (%UNLOCK-GC-LOCK
	should increment it in this case, and do a gc trap if it goes from
	-1 to 0.)

2005-09-13 15:59  gb

	* lisp-kernel/image.c: On ppc64, zero (for now)
	fh.section_data_offset; zeroing "pad" array only happens on ppc32.

2005-09-13 15:58  gb

	* lisp-kernel/image.h: Fix newly-introduced typo.

2005-09-13 15:53  gb

	* lisp-kernel/asmutils.s: Move the "strange reference to exp()"
	from current_stack_pointer() - which is probably inlined - to
	flush_cache_lines().  Make it a data reference, and make it
	word-size dependent.

2005-09-13 15:50  gb

	* lisp-kernel/m4macros.m4: exportfn generates and exports .foo as
	well as foo when #+(and LINUX PPC64).

2005-09-13 15:48  gb

	* lisp-kernel/linux64/elf64ppc.x: Some older toolchains don't
	recognize DATA_SEGMENT_RELPRO_END (and, frankly, neither do I.) 
	Comment out the reference, and see if it's important on platforms
	that -do- reference it.

2005-09-13 15:36  gb

	* lib/hash.lisp: If reloading a hash table from a fasl file, use
	the GENERAL-HASH-FIND[-FOR-PUT] functions instead of anonymous
	lambdas.

2005-09-13 15:33  gb

	* lisp-kernel/gc.h: No compression in SAVE-APPLICATION, so lose
	GC_TRAP_FLAG_COMPRESS.

2005-09-13 15:31  gb

	* lisp-kernel/lisp-exceptions.c, lisp-kernel/image.h,
	lisp-kernel/image.c, lib/dumplisp.lisp: No compression in
	SAVE-APPLICATION.

2005-09-12 21:14  gb

	* level-0/l0-hash.lisp: In %NEEDS-REHASHING: both (GC-COUNT) and
	(NHASH.GC-COUNT hash) are fixnums.
	
	When creating a hash table, use new GENERAL-HASH-FIND and
	GENERAL-HASH-FIND-FOR-PUT, rather than anonymous lambdas, for the
	non-EQ/non-EQL cases.
	
	PUTHASH's iteration check looks at all pending iterators, uses
	hash-table-test to compare keys.  REMHASH wasn't checking.  (Sorry,
	I thought that I'd checked this in already.)
	
	In %GROW-HASH-TABLE, remove a PROGN and a comment; remove "can't
	happen" check of nhash.lock, which should be mostly unused.  Only
	process a key from the vector if it's neither FREE-HASH-KEY-MARKER
	nor DELETED-HASH-KEY-MARKER (code was just checking for (EQ KEY
	(%UNBOUND-MARKER)), where (%UNBOUND-MARKER) ==
	FREE-HASH-KEY-MARKER.)	This *might* cause keys to become lost
	(leading to duplicate key errors), or might not.
	
	%REHASH doesn't clear cache key, since DO-REHASH always clears it.

2005-09-10 21:47  gb

	* level-1/version.lisp: Bump.

2005-09-10 21:36  gb

	* level-0/l0-symbol.lisp: Fix other typos.

2005-09-10 21:34  gb

	* level-1/l1-readloop.lisp: Fix typo.

2005-09-10 21:30  gb

	* level-1/l1-readloop.lisp: CCL::TOPLEVEL isn't too well-defined
	outside of the initial process; let it do PROCESS-RESET in that
	case.

2005-09-10 21:27  gb

	* level-0/l0-symbol.lisp: %SYM-VALUE, %SET-SYM-VALUE: don't create
	an SVAR; only call %FIND-SVAR if not constant/global.
	
	The idea of pre-allocating a reserved svar-idx for
	*INTERRUPT-LEVEL* doesn't work too well, since nothing references
	that svar (and since the hash table's weak).  Post-1.0.

2005-09-08 22:43  gb

	* level-0/l0-hash.lisp: In PUTHASH, increment (nhash.count hash)
	when overwriting a deleted entry.
	
	Clobber cached value too when starting to DO-REHASH.
	
	When DO-REHASH encounters a deleted entry, change it to free; among
	other things, this keeps it from getting counted more than once,
	and doing that could cause the nhash.vector.deleted-count to go
	negative.
	
	(This seems to be what was causing problems with the weak hash
	tables that're used to map symbols to SVAR objects used by the
	special variable binding mechanism: otherwise unreferenced keys
	(symbols) had their entries removed by the GC; DO-REHASH saw the
	deleted entries when the hash table was rehashed after GC and
	counted them multiple times, causing the deleted count to go
	negative and the hash-table's size to be miscalcuated.	It'd
	eventually become completely full, which isn't ever supposed to
	happen, and the failure involves a SEGFAULT.)
	
	I believe this was causing the problems that Bryan reported
	encountering while compiling SBCL.

2005-09-08 13:39  bryan

	* level-1/l1-typesys.lisp: 
	csubtypep: we shouldn't answer definitively about all cases when
	type1 is *wild-type* or type2 is *empty-type*.	don't special case
	and let invoke-type-method deal with them.

2005-09-08 03:46  gb

	* level-1/l1-error-system.lisp: APPLICABLE-RESTART-P: don't bother
	searching for null conditions (shouldn't have found any, in any
	case.)
	
	FIND-RESTART and COMPUTE-RESTARTS call APPLICABLE-RESTART-P to
	invoke any restart test function even when condtion is NIL.
	
	INVOKE-RESTART-INTERACTIVELY defined in terms of FIND-RESTART,
	INVOKE-RESTART (just so that there'd be less to go wrong if the
	internals of %ACTIVE-RESTART change.)

2005-09-08 02:12  bryan

	* level-1/version.lisp: bump.

2005-09-07 20:47  bryan

	* level-1/l1-typesys.lisp: 
	make-member-ctype: if doublep and not singlep, use
	*ctype-of-double-float-0*.

2005-09-07 18:38  bryan

	* level-1/l1-typesys.lisp: 
	array :simple-intersection type-method tries to be more smarter
	about element-types.  (patch ported from SBCL)
	
	specialized-element-type of (array nil) is now nil (as opposed to
	bit).

2005-09-07 14:18  bryan

	* level-1/l1-typesys.lisp: 
	number :simple-union should also check the case when a rational
	type is adjacent to an integer type.  (patch ported from SBCL)
	
	union (integer 0 0) (rational (0)) ==> (rational 0)

2005-09-07 12:33  bryan

	* level-1/l1-typesys.lisp: 
	CONS :simple-union type-method should do a little more work for
	"harder to compute" CONS types especially involving negation. 
	(patch corresponds to SBCL src/code/late-type.lisp v1.100)

2005-09-07 06:15  gb

	* release-notes.txt: First stab at enumerating new features for
	1.0.

2005-09-07 02:00  bryan

	* level-1/version.lisp: bump.

2005-09-07 01:51  bryan

	* level-1/l1-typesys.lisp: 
	type-intersection of numeric types with same numeric lower bound
	(one exclusive, one not) would return a more inclusive type.
	
	type-intersection '(short-float (0.0)) '(short-float 0.0) =>  
	'(short-float (0.0))   ;; not '(short-float 0.0)

2005-09-06 17:15  gb

	* level-1/version.lisp: Bump.

2005-09-06 06:00  gb

	* lisp-kernel/lisp-exceptions.c: Handle
	GC_TRAP_FUNCTION_IMMEDIATE_GC, by trying to invoke the GC ...
	immediately.  Should maybe try to determine if it's necessary,
	since there are race conditions.

2005-09-06 05:58  gb

	* lisp-kernel/gc.h: Define GC_TRAP_FUNCTION_IMMEDIATE_GC.

2005-09-06 05:57  gb

	* level-0/l0-hash.lisp: MAKE-HASH-TABLE ... :SHARED NIL creates a
	hash table that's effectively always locked by the calling thread;
	creation, GET/PUT/REMHASH use new locking primitives.
	
	Simplify PUTHASH a little; don't maintain NHASH.PUTHASH-COUNT,
	handle the replace/free/overwrite-deleted-entry cases separately.

2005-09-06 05:52  gb

	* level-0/PPC/ppc-misc.lisp: %LOCK-GC-LOCK either increments or
	decrements the gc inhibition lock.  %UNLOCK-GC-LOCK does the
	inverse, and tries to invoke the GC if it increments from -1 to 0.
	
	(The idea is that if the GC tries to run when the inhibition value
	is non-zero, the GC will ensure that that non-zero value is
	negative.  That doesn't work yet; it's easy, but it's another case
	where the kernel and image need to be synched.)

2005-09-06 05:48  gb

	* lib/hash.lisp: MAKE-LOAD-FORM for HASH-TABLEs handles "private"
	(thread-owned) hash-tables.  (Since we can't exactly dump a thread,
	they become owned by whatever thread loads them.)
	
	FASL locking/unlocking of hash tables handles the thread-owned
	cases.

2005-09-06 05:46  gb

	* library/lispequ.lisp: Replace unused NHASH.LOCKED-ADDITIONS cell
	with NHASH.OWNER.

2005-09-06 05:44  gb

	* level-0/l0-init.lisp: Add :OPENMCL-PRIVATE-HASH-TABLES to
	*FEATURES*.

2005-09-05 23:54  bryan

	* lib/setf.lisp: 
	decf: define as separate macro to honor order of arg evaluation per
	ansi 5.1.3.  (a similar macro is needed for incf, but it breaks
	bootstrapping.)

2005-09-05 19:45  gb

	* lib/hash.lisp: Update MAKE-LOAD-FORM, fasl-related locking for
	the new order (and/or for native threads, which happened a few
	years ago, depending on your point of view.)
	
	Try to remove outright lies from the comments.

2005-09-05 18:55  gb

	* level-1/version.lisp: "b" is for "better ..."

2005-09-05 18:46  gb

	* level-0/l0-hash.lisp: hash-find functions: FIRST-DELETED-INDEX is
	always a fixnum or NIL, never T.  Return FIRST-DELETED-INDEX if a
	secondary probe finds a free entry and FIRST-DELETED-INDEX is
	non-nil.  (Always return an index.)
	
	(In some cases, we were returning T instead of an index from a
	probe functions.   Some callers errored trying to do (1+ T), some
	callers had aggressive fixnum/optimize declarations that caused 1
	to be added to T and the result used to access the hash vector.
	
	It's OK if the declarations are aggressive, unless they're wrong,
	of course.

2005-09-05 14:02  bryan

	* level-1/l1-sysio.lisp: 
	(defclass file-stream): rename original-name slot to
	actual-filename.
	
	stream-original-name, (setf stream-original-name): renamed to
	stream-actual-filename, (setf stream-actual-filename).
	
	make-file-stream, close: use renamed functions.
	
	make-file-stream: if filename is relative, use (full-pathname
	filename).  we don't call full-pathname if the filename is absolute
	to avoid clobbering a logical-pathname with its non-logical
	counterpart.  (maybe full-pathname should do that for us?)
	
	make-file-stream, close: use ccl::unix-rename instead of
	cl:rename-file to avoid merge-pathnames issues when filename has no
	type.

2005-09-05 07:55  gb

	* level-1/version.lisp: Bump.

2005-09-05 07:55  gb

	* level-0/l0-hash.lisp: In REMHASH: if the key being removed
	happens to also be in the cache, set the vector entry to
	DELETED-HASH-KEY-MARKER.

2005-09-05 07:53  gb

	* lisp-kernel/constants64.h: Define slot_unbound for ppc64.

2005-09-05 01:34  gb

	* lisp-kernel/image.h: Bump ABI_VERSION_*, for hash-table related
	changes.

2005-09-05 01:33  gb

	* xdump/heap-image.lisp: Bump *image-abi-version*.

2005-09-05 01:10  gb

	* level-0/l0-hash.lisp: Lots of changes.
	
	This code hasn't really supported any kind of concurrent access in
	a long time, so a lot of things (nhash.lock,
	nhash.locked-additions) have been adding some combination of
	clutter/overhead here.
	
	Inline a lot more, use more aggressive OPTIMIZE declarations.
	
	Try to avoid UNWIND-PROTECT overhead associated with locking and
	unlocking, disabling interrupts, inhibiting GC: wait for/grab the
	lock early, disable interrupts while doing so, assume that
	unlocking happens (without need to use UNWIND-PROTECT) because code
	is uninterruptible.
	
	Try to enforce restrictions on (SETF GETHASH)/REMHASH behavior
	while mapping is in effect.  (Needs work.)
	
	Represent keys in deleted key/value pairs as SLOT-UNBOUND-MARKERs,
	so that we can tell whether an entry is empty or deleted with a
	single memory reference.
	
	Try to avoid excessive generality by using specialized lookup
	functions (at least for EQ/EQL tables).  Might want to define these
	via MACROLET'ed code, since there's a lot of redundancy here; see
	%HASH-PROBE (which also tries to specialize the redundancy.

2005-09-05 00:23  gb

	* lisp-kernel/gc.c: Don't invalidate cached hash_table key/value
	pairs here; let lisp code do it if/when it notices that rehashing
	is necessary.
	
	When deleting a (weak) pair, use slot_unbound (rather than unbound)
	to mark the key as having been deleted.

2005-09-05 00:21  gb

	* lisp-kernel/constants32.h: Define slot_unbound,
	slot_unbound_marker.

2005-09-05 00:20  gb

	* lib/macros.lisp: WITH-HASH-TABLE-ITERATOR: assume that locking,
	GC inhibition happen inside START-HASH-TABLE-ITERATION and
	STOP-HASH-TABLE-ITERATION; don't expand into code which does these
	things explicitly.

2005-09-05 00:19  gb

	* level-0/PPC/ppc-utils.lisp: SET-LISP-HEAP-GC-THRESHOLD does
	nothing (and returns NIL) if its argument isn't a non-negative
	fixnum.

2005-09-05 00:18  gb

	* level-0/PPC/ppc-misc.lisp: Don't do any SYNCing or ISYNCing
	before or after %LOCK-GC-LOCK and %UNLOCK-GC-LOCK.  (This needs to
	be tested on MP systems, which is one reason for checking this code
	in now.)

2005-09-05 00:16  gb

	* lib/hash.lisp: WITH-HASH-TABLE-ITERATOR: assume that locking, GC
	inhibition happen inside START-HASH-TABLE-ITERATION and
	STOP-HASH-TABLE-ITERATION; don't expand into code which does these
	things explicitly.

2005-09-05 00:15  gb

	* library/lispequ.lisp: replace unused NHASH.MAP-COUNT with
	NHASH.ITERATOR.  Add NHASH.FIND and NHASH.FIND-NEW function slots
	to NHASH accessors.

2005-09-05 00:13  gb

	* lisp-kernel/darwin/Makefile: CHEADERS includes constants32.h.

2005-09-05 00:12  gb

	* xdump/hashenv.lisp: secondary-keys-*-2 holds double values of the
	secondary-keys primes.
	
	Hash-table-iterators don't track "locked-additions", but do keep
	track of the previous iterator (for recursive calls.)

2005-09-04 23:56  gb

	* level-1/l1-aprims.lisp: Reformat some comments.

2005-09-04 23:53  gb

	* level-0/l0-symbol.lisp: Define *INTERRUPT-LEVEL* and try to
	guarantee that it's the first svar.  (This is intended to allow
	WITHOUT-INTERRUPTS to be defined as (mostly) a special binding of
	*INTERRUPT-LEVEL*, since special binding is cheaper than
	UNWIND-PROTECT, but doing that sanely may take a while.)

2005-09-04 23:50  gb

	* level-0/l0-misc.lisp: WRITE-LOCK-RWLOCK-DISABLE-INTERRUPTS: does
	WRITE-LOCK-RWLOCK and disables interrupts in one operation. 
	(Interrupts are enabled if it has to spin waiting for the lock.)

2005-09-04 23:48  gb

	* compiler/PPC/ppc2.lisp: Use ACODE-S16-CONSTANT-P to recognize
	unbound/slot-unbound markers as 16-bit constants.

2005-09-04 23:47  gb

	* compiler/nxenv.lisp: Be more careful about asserting that things
	that can have side-effects have the SIDE-EFFECT-FREE attribute.

2005-09-04 23:45  gb

	* compiler/nx0.lisp: ACODE-16-BIT-CONSTANT-P recognizes
	unbound/slot-unbound markers, as well as fixnum constants whose
	boxed representation is (SIGNED-BYTE 16).

2005-09-04 23:39  gb

	* lib/macros.lisp: Don't try to reference STACK-PTR when tracing in
	DEFCALLBACK-BODY; it may never have been bound.  (Should probably
	try to separate the traced case from the non-traced case better in
	all of this.)

2005-09-04 17:44  bryan

	* level-1/l1-typesys.lisp: (def-type-translator complex ...)
	
	ratio and bignums aren't properly handled because they are
	represented by intersection and union ctypes.  teach it just enough
	to deal with them and other simple variants.  more work (and
	understanding on my part) will be needed to handle more complex
	(har har) types.
	
	ported from sbcl 0.9.4.23.

2005-09-02 04:06  gb

	* lib/time.lisp: GET-INTERNAL-REAL-TIME basically tracks elapsed
	time since the first time it's called in a session, is more likely
	to return fixnums after that first call.

2005-09-02 04:05  gb

	* lisp-kernel/lisp-exceptions.c: pc_luser_xp(): allow catch_frame
	initialization to be interrupted, do the right thing if it is.

2005-09-02 04:04  gb

	* lisp-kernel/lisp-exceptions.h: Recognize instructions
	(str(rX,nnn(nargs))) used to initialize catch frames.

2005-09-02 04:03  gb

	* lisp-kernel/macros.s: Try to make catch/unwind-protect frames
	faster: allocate on the tstack in an unboxed frame, use NARGS as a
	base register, set each field individually and in order, then
	change the tstack frame to 'boxed'.
	
	pc_luser_xp() recognizes stores relative to nargs and zeroes out
	any partially initialized fields in the catch frame.

2005-09-02 00:49  bryan

	* level-1/version.lisp: bump.

2005-09-01 22:33  bryan

	* level-1/l1-reader.lisp: the reader gets first dibs on arithmetic
	errors.
	
	signal a reader-error when an "impossible number" is read.  also
	display the (more informative) original error.

2005-09-01 07:28  gb

	* lisp-kernel/spentry.s: be more careful about restoring saveregs
	after ff-call, syscall: set to zero, change tcr valence back to
	lisp, -then- vpop_saveregs.
	
	eabi_syscall wasn't saving/restoring NVRs at all; even though
	they're preserved across syscalls, we need to have their values
	somewhere that the GC can see them in case GC occurs while current
	thread is blocked in syscall.  (Doing GC in Slime is one way to
	trigger this, since a few threads are blocked in syscall.)  This
	doesn't seem to have been newly introduced, but NVRs may be more
	likely to contain relocatable lisp values when syscalls are entered
	because of register allocation changes.
	
	There was also a Linux-specific change that did a "stw" into
	tcr.valence; that wants to use the "str" macro for PPC64.
	
	These changes haven't yet been tested under Darwin; they -look-
	right, but beware.

2005-09-01 07:20  gb

	* lisp-kernel/gc.c: Indentation changes only.

2005-08-31 15:36  gb

	* compiler/nx1.lisp: NX1-1D-VSET, NX1-1D-VREF: only transform into
	a typed uvref if the array's declared/known to be simple.

2005-08-30 21:00  gb

	* level-1/linux-files.lisp: It shouldn't matter too much, but the
	newly documented WAIT-ON-SEMAPHORE uses an internal timeout of 1
	second (vice 0 seconds.)

2005-08-30 20:59  gb

	* lisp-kernel/thread_manager.c: On older versions of LINUX,
	sem_timedwait() may not return error status correctly (see
	<http://carcino.gen.nz/tech/linux/glibc_sem_timedwait_errors.php>);
	code here was recently changed to assume that errors were always
	returned in errno.
	
	Assume that errno is only set correctly if the return value is
	negative; this seems to fix at least some problems with SLIME,
	OpenMCL, and old Linux C libraries.

2005-08-30 14:24  bryan

	* level-0/l0-array.lisp, lib/macros.lisp, lib/streams.lisp: add doc
	strings

2005-08-30 13:59  bryan

	* level-1/l1-io.lisp, lib/macros.lisp, lib/streams.lisp: add more
	doc strings.

2005-08-30 10:26  bryan

	* compiler/PPC/ppc-lapmacros.lisp, level-1/l1-boot-2.lisp,
	level-1/l1-init.lisp, lib/prepare-mcl-environment.lisp: add doc
	strings to development-mode dictionary.

2005-08-30 09:52  bryan

	* level-0/PPC/ppc-utils.lisp, level-1/l1-aprims.lisp: add doc
	strings to garbage collection dictionary

2005-08-30 01:31  bryan

	* level-1/version.lisp: bump.

2005-08-30 01:26  bryan

	* level-1/: l1-reader.lisp, l1-sysio.lisp, linux-files.lisp: add
	doc strings for operating-system dictionary

2005-08-30 01:11  bryan

	* level-0/l0-cfm-support.lisp, level-0/PPC/ppc-def.lisp,
	level-1/l1-lisp-threads.lisp, level-1/linux-files.lisp,
	lib/foreign-types.lisp, lib/macros.lisp: add doc strings for the
	foreign-function-interface dictionary.

2005-08-30 00:20  bryan

	* level-1/linux-files.lisp: add doc strings for external-program
	dictionary.

2005-08-30 00:06  bryan

	* level-1/l1-sockets.lisp: add doc strings for sockets dictionary.

2005-08-29 23:24  bryan

	* level-0/l0-aprims.lisp, level-1/l1-processes.lisp,
	level-1/l1-streams.lisp, level-1/linux-files.lisp, lib/macros.lisp:
	add doc strings for the threads dictionary.

2005-08-28 22:19  gb

	* xdump/xfasload.lisp: Optionally suppress messages about cold-load
	functions and their addresses.

2005-08-28 22:18  gb

	* lisp-kernel/darwin/Makefile: Base the choice of -lgcc vs.
	-lSystemStubs on the GCC version, not the availability of
	-lSystemStubs.

2005-08-28 17:22  gb

	* xdump/xfasload.lisp: TARGET-XLOAD-LEVEL-0 prints a message
	reminding us of the bootstrapping image's name and location.

2005-08-28 17:13  gb

	* level-1/version.lisp: Bump.

2005-08-28 16:55  gb

	* lib/macros.lisp: WITH-HASH-TABLE-ITERATOR: get a clue, don't
	evaluate argform twice.

2005-08-28 16:45  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: ppc64::tag-misc ->
	ppc64::fulltag-misc in ISTRUCT-TYPEP vinsn.

2005-08-28 16:44  gb

	* library/lispequ.lisp: Hash-table accessors here.

2005-08-28 16:44  gb

	* lib/macros.lisp: Hash-table locking macros here.

2005-08-28 16:43  gb

	* lib/hash.lisp: Move hash-table accessors (nhash.*) to the
	more-public lispequ.lisp.

2005-08-28 16:42  gb

	* xdump/hashenv.lisp: Move WITH-EXCLUSIVE-HASH-LOCK,
	WITH-HASH-WRITE-LOCK to macros.lisp, since we want them to be used
	in more-public code (WITH-HASH-TABLE-ITERATOR).

2005-08-28 01:33  gb

	* lisp-kernel/lisp-exceptions.c: Fix typo (extra #else).

2005-08-28 01:32  gb

	* library/chud-metering.lisp: Ignore errors (CHUD state) when
	cleaning up on exit.

2005-08-28 01:29  gb

	* lisp-kernel/lisp-exceptions.c: Bigger red zone, larger stack
	alignment on ppc64.

2005-08-28 01:28  gb

	* level-1/version.lisp: Bump.

2005-08-28 01:27  gb

	* lib/macros.lisp: WITH-HASH-TABLE-ITERATOR locks table & disables
	GC.

2005-08-28 01:26  gb

	* level-0/l0-hash.lisp: If we have to obtain an exclusive lock on
	the hash table and disable GC (as is currently the case), wait for
	the lock first.

2005-08-28 01:25  gb

	* compiler/: nx1.lisp, nxenv.lisp, PPC/ppc2.lisp,
	PPC/PPC32/ppc32-vinsns.lisp, PPC/PPC64/ppc64-vinsns.lisp: Inline
	ISTRUCT-TYPEP.

2005-08-28 00:58  gb

	* lib/hash.lisp: Remove a few stale comments.

2005-08-27 21:26  gb

	* lisp-kernel/Threads.h: Conditionalize SEM_WAIT_FOREVER for Darwin
	(especially Darwin64).

2005-08-26 04:41  gb

	* lisp-kernel/lisp-exceptions.c: Something's got to reset
	tcr->interrupt_level after an interrupt trap.

2005-08-25 00:27  gb

	* lisp-kernel/lisp-exceptions.c: Don't play with interrupt level
	before callbacks; callbacks can do so themselves.

2005-08-25 00:26  gb

	* lisp-kernel/thread_manager.c: Don't loop if SEM_WAIT_WITH_TIMEOUT
	gets interrupted; return to lisp code (so that the interrupt can be
	serviced) and let lisp code decide whether or not to retry.

2005-08-25 00:25  gb

	* lisp-kernel/Threads.h: Define SEM_WAIT_FOREVER, for kernel
	routines that should just restart a SEM_WAIT() call.

2005-08-25 00:24  gb

	* lib/backtrace-lds.lisp: Format a comment better.

2005-08-25 00:23  gb

	* level-1/linux-files.lisp: Semaphore waiting functions assume that
	%wait-on-semaphore-pointer returns a second value (a POSIX-style
	error number).
	
	Handle retries because of #$EINTR in lisp code (don't loop
	uninterruptibly in the kernel.)

2005-08-25 00:22  gb

	* level-1/l1-readloop-lds.lisp: Ensure that interrups are enabled
	around a break loop.

2005-08-25 00:21  gb

	* level-1/l1-numbers.lisp: Arrgh.  INITIALIZE-RANDOM-STATE uses
	%ILSL to shift, since ASH produces an arithmetically correct
	bignum, and we don't want that.

2005-08-25 00:20  gb

	* level-0/l0-misc.lisp: Wait for lock's semaphore in one-second
	intervals.

2005-08-24 14:21  gb

	* level-0/l0-hash.lisp: Restore some of the "locked additions"
	handling in GETHASH, since I probably haven't thought about the
	implications of removing it carefully enough.

2005-08-24 14:19  gb

	* lisp-kernel/gc.c: Fix handling of populations in recursive case
	of rmark.

2005-08-24 13:58  gb

	* level-1/version.lisp: Bump.

2005-08-24 13:58  gb

	* level-0/l0-misc.lisp: Tweak ROOM output.

2005-08-24 05:47  gb

	* level-0/l0-hash.lisp: We don't actually use WITH-REHASH-LOCK, and
	don't want to allocate an nhash.rehash-lock.
	
	Remove a little (currently dead) code from the start of GETHASH.

2005-08-24 05:46  gb

	* xdump/hashenv.lisp: We don't actually use WITH-REHASH-LOCK, and
	don't want to allocate an nhash.rehash-lock.

2005-08-24 05:45  gb

	* lib/hash.lisp: Remove a newline, add a semicolon at top of file.

2005-08-24 01:41  gb

	* lisp-kernel/pmcl-kernel.c: current_stack_pointer() already
	prototyped, inlined; need to cast to BytePtr.

2005-08-24 01:40  gb

	* lisp-kernel/lisp-exceptions.c: current_stack_pointer() already
	prototyped, inlined.

2005-08-24 01:39  gb

	* lisp-kernel/gc.c: Make rmark() recursive, if there's enough stack
	space.	(Falls back to	Deutch-Waite-Schorr pointer inversion if
	there isn't enough stack space.)

2005-08-24 01:38  gb

	* lisp-kernel/bits.h: Prototype for inlined
	current_stack_pointer().  (Prototyped to return a "natural"; some
	previous uses prototyped to return a "BytePtr".)

2005-08-24 01:37  gb

	* lib/ccl-export-syms.lisp: Export *REPORT-TIME-FUNCTION*.

2005-08-24 01:36  gb

	* lib/misc.lisp: Add *REPORT-TIME-FUNCTION*, which allows
	customization of the presentation of TIME's output.

2005-08-24 01:35  gb

	* release-notes.txt: New file.

2005-08-23 20:03  gb

	* level-0/PPC/ppc-def.lisp: Still more indentation problems.

2005-08-23 19:52  gb

	* level-0/PPC/ppc-def.lisp: Some of the work that needed to be done
	on 64-bit %FF-CALL involved indenting properly.  Basic cases now
	seem to work.

2005-08-23 19:11  gb

	* level-0/PPC/ppc-def.lisp: First cut of ppc64 %FF-CALL.  Needs
	more work.

2005-08-23 19:10  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp:
	ALLOC-VARIABLE-EABI-C-FRAME.

2005-08-23 06:39  gb

	* compiler/: nx1.lisp, nxenv.lisp: WITH-VARIABLE-C-FRAME.
	
	Lose %VREFLET.

2005-08-23 06:39  gb

	* compiler/PPC/ppc2.lisp: WITH-VARIABLE-C-FRAME.
	
	PPC2-NLEXIT discards C frames.

2005-08-23 06:37  gb

	* compiler/PPC/: PPC32/ppc32-vinsns.lisp, PPC64/ppc64-vinsns.lisp:
	ALLOC-VARIABLE-C-FRAME vinsns.

2005-08-23 06:37  gb

	* level-1/l1-numbers.lisp: INITIALIZE-RANDOM-STATE uses ASH instead
	of CCL::%ILSL; note that ASH takes args in the opposite order from
	%ILSL.

2005-08-23 06:35  gb

	* level-1/l1-utils.lisp: Update the list of
	implementation-dependent special operators: drop %VREFLET and
	SPARC-LAP-FUNCTION (!), add WITH-C-FRAME and WITH-VARIABLE-C-FRAME.

2005-08-23 06:34  gb

	* level-1/version.lisp: Change major version to 1, minor version to
	0.  Change format of *OPENMCL-VERSION* format string (move version
	number before release level, ~A for platform.) "Upgrade" ppc32 to
	release level, ppc64 to beta.

2005-08-23 06:32  gb

	* lib/compile-ccl.lisp: Ensure that (COMPILE-CCL) updates NXENV
	before compiling the rest of the compiler.

2005-08-23 06:31  gb

	* lib/ppcenv.lisp: Remove some unused constants.

2005-08-22 19:07  gb

	* lib/numbers.lisp: The seed values in a RANDOM-STATE can have
	their sign bits set on PPC32, so the PRINT-OBJECT method uses LDB
	to access the signigicant parts of those values.
	
	(Next bug: rewrite this stuff completely; it's not a very good
	random number generator.)

2005-08-22 18:12  gb

	* level-1/linux-files.lisp: Tweak Linux CPU-COUNT.

2005-08-22 17:59  gb

	* level-1/linux-files.lisp: Provide a minimal definition of ED; use
	*RESIDENT-EDITOR-HOOK* to provide a real definition if/when a
	resident editor is available.
	
	Define CPU-COUNT, which returns ... the number of CPUs (1 or more)
	available.

2005-08-22 17:56  gb

	* lib/ccl-export-syms.lisp: Export *RESIDENT-EDITOR-HOOK* and
	CPU-COUNT.

2005-08-22 16:19  gb

	* level-1/l1-files.lisp: FASL-FILE-P thinks that files that start
	with a byte of #xFF are fasl files.

2005-08-22 13:40  bryan

	* lib/nfcomp.lisp: 
	%compile-file: set *compile-file-truename* to (truename src).

2005-08-22 04:13  gb

	* lib/nfcomp.lisp: Wrap a HANDLER-BIND around compile-time
	evaluation, in case either compile-time evaluation or the
	compilation which implements part of it signals a warning that
	might be considered to have been "detected by the compiler".
	
	Another reasonable interpretation would seem to be that warnings
	that occur in that situation and are not detected by the compiler
	don't affect COMPILE-FILE's return value.

2005-08-22 04:08  gb

	* level-1/l1-reader.lisp: Disable #, which was removed from ANSI CL
	a long time ago.

2005-08-22 04:07  gb

	* level-0/PPC/ppc-numbers.lisp: #+ppc64 %NEXT-RANDOM-SEED accounts
	for el-bizarro shifting.

2005-08-22 04:05  gb

	* examples/: cocoa-listener.lisp, cocoa-window.lisp,
	objc-runtime.lisp: Use #& instead of #?, which is deprecated (the
	implementation shouldn't define #?).

2005-08-22 04:05  gb

	* lib/db-io.lisp: The #? reader macro is supposed to be reserved
	for the user.  Use #& for foreign variable lookup, and make #? an
	alias to it (for backward compatibility, for a while.)

2005-08-22 04:03  gb

	* lib/numbers.lisp: RANDOM-STATE's PRINT-OBJECT method uses ASH
	instead of CCL::%ILSR.

2005-08-21 16:57  gb

	* lisp-kernel/linux/.gdbinit: Try to parameterize more for
	ppc32/ppc64.

2005-08-21 16:57  gb

	* lib/macros.lisp: Add WITH-PROCESS-WHOSTATE, to make
	saving/restoring a process's WHOSTATE a little easier.
	
	%WITH-RECURSIVE-LOCK-PTR uses the new %LOCK-RECURSIVE-LOCK to
	better ensure that the lock is unlocked if and only if it was
	successfully locked.

2005-08-21 16:54  gb

	* level-1/version.lisp: Bump.

2005-08-21 16:54  gb

	* level-1/linux-files.lisp: %TIMED-WAIT-ON-SEMAPHORE-POINTER takes
	an optional WHOSTATE argument.

2005-08-21 16:53  gb

	* level-1/l1-readloop-lds.lisp: Try harder to keep an
	(%UNBOUND-MARKER) as the primary return value to TOPLEVEL-PRINT
	from making *, **, *** unbound.

2005-08-21 16:50  gb

	* level-1/l1-processes.lisp: PROCESS-WAIT uses
	WITH-PROCESS-WHOSTATE.

2005-08-21 16:49  gb

	* level-1/l1-lisp-threads.lisp: THREAD-HANDLE-INTERRUPTS resets the
	process-whostate to "Active", using the new WITH-PROCESS-WHOSTATE
	macro.

2005-08-21 16:48  gb

	* level-0/l0-misc.lisp: Try to ensure that things that change the
	state of a recursive lock do so atomically, make
	%LOCK-RECURSIVE-LOCK take an extra CONS (optional for
	bootstrapping), which can be used to reliably indicate success.
	
	Add a %%LOCK-OWNER function for debugging.
	
	Note that there are some related changes in higher-level code;
	while bootstrapping, build ppc-boot and a new image before
	recompiling the higher-level parts of this.

2005-08-21 02:28  gb

	* lib/sparcenv.lisp: no SPARC

2005-08-20 21:07  gb

	* level-1/version.lisp: 050820b.  New binaries soon.

2005-08-20 20:47  gb

	* compiler/: backend.lisp, nx0.lisp, nxenv.lisp, risc-lap.lisp,
	PPC/ppc-lap.lisp, PPC/ppc2.lisp: Several changes to enable larger
	functions/code-vectors and to allow more labels in LAP and the
	compiler.
	
	Some of this is tricky to bootstrap; new binaries soon.

2005-08-20 19:54  bryan

	* level-0/l0-array.lisp: 
	fill-pointer: when throwing a type-error, set expected-type to
	'(and array (satisfies array-has-fill-pointer-p)).

2005-08-20 15:30  bryan

	* compiler/PPC/ppc-lap.lisp: 
	use "CCL" instead of :ccl in in-package form.

2005-08-20 15:27  bryan

	* xdump/hashenv.lisp, compiler/lambda-list.lisp,
	compiler/nx-base-app.lisp, compiler/nx.lisp, compiler/nx0.lisp,
	compiler/nxenv.lisp, compiler/optimizers.lisp: 
	add (in-package "CCL") forms.

2005-08-20 15:08  bryan

	* level-1/version.lisp: 
	bump.

2005-08-20 15:05  bryan

	* lib/pprint.lisp: 
	remove all reader-conditionalized code for non-openmcl platforms.

2005-08-20 14:06  bryan

	* library/loop.lisp: 
	remove all reader-conditionalized code for non-openmcl platforms.

2005-08-20 13:38  bryan

	* level-1/: l1-aprims.lisp, l1-boot-1.lisp, l1-boot-2.lisp,
	l1-boot-3.lisp, l1-boot-lds.lisp, l1-callbacks.lisp,
	l1-cl-package.lisp, l1-clos-boot.lisp, l1-clos.lisp, l1-dcode.lisp,
	l1-error-signal.lisp, l1-events.lisp, l1-files.lisp,
	l1-format.lisp, l1-init.lisp, l1-io.lisp, l1-numbers.lisp,
	l1-pathnames.lisp, l1-reader.lisp, l1-sort.lisp, l1-streams.lisp,
	l1-symhash.lisp, l1-sysio.lisp, l1-typesys.lisp, l1-utils.lisp,
	level-1.lisp, linux-files.lisp, ppc-callback-support.lisp,
	ppc-threads-utils.lisp, ppc-trap-support.lisp, runtime.lisp,
	sysutils.lisp, version.lisp: 
	add (in-package "CCL") forms.

2005-08-20 13:26  bryan

	* lib/: apropos.lisp, arglist.lisp, arrays-fry.lisp,
	backtrace-lds.lisp, backtrace.lisp, case-error.lisp,
	ccl-export-syms.lisp, chars.lisp, compile-ccl.lisp, db-io.lisp,
	defstruct-lds.lisp, defstruct-macros.lisp, defstruct.lisp,
	distrib-inits.lisp, dumplisp.lisp, edit-callers.lisp,
	encapsulate.lisp, format.lisp, hash.lisp, level-2.lisp,
	macros.lisp, mcl-compat.lisp, method-combination.lisp, misc.lisp,
	nfcomp.lisp, number-case-macro.lisp, number-macros.lisp,
	numbers.lisp, pathnames.lisp, ppc-init-ccl.lisp, ppcenv.lisp,
	pprint.lisp, prepare-mcl-environment.lisp, print-db.lisp,
	sequences.lisp, setf-runtime.lisp, setf.lisp, sort.lisp,
	source-files.lisp, sparcenv.lisp, streams.lisp, systems.lisp,
	time.lisp: 
	add (in-package "CCL") forms.

2005-08-20 13:08  bryan

	* library/: darwin-syscalls.lisp, linux-syscalls.lisp,
	lisp-package.lisp, lispequ.lisp, mac-file-io.lisp,
	macptr-termination.lisp, parse-ffi.lisp, pty.lisp: 
	add (in-package "CCL") forms.

2005-08-20 12:51  bryan

	* library/: extended-loop.lisp, mit-loop.lisp: 
	no longer required.  all loop code is in loop.lisp.

2005-08-20 01:08  bryan

	* level-1/version.lisp: bump.

2005-08-20 01:06  bryan

	* level-1/l1-reader.lisp: 
	read-list: make sure the first form read isn't a dot.

2005-08-19 19:17  bryan

	* level-1/version.lisp: bump.
	
	we now pass all PRINT*, PPRINT*, and FORMAT* ansi tests.

2005-08-19 19:14  bryan

	* level-1/l1-io.lisp: 
	array-readably-printable-p: new function.  T if array can be
	readably printed.
	
	write-an-array: if *print-readably*, make sure that the array is
	readably-printable.

2005-08-19 16:24  bryan

	* lib/numbers.lisp: 
	print-object (random-state t): cl:random-state was renamed to
	ccl::initialize-random-state.

2005-08-19 15:44  bryan

	* level-1/l1-io.lisp: 
	write-pname: if *print-readably*, use the readtable-case of the
	"standard readtable".
	
	write-pname: if symbol could be read as a number, don't bother
	slashify-ing.  just write it escaped in |..|.

2005-08-18 01:14  bryan

	* level-1/version.lisp: bump.

2005-08-18 01:13  bryan

	* lib/pprint.lisp: 
	specifier-fn: convert to cond.
	
	convert-body: don't call copy-tree.
	
	copy-tree breaks pprint dispatch table entries with eql type
	specifiers.  for example this form:   (let ((obj '(foo bar)))	 
	(set-pprint-dispatch (list* 'eql (list obj)) ...))

2005-08-16 13:45  bryan

	* lib/setf.lisp: 
	remf: according to 5.1.3, the indicator needs to be evaluated
	before the reading the "old value" of place.

2005-08-16 11:16  gb

	* level-1/version.lisp: bump.

2005-08-16 11:13  gb

	* compiler/: nx0.lisp, nxenv.lisp: Use (expt 4 n) instead of (ash 4
	n), which isn't the same thing ...

2005-08-16 11:11  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: ALLOC-C-FRAME: ensure
	32-byte alignment on PPC64.

2005-08-16 07:35  gb

	* lisp-kernel/spentry.s: Remove gratuitous "ldr
	r2,tcr.native_thread_info(rcontext)" from _SPeabi_callback epilog:
	on linuxppc32 (the only platform that uses _SPeabi_callback), we
	should be keeping our hands off of r2 at all times, anyway.

2005-08-16 07:18  gb

	* level-1/ppc-trap-support.lisp: In xcmain callback (both of them),
	get rid of code which gratuitously smacks a 0 into the top word of
	the value stack in the current catch frame in response to an
	interrupt trap (trgti nargs, 0).  (I -think- that this had
	something to do with reenabling interrupts in a long-forgotten
	cooperative scheduler.)
	
	It's possible that until recent changes to register allocation, the
	top word on the vstack at this point was either (a) always
	non-negative and therefore immune to getting smacked around or (b)
	something not very important.
	
	On Linux32, this was currently a pointer to a saved special
	binding, (happened to look negative because of where that stack was
	allocated) and setting it to 0 caused a crash as the binding stack
	was unwound.

2005-08-16 07:10  gb

	* level-1/l1-boot-lds.lisp: In STARTUP-CCL, use LOAD-FILE
	(establishing a restart) instead of just calling LOAD directly when
	processing a --load command-line option.

2005-08-15 20:01  bryan

	* level-1/version.lisp: 
	bump.

2005-08-15 19:59  bryan

	* lib/macros.lisp: 
	defclass: prefer MOP over ANSI behaivor.  class options are
	canonicalized and passed to ensure-class.

2005-08-15 19:15  bryan

	* level-1/version.lisp: 
	bump.

2005-08-15 19:09  bryan

	* lib/macros.lisp: 
	defclass: add new case for locally implemented class options
	(currently only 'primary-p).  throw program-error if not one of the
	ansi or locally implemented class options.
	
	this means that all future local class options will need to be
	added to the defclass macro.

2005-08-15 18:29  bryan

	* lib/level-2.lisp: 
	%destructure-lambda-lisp: don't quote the default-initial-value
	when &key is in list form.  the supplied default needs to be
	evaluated.

2005-08-15 18:14  bryan

	* lib/level-2.lisp: 
	%destructure-lambda-lisp: make sure default-initial-value is
	properly quoted in getf form.

2005-08-15 17:40  bryan

	* lib/macros.lisp: 
	defclass: revert previous commit.

2005-08-15 14:00  bryan

	* lib/macros.lisp: 
	defclass: signal a program-error if invalid class option seen.

2005-08-15 13:00  gb

	* compiler/PPC/ppc2.lisp: Reformat a comment; one down, a few
	thousand more to go ...

2005-08-15 12:58  gb

	* lisp-kernel/: darwin/Makefile, darwin64/Makefile: Enable -O2, at
	least until the next time something needs to be debugged.

2005-08-15 12:58  gb

	* lisp-kernel/spentry.s: Write barrier things check to see if bit
	is set before entering the (expensive) interlocked load/store loop.
	 (Old objects that're destructively modified are often modified
	multiple times.)

2005-08-15 12:55  gb

	* level-0/l0-symbol.lisp: Bum %PL-SEARCH a little.

2005-08-15 12:54  gb

	* compiler/: nx0.lisp, nx1.lisp, nxenv.lisp, optimizers.lisp:
	(very) approximate loop-weighting for VAR refrences.  Bad, but
	seems to win more often than it loses.

2005-08-15 06:38  gb

	* library/chud-metering.lisp: Fix typo in version check.

2005-08-13 17:25  gb

	* lib/source-files.lisp: CCL::EDIT-DEFINITION-P didn't know that
	all of a method's specializers were specializers, so it sometimes
	called CLASS-NAME on an EQL-SPECIALIZER.
	
	SLIME calls CCL::EDIT-DEFINITION-P, but I'm not really sure that
	that's a good idea.

2005-08-13 14:09  bryan

	* level-1/l1-files.lisp: 
	%load: allow loading from string-input-streams.  load-from-stream
	already supported it, but the path to get there was littered with
	file-stream traps.

2005-08-13 12:05  bryan

	* level-1/l1-error-system.lisp: 
	file-error: set initform of "<unspecified>" for pathname.

2005-08-13 10:38  bryan

	* lib/pprint.lisp: 
	pprint-indent: truncate the arg here instead of later in
	set-indentation-prefix.

2005-08-13 09:53  gb

	* library/chud-metering.lisp: Check that we've got at least CHUD
	4.1.
	
	A version of CHUD 4.2.x gets installed via XCode 2.1; that version
	doesn't seem to be usable.
	
	Versions of CHUD 4.2.x that're distributed on Apple's Performance
	Tools site seem to work better.

2005-08-13 09:51  gb

	* level-1/l1-dcode.lisp: Define and use DCODE-TOO-FEW-ARGS.
	
	%%NTH-ARG-DCODE was checking the argument count incorrectly; this
	could have something random to have been used (in the &lexpr case)
	in dispatching.
	
	Note that this detects -some- cases of missing args to a GF, but
	generic functions that use %%NTH-ARG-DCODE (at least) don't do
	rigorous number-of- arg checking on entry; cases like:
	
	(add-method 6)
	
	still generate a NO-APPLICABLE-METHOD without noticing that an
	argument's missing.
	
	(-maybe- partly fixable in the short term).

2005-08-13 09:44  gb

	* level-1/l1-error-system.lisp: Make the REPORT method for
	wrong-number-of-arguments errors mention the function (which isn't
	always the same as what's reported as "while executing ...".)

2005-08-13 09:43  gb

	* level-1/l1-clos-boot.lisp: Defvar *SIMPLE-ARRAY-CLASS* (not a
	toplevel form, so the compiler may warn the fist time this is
	compiled.)  CLASS-OF returns that class for simple multidimensional
	arrays (but see CLHS.)

2005-08-13 01:10  bryan

	* level-1/l1-io.lisp: 
	write-a-structure: change *print-length* handling.

2005-08-12 22:49  bryan

	* level-1/l1-io.lisp: 
	print-object, write-a-structure: structures with no slots are
	considered to have no components, so ignore *print-level*.

2005-08-12 05:16  gb

	* xdump/xfasload.lisp: Be a little more careful in
	XLOAD-SET-DOCUMENTATION; only call SET-DOCUMENTATION if the
	argument might be a string.

2005-08-12 05:14  gb

	* tools/asdf.lisp: Skip the second (more global) check for
	duplicate component names, per a suggestion from Christophe Rhodes
	on #lisp.  This may help to ensure that McCLIM builds.

2005-08-12 05:13  gb

	* lib/defstruct-macros.lisp: SD accessors use SVREF, not %SVREF. 
	(Not sure what the bug is, but this change may help to catch it
	earlier.)

2005-08-12 05:12  gb

	* level-1/version.lisp: bump.

2005-08-12 05:12  gb

	* level-0/l0-misc.lisp: %PUT-DOCUMENTATION: if "doc" is non-null,
	ensure that it's a string.

2005-08-11 21:20  gb

	* level-0/l0-array.lisp: Needed to say #. before 64-bit vector type
	names in %UVECTOR-REPLACE.

2005-08-11 09:12  gb

	* level-0/l0-array.lisp: handle single-float case in
	%UVECTOR-REPLACE.

2005-08-11 06:54  gb

	* darwin-headers/chud/C/populate.sh: Update for CHUD 4.1.x.

2005-08-11 06:54  gb

	* compiler/optimizers.lisp: Do 3-arg char, numeric comparisons at
	least partly inline.

2005-08-11 06:53  gb

	* compiler/PPC/ppc2.lisp: Don't do SOME/EVERY when evaluating VINSN
	predicates.

2005-08-11 06:52  gb

	* library/chud-metering.lisp: New file.  Needs some work, but
	somewhat useful.

2005-08-09 12:18  bryan

	* level-1/version.lisp: bump after fix for ~F bug.

2005-08-09 12:15  bryan

	* lib/format.lisp: 
	revert part of changes made in v1.14.
	
	format-fixed-aux: don't forget to write #\0 after decimal point and
	significant digits.

2005-08-09 05:59  gb

	* level-1/l1-sockets.lisp: Use (record-length :linger) instead of 8
	when setting the #$SO_LINGER socket option.

2005-08-09 05:27  gb

	* level-0/l0-cfm-support.lisp: On (32-and-64-bit) Linux, link_map
	entries (used to find shared libraries) may have their
	:link_map.l_addr fields set to NULL; this caused
	INIT-SHARED-LIBRARIES to think that all libraries were mapped to
	the same address (0).
	
	In %SHLIB-FROM-MAP-ENTRY, use #_dladdr to find the library base
	address that contains the library's dynamic section if the
	link_map.l_addr field is NULL.

2005-08-08 20:44  bryan

	* level-1/l1-io.lisp: 
	write-a-symbol: add #: to "apparently uninterned" symbols which are
	those having a home package of nil.

2005-08-08 18:01  bryan

	* level-1/l1-numbers.lisp: 
	new-numtoken: if token is a float, ignore *read-base* and read it
	in base 10.

2005-08-08 17:04  gb

	* examples/objc-support.lisp: Don't assume that the CTR gets saved
	in a jmp_buf (it appears not to be under Tiger, which causes the
	whole %associate-jmp-buf-with-catch-frame hack to fail.) Instead,
	set r14 in the jmp_buf to THROW-TO-CATCH-FRAME's address, and add
	an extra instruction to *SETJMP-CATCH-LR-CODE* to copy r14 to the
	CTR.

2005-08-08 05:45  gb

	* lisp-kernel/linux/.gdbinit: Ignore SIG40.

2005-08-08 05:45  gb

	* lisp-kernel/thread_manager.c: Linux thread stack size stuff wants
	parameters to be of natural word size.

2005-08-08 05:44  gb

	* lib/macros.lisp: Conditionalize on EABI/POWEROPEN ABI, not
	Linux/Darwin in DEFINE-CALLBACK, too.

2005-08-08 05:44  gb

	* lib/db-io.lisp: Conditionalize on EABI/POWEROPEN ABI, not
	Linux/Darwin.

2005-08-08 05:43  gb

	* level-1/ppc-trap-support.lisp: Fix a few LinuxPPC64 constants.
	Can do callbacks now, but may still be bugs.

2005-08-08 05:42  gb

	* level-1/ppc-callback-support.lisp: Fix type: #+LINUX-PPC-TARGET,
	not #+LINUX.

2005-08-08 05:42  gb

	* level-0/PPC/ppc-float.lisp: %GET-FP-ARG-REGS is
	#+POWEROPEN-TARGET, not #+DARWINPPC-TARGET.
	
	Add a %LOAD-FP-ARG-REGS, for runtim %FF-CALL implementation.

2005-08-08 05:40  gb

	* level-0/PPC/ppc-array.lisp: Handle part of the hard case in
	32-bit %EXTEND-VECTOR.	I think that this was causing a 32-bit
	VECTOR-PUSH-EXTEND test to fail, but VECTOR-PUSH-EXTEND can't
	always use %EXTEND-VECTOR, anyway.

2005-08-08 05:39  gb

	* level-0/l0-init.lisp: Add :POWEROPEN-TARGET to *FEATURES* if it
	was there at compile-time (e.g., if it was on
	BACKEND-TARGET-SPECIFIC-FEATURES of the target backend.)

2005-08-08 05:37  gb

	* level-0/l0-array.lisp: Define %UVECTOR-REPLACE, intended to
	handle REPLACE when both args are vectors of the same element type.
	
	Fix a few fenceposts/bugs in VECTOR-PUSH-EXTEND: if old vector size
	is 0, ensure that new vector size is non-zero (4, arbitrarily.) 
	When explicitly displaced, we may not be displaced to the entire
	vector, so using %EXTEND-VECTOR to do the copying can't work (use
	%UVECTOR-REPLACE instead.)  After extending, the vector is no
	longer explicitly displaced, so clear the bit that claims that it
	is.

2005-08-08 00:43  bryan

	* lib/pprint.lisp: 
	set-indentation-prefix: truncate new-position since fractional ems
	aren't currently supported.

2005-08-07 23:23  bryan

	* level-1/l1-io.lisp: 
	(print-object standard-object ..): add *print-level* check.

2005-08-07 17:29  bryan

	* level-1/l1-io.lisp: 
	write-perverted-string: the :capitalize case (har har) requires
	slightly different behavior if the readtable case is :downcase.

2005-08-07 11:29  gb

	* lisp-kernel/spentry.s: Say "r11" instead of just "11", since
	doing otherwise would lead to harder stuff.

2005-08-07 11:27  gb

	* lisp-kernel/m4macros.m4: Define rTOC when defining other platform
	dependencies.

2005-08-07 11:27  gb

	* lisp-kernel/constants64.s: "conditional" definition of rTOC
	didn't work; do it another way, elsewhere.

2005-08-07 11:26  gb

	* level-1/l1-sockets.lisp: Honestly intend to read the #+/#-
	section one of these days.

2005-08-07 11:25  gb

	* level-0/PPC/ppc-def.lisp: Fix reference to old subprim names.

2005-08-07 10:58  gb

	* lisp-kernel/linux/.gdbinit: Start to provide 64/32-bit versions
	of things; more work needs to be done here.

2005-08-07 10:57  gb

	* lisp-kernel/spentry.s: Subprim renaming, to better reflect
	EABI/PowerOpen-ness.
	
	Deal with the TOC if it exists.

2005-08-07 10:56  gb

	* lisp-kernel/spjump.s: Subprim renaming, to better reflect
	EABI/PowerOpen-ness.

2005-08-07 10:56  gb

	* lisp-kernel/subprims.s: Reload the TOC into rTOC when exiting
	from start_lisp on platforms that use a TOC (LinuxPPC64).

2005-08-07 10:54  gb

	* lisp-kernel/pmcl-kernel.c: Need to specify PROT_EXEC; PPC64 MMUs
	can apparently enforce execute protection, and Linux pays attention
	to the PROT_EXEC bit in mmap/ mprotect calls.

2005-08-07 10:53  gb

	* lisp-kernel/lisp-exceptions.h: Try to get LinuxPPC64 exception
	frame accessors right.	(Floating-point may still be bogus.)

2005-08-07 10:52  gb

	* lib/format.lisp: Y-OR-N-P, YES-OR-NO-P: try to ensure that output
	side of *DEBUG-IO* realizes that a #\NewLine has been read.   Don't
	beep in irritation; do beep in YES-OR-NO-P, 'cause we're supposed
	to.  (Hey, don't blame me if Emacs doesn't beep when it sees a ^G.)

2005-08-07 10:49  gb

	* level-1/version.lisp: Bump.

2005-08-07 10:49  gb

	* level-1/ppc-callback-support.lisp: Callback trampolines for
	LinuxPPC64 are two (64-bit) word "transfer vectors".

2005-08-07 10:48  gb

	* level-1/l1-streams.lisp: Impement a STREAM-READ-LINE for
	TWO-WAY-ECHOING-STREAM: after a line has been read (along with the
	terminating #\NewLine), output side should be at column 0.

2005-08-07 10:47  gb

	* level-1/l1-lisp-threads.lisp: Use 64-bit memory accessors for
	some TCR slots ("os" thread ID, "native" thread ID, etc.)

2005-08-07 10:45  gb

	* level-1/l1-io.lisp: WRITE-A-CONS: use WRITE-INTERNAL for both CAR
	and CDR, to ensure bogusity checks.

2005-08-07 10:44  gb

	* level-0/PPC/ppc-def.lisp: Don't claim to implement %FF-CALL for
	LinuxPPC64 (yet.).

2005-08-07 10:43  gb

	* level-0/l0-cfm-support.lisp: Reference 64-bit ELF structure
	fields if on a 64-bit platform.

2005-08-07 10:42  gb

	* compiler/PPC/PPC64/ppc64-backend.lisp: LinuxPPC64 has
	:poweropen-target (not :eabi-target) on its
	backend-target-specific-features.

2005-08-07 10:41  gb

	* compiler/: subprims.lisp, PPC/ppc2.lisp,
	PPC/PPC32/ppc32-vinsns.lisp, PPC/PPC64/ppc64-vinsns.lisp:
	Gratuitously rename subprimitives and vinns dealing with
	foreign-function calls, system calls, and callback to reflect
	whether they're oriented towards the (Linux 32 bit) EABI or some
	flavor of the PowerOpen ABI (derived from AIX).

2005-08-07 00:39  bryan

	* level-1/l1-aprims.lisp: 
	get-properties: use '(satisfies proper-list-p) instead of
	'(satisfies plistp).  plistp will throw a type-error if not a
	proper list.
	
	all occurrences of plistp (there aren't many) should probably use
	proper-list-p instead.

2005-08-06 23:06  bryan

	* lib/macros.lisp: 
	with-output-to-string: element-type needs to be evaluated
	regardless of use.  pull it into the let and defer which function
	to call to make the output stream until runtime.

2005-08-06 22:02  bryan

	* lib/macros.lisp: 
	expand-package-iteration-macro: pull pkg-spec into the surrounding
	let* in case its evaluation has an interesting side effect.

2005-08-06 20:14  bryan

	* level-1/l1-io.lisp: princ shouldn't rebind *print-circle*.  ~A
	format directive was calling princ which in turn was rebinding
	*print-circle*.

2005-08-06 13:10  bryan

	* lib/pprint.lisp: if *pretty-print*, (funcall (formatter ...) ...)
	wouldn't return the unused args to the caller. 
	maybe-initiate-xp-printing and xp-print were the culprits.

2005-08-06 11:01  bryan

	* level-1/l1-reader.lisp: #\Backspace and #\Rubout should have
	invalid constituent traits.

2005-08-06 00:54  bryan

	* lib/sequences.lisp: if coerce fails when dealing with vectors,
	signal a type-error with an expected-type of '(vector ,element-type
	,length) instead of '(vector ,length).

2005-08-05 22:23  bryan

	* level-1/l1-reader.lisp: correct a comment that said
	%collect-xtoken returns 3 values.. it actually returns 4.

2005-08-05 17:24  gb

	* lisp-kernel/area.h: Use the same IMAGE_BASE_ADDRESS on LinuxPPC64
	as on DarwinPPC64.

2005-08-05 17:24  gb

	* lisp-kernel/subprims.s: Replace a few tests for DARWIN with tests
	for POWEROPENABI.

2005-08-05 17:23  gb

	* lisp-kernel/m4macros.m4: LinuxPPC64 uses (yet another variant of)
	the PowerOpen ABI, so define POWEROPENABI (and not EABI) when LINUX
	and PPC64 are both defined.
	
	(Lots of assembler source uses e.g. __ifdef([DARWIN]) when it's
	really just concerned about the type of foreign stack frame to
	create; this needs to be carefully reviewed.)

2005-08-05 17:21  gb

	* lisp-kernel/constants64.s: r2 is rTOC when in C code on
	LinuxPPC64.  (it'd always be the same value for all threads, so we
	can keep it in a global.)
	
	(Could assume that LinuxPPC64 implies TLS-based libc, and make the
	TCR be a __thread variable.)

2005-08-05 17:18  gb

	* lisp-kernel/linux64/Makefile: Dont' pass in lisp version stuff
	anymore.
	
	Disable -O2, to make debugging easier.

2005-08-05 17:17  gb

	* lisp-kernel/linux64/elf64ppc.x: Change the subrpims jump table
	origin to #x5000 by moving the image base to #x4000.

2005-08-05 17:16  gb

	* level-1/ppc-trap-support.lisp: Don't error out, but the
	LinuxPPC64 execption frame stuff is likely to be very different
	from its 32-bit counterpart.

2005-08-05 17:15  gb

	* level-1/l1-sockets.lisp: Conditionalize socketcalls for #+(and
	linuxppc-target ppc64-target).	May need to also conditionalizer
	their callers in some cases.

2005-08-05 17:14  gb

	* headers64/libc/C/populate.sh: Process ifaddrs.h

2005-08-05 17:14  gb

	* binppc/.cvsignore, l1-pfsls/.cvsignore: Ignore *.p64fsl

2005-08-05 17:14  gb

	* .cvsignore: Ignore ppc-boot*

2005-08-05 17:00  bryan

	* level-1/l1-io.lisp: fix a *print-length* corner case -- printing
	(A B . C) at *print-length* 2 should print as (A B . C) and not (A
	B . ...)

2005-08-05 16:01  bryan

	* level-1/l1-io.lisp: write-an-array: no need for "..." when
	printing bit-vectors at any length.

2005-08-05 13:23  bryan

	* lib/pprint.lisp: 
	copy-pprint-dispatch: check arg, if specified, is either a
	pprint-dispatch-table or nil.

2005-08-05 12:49  bryan

	* lib/macros.lisp: 
	pprint-logical-block:	- error if both :prefix and
	:per-line-prefix specified.    - typecheck :prefix,
	:per-line-prefix, and :suffix as 'string.

2005-08-05 01:11  bryan

	* lib/pprint.lisp: 
	pprint-newline: check type of arg all the time, not just when
	pretty printing.  if not '(member :linear :miser :fill :mandatory),
	signal a type-error.

2005-08-05 00:53  gb

	* lib/macros.lisp: %GET-SINGLE-FLOAT-FROM-DOUBLE-PTR has to cons up
	a SINGLE-FLOAT object on PPC32.

2005-08-05 00:52  gb

	* level-1/l1-callbacks.lisp: (%CALLBACK-FUNCTION pointer) looks up
	and returns the function on the lisp side of the callback whose
	foreign side is "pointer".

2005-08-05 00:31  bryan

	* lib/format.lisp: 
	format-logical-block: if colon modifier, prefix and suffix default
	to open and close parentheses instead of null string.

2005-08-04 22:56  bryan

	* lib/format.lisp: last one for 22.3.5.2 compliance?
	
	logical-block directives not allowed inside justification
	directives.

2005-08-04 21:57  bryan

	* lib/format.lisp: more 22.3.5.2 cleanup..
	
	logical-block directives can not co-exist with ~<..~:;..~>.

2005-08-04 20:39  bryan

	* lib/: format.lisp, pprint.lisp: move *logical-block-p* defvar
	from format.lisp to pprint.lisp since it gets built first.

2005-08-04 18:53  bryan

	* lib/format.lisp: 
	format-justification: ignore minpad when there is only one segment.
	
	format-justification: algorithm for determining width is different
	than the one used for ~A, ~S.
	
	format-justification-round-columns: new function.

2005-08-04 15:12  bryan

	* level-1/l1-format.lisp, lib/format.lisp: ansi section 22.3.5.2
	cleanup -
	
	format-find-command: ~:T is not allowed within justification format
	directives.
	
	pprint directives (~I, ~W, ~_, ~:T) are not allowed to coexist in
	the same format control string as a justification directive
	(~<...~>) that uses ~:;.
	
	*format-pprint* will be T whenever a pprint directive has been
	seen.
	
	*format-justification-semi* will be T whenever a ~<..~:;..~> has
	been seen.

2005-08-04 05:24  gb

	* level-1/version.lisp: Bump again (mostly so that the date matches
	binaries.)

2005-08-04 05:23  gb

	* level-1/l1-clos.lisp: Make sure that (SETF GENERIC-FUNCTION-NAME)
	is implemented, and that it calls REINITIALIZE-INSTANCE to change
	the slot's value.  (This was caught by Pascal Costanza's
	mop-features tests.)

2005-08-04 02:35  bryan

	* level-1/version.lisp: bump.

2005-08-04 02:31  bryan

	* lib/: format.lisp, macros.lisp, pprint.lisp: changes to recognize
	a "pretty printing stream" and act accordingly.
	
	a pretty printing stream is created with pprint-logical-block or
	the ~<...~:> format directive.
	
	*logical-block-p* will be T if we are inside a logical block.
	
	pprint-logical-block, format-logical-block: set *logical-block-p*
	to T.
	
	~_ (conditional newline), pprint-newline, pprint-indent+,
	pprint-tab: do nothing if not *print-pretty* or not a pretty
	printing stream.
	
	pprint-tab+; do nothing only if ~:T and not *print-pretty* or not a
	pretty printing stream.
	
	~T format parameter only behaves like pprint-tab when ~:T.  change
	~T handler to skip pprint-tab and call straight to pprint-tab+.
	
	notes --
	
	to test for a pretty printing stream, it's not enough to just check
	whether we have an xp-stream or xp-structure.  the other existing
	symbols like *current-level* or *logical-block-xp* were not
	consistently non-nil with a pretty printing stream.
	
	changes to pprint-xxx+ functions affect both the cl symbol
	pprint-xxx and its corresponding format handler.
	
	pprint-newline+ had to be left alone since it is used by other code
	that handles justification.  instead i pulled changes out a level
	to pprint-newline and the ~_ handler.

2005-08-03 04:10  gb

	* level-1/l1-error-system.lisp: SIMPLE-STREAM-ERROR's :report
	method prints the result of applying FORMAT to the control string
	and arguments, rather than just printing the control string.

2005-08-03 03:05  gb

	* examples/cocoa-editor.lisp: Try to get "revert" working ...

2005-08-03 03:04  gb

	* examples/bridge.lisp: Force all things that need to have the
	class in an OBJC-METHOD-INFO structure to go through the function
	GET-OBJC-METHOD-INFO-CLASS to do so; make sure that that function
	handles metaclasses correctly (the failure to do so was causing
	(SEND x 'name) to fail.)
	
	Remove redundant subclasses when generating CASE/COND forms for
	SEND; prefer COND to use of union types.

2005-08-03 01:39  bryan

	* level-1/version.lisp: bump.

2005-08-03 01:36  bryan

	* lib/format.lisp: format-fix-aux: skip leading or trailing 0 when
	number (and sign if @F) would fit the specified width perfectly.

2005-08-02 20:40  bryan

	* lib/pprint.lisp: pprint-tab: only do something if *print-pretty*
	and we have a pretty printing stream.

2005-08-02 19:21  bryan

	* level-1/l1-reader.lisp: set-syntax-from-char: certain characters
	become invalid if from-char is a constituent.  see 2.1.4.2 and
	figure 2.8.
	
	if one of those illegal characters tries to act as a constituent
	character, signal a reader-error.

2005-08-02 14:40  bryan

	* level-1/l1-reader.lisp: read-dispatch: signal a reader-error
	instead of just calling it a reader-error in the error message.

2005-08-02 13:59  bryan

	* level-1/l1-clos-boot.lisp: find-method: canonicalize specializers
	before comparison.

2005-08-02 12:14  bryan

	* level-1/sysutils.lisp: (setf macro-function): since the spec
	explicitly notes that a symbol with a previous function definition
	will be overwritten, change the cerror to a warn.
	
	like *ignore-extra-close-parenthesis*, there should probably be
	some variables that let users change clobbering behavior.

2005-08-02 07:47  gb

	* examples/objc-runtime.lisp: Fencepost in CFSTR binary search.

2005-08-02 07:47  gb

	* hemlock/src/lispmode.lisp: Don't do MODIFYING-BUFFER around
	indentation (was an attempt to defer redisplay.)

2005-08-02 07:46  gb

	* hemlock/src/command.lisp: The "Next Line" command doesn't insert
	newlines at the end of the buffer by default; there's a global
	Hemlock variable that controls this behavior.

2005-08-02 01:53  bryan

	* level-1/l1-streams.lisp: file-length: switch to typecase and
	explicitly throw the type-error so we can specify the expected-type
	as file-stream.

2005-08-01 22:33  bryan

	* level-1/l1-reader.lisp: readtable-case, setf (readtable-case):
	arg must be a readtable.

2005-08-01 21:33  bryan

	* level-1/l1-aprims.lisp: check-sequence-bounds: report-bad-arg if
	(< end 0).  the (> start end) clause would catch this, but we want
	to report end not start in the error message.

2005-08-01 20:53  bryan

	* level-1/l1-error-system.lisp: make-condition: arg is a
	type-specifier, so allow both things like 'arithmetic-error and
	(find-class 'arithmetic-error).

2005-08-01 20:35  gb

	* level-1/version.lisp: bump.

2005-08-01 17:14  gb

	* level-1/l1-boot-2.lisp: When setting up standard fd-streams,
	recognize that FD-OPEN returns a negative (non-NULL) value on
	failure.

2005-08-01 14:01  bryan

	* level-1/l1-typesys.lisp: ctype-of-number: consider the type of
	imagpart of complex numbers when determining type.
	
	? (type-of #c(1 1/2)) (COMPLEX (RATIONAL 1/2 1))  ; not (COMPLEX
	(INTEGER 1/2 1))

2005-08-01 04:55  gb

	* hemlock/src/searchcoms.lisp: Allow redisplay when getting key
	events during search commands.

2005-08-01 04:54  gb

	* hemlock/src/package.lisp: Don't export CHECK-REGION-QUERY-SIZE.

2005-08-01 04:52  gb

	* hemlock/src/bindings.lisp: Try to ensure that Meta-Space runs
	"Just One Space".

2005-08-01 04:52  gb

	* hemlock/src/buffer.lisp: First stab at balancing
	BEGIN/END-EDITING operations around recursive edits.  May still be
	wrong.

2005-08-01 04:50  gb

	* hemlock/src/fill.lisp: Don't call CHECK-REGION-QUERY-SIZE.

2005-08-01 04:50  gb

	* hemlock/src/interp.lisp: Wrap BEGIN-EDITING/END-EDITING around
	command processing.
	
	The good news is that this suppresses display after every buffer
	modification.
	
	The bad news is that some extended/recursive commands have to do
	hairy things to allow redisplay to happen.  (The hair mostly has to
	do with closing the outer BEGIN-EDITING and re-opening it to keep
	things balanced; sometimes this needs to happen when reading
	characters from the event queue, since some types of redisplay
	happen then.)
	
	Summary: less hysterical redisplay code, but it may still be
	suppressed too much; some things that don't really modify the
	buffer may wrap a MODIFYING-BUFFER around a sequence of lower-
	level operations, and this may cause the buffer to be marked as
	modified even when nothing changes.

2005-08-01 04:44  gb

	* hemlock/src/: morecoms.lisp, lispbuf.lisp: Dont do
	CHECK-REGION-QUERY-SIZE (I think that that's actually the real name
	...).

2005-08-01 04:43  gb

	* hemlock/src/listener.lisp: Dont do CHECK-REGION-SIZE-QUERY in the
	"Filter Region" command.

2005-08-01 04:43  gb

	* hemlock/src/lispmode.lisp: Dont do CHECK-REGION-SIZE-QUERY before
	indenting a region.

2005-08-01 04:40  gb

	* examples/webkit.lisp: Has been edited with the Cocoa/Hemlock
	editor a lot; indentation differences.

2005-08-01 04:40  gb

	* examples/bridge.lisp: In BUILD-CALL (which might be currently
	unused), recognize :<BOOL> directly.

2005-08-01 04:38  gb

	* level-0/PPC/ppc-array.lisp: PPC64 %SIMPLE-BIT-BOOLE - advance by
	8 bytes (not 4) in loop.

2005-07-31 23:09  bryan

	* tools/asdf.lisp: sync latest version (1.87) from cclan.

2005-07-31 16:55  bryan

	* lib/macros.lisp: check-type: (if string string) === string

2005-07-31 16:50  bryan

	* lib/macros.lisp, level-1/l1-error-system.lisp: check-type: if
	string not specified, don't replace it with typespec in call to
	ensure-value-of-type.  ensure-value-of-type: remove init-form from
	&optional typename.

2005-07-31 16:35  bryan

	* level-1/l1-error-system.lisp: ensure-value-of-type: if typename
	is specified, create a new format string that uses it instead of
	binding it to the type-error condition's :expected-type.  the spec
	says that :expected-type must be a typespec.

2005-07-29 23:21  gb

	* lib/macros.lisp: New definition of WITH-PACKAGE-ITERATOR.

2005-07-29 23:20  gb

	* level-1/l1-symhash.lisp: New runtime support for
	WITH-PACKAGE-ITERATOR.

2005-07-29 23:20  gb

	* library/lispequ.lisp: New stuff for WITH-PACKAGE-ITERATOR.

2005-07-29 21:16  gb

	* level-1/l1-streams.lisp: PROCESS-INPUT-WAIT: don't compute tick
	count if it's not needed.  (Is it ever needed ?)

2005-07-29 19:55  gb

	* lisp-kernel/pmcl-kernel.c: In DARWIN version of
	default_image_name, use strcpy() to copy string to malloc'ed
	memory.  (strcat() only worked - had that effect - if the first
	byte of the destination was #\Nul.)

2005-07-29 19:52  gb

	* level-1/version.lisp: Start claiming to be an 0.14.4 prerelease.

2005-07-29 19:52  gb

	* level-1/l1-readloop-lds.lisp: Try to ensure that REPL functions
	use *STANDARD-INPUT* and *STANDARD-OUPUT* and/or pay attention to
	their input-stream & output-stream args (rather than doing all I/O
	to/from *TERMINAL-IO*).
	
	Don't print the listener prompt if *QUIET-FLAG* is set.  (Should
	only be set if *BATCH-FLAG* is also set, so this affects REPL and
	break loop prompts, not inspector, etc.)

2005-07-29 19:48  gb

	* level-1/l1-boot-lds.lisp: Don't print the Welcome herald if
	*quiet-flag* is set.

2005-07-29 19:47  gb

	* level-1/l1-boot-2.lisp: Declare *QUIET-FLAG*.
	
	Ensure that *STDOUT* (not necessarily *TERMINAL-OUTPUT*) gets its
	output flushed periodically.

2005-07-29 19:45  gb

	* level-1/l1-application.lisp: Add support for a -Q/--quiet
	command-line argument.

2005-07-29 03:03  gb

	* level-1/l1-utils.lisp: Define %SET-CSTRING; make it the SETF
	inverse of %GET-CSTRING.
	
	Restore %PUT-CSTRING (used by UFFI); implement it in terms of (SETF
	(%GET-CSTRING ...) ...)

2005-07-29 03:02  gb

	* lib/macros.lisp: Don't do (DEFSETF %GET-STRING %SET-STRING);
	%GET-STRING is only defined in "ccl:lib;pascal-strings.lisp", and a
	SETF function for it is defined in that file.

2005-07-28 07:48  gb

	* lib/db-io.lisp: OBJC-MESSAGE-INFO structure has "ambiguous
	methods" slot, used by bridge.

2005-07-28 07:47  gb

	* hemlock/src/: htext1.lisp, htext2.lisp, htext3.lisp, htext4.lisp,
	lispmode.lisp: Don't modify buffer if doing so would change a
	protected region.

2005-07-28 07:46  gb

	* examples/webkit.lisp: Works again (doesn't do much, but WebKit is
	pretty impressive.)
	
	Need new interfaces.

2005-07-28 07:46  gb

	* examples/bridge.lisp: Handle ambiguiuty in SEND; convert %SEND to
	use new (decl-based) scheme.  No need to parse ObjC types or
	introspect to find method/message info.

2005-07-28 07:45  gb

	* examples/process-objc-modules.lisp: Remove the commented-out call
	at the end of file; no need to update type signatures via
	introspection

2005-07-28 07:44  gb

	* examples/objc-support.lisp: No need to canonicalize class
	references in type signature table.

2005-07-28 07:43  gb

	* examples/objc-runtime.lisp: No need to declare some internal
	classes (was needed to keep %SEND happy.)
	
	No need to update old method type-signature table.

2005-07-28 07:42  gb

	* examples/objc-clos.lisp: Conditionalize out the ObjC GF
	integration stuff (until it can be adapted to the New Order.)  Note
	that we may need a way to obtain all (declared) ObjC messages - as
	well as tweak this to use the new method/message decl structures -
	to revive this.

2005-07-28 07:40  gb

	* examples/cocoa-editor.lisp: Set bold weight to 9.0 (not a factor
	of the point size).
	
	ObjC "count" message is unambiguous, so no need for type decl.

2005-07-28 07:38  gb

	* level-0/PPC/ppc-def.lisp: Make %FF-CALL stuff explicitly 32-bit
	only.  (Didn't this already happen last week ?)

2005-07-28 07:35  gb

	* darwin-headers/webkit/: C/populate.sh, .cvsignore, C/.cvsignore:
	New file.

2005-07-28 07:34  gb

	* darwin-headers/cocoa/.cvsignore: Ensure that more .cvsignore
	files exist and that files matching *~.* (e.g., Cocoa NSDocument
	backup files) are ignored.

2005-07-28 07:29  gb

	* darwin-headers64/libc/.cvsignore, level-0/PPC/PPC64/.cvsignore,
	lib/.cvsignore, library/.cvsignore, lisp-kernel/.cvsignore,
	lisp-kernel/darwin/.cvsignore, lisp-kernel/darwin64/.cvsignore,
	lisp-kernel/linux/.cvsignore, lisp-kernel/linux64/.cvsignore,
	lisp-kernel/static-linux/.cvsignore, scripts/.cvsignore,
	tools/.cvsignore, tools/asdf-install/.cvsignore,
	tools/asdf-install/doc/.cvsignore, xdump/.cvsignore: Ensure that
	more .cvsignore files exist and that files matching *~.* (e.g.,
	Cocoa NSDocument backup files) are ignored.

2005-07-28 07:23  gb

	* level-0/.cvsignore, hemlock/src/wire/.cvsignore,
	level-0/PPC/.cvsignore, level-0/PPC/PPC32/.cvsignore: Ensure that
	more .cvsignore files exist and that files matching *~.* (e.g.,
	Cocoa NSDocument backup files) are ignored.

2005-07-28 07:23  gb

	* compiler/optimizers.lisp: CCL::TRUE and CCL::FALSE.  (There are
	things that wind up calling TRUE at runtime; there's no reason to
	actually do that.)

2005-07-28 07:17  gb

	* .cvsignore, compiler/.cvsignore, compiler/PPC/.cvsignore,
	compiler/PPC/PPC32/.cvsignore, compiler/PPC/PPC64/.cvsignore,
	compiler/X86/.cvsignore, darwin-headers/.cvsignore,
	darwin-headers/carbon/.cvsignore,
	darwin-headers/carbon/C/.cvsignore, darwin-headers/chud/.cvsignore,
	darwin-headers/chud/C/.cvsignore, darwin-headers/cocoa/.cvsignore,
	darwin-headers/cocoa/C/.cvsignore, darwin-headers/gl/.cvsignore,
	darwin-headers/gl/C/.cvsignore, darwin-headers/libc/.cvsignore,
	darwin-headers/libc/C/.cvsignore,
	darwin-headers/quicktime/.cvsignore,
	darwin-headers/quicktime/C/.cvsignore, darwin-headers64/.cvsignore,
	examples/.cvsignore, examples/rubix/.cvsignore, headers/.cvsignore,
	headers/gl/.cvsignore, headers/gl/C/.cvsignore,
	headers/gnome/.cvsignore, headers/gnome/C/.cvsignore,
	headers/gnome2/.cvsignore, headers/gnome2/C/.cvsignore,
	headers/gnustep/.cvsignore, headers/gnustep/C/.cvsignore,
	headers/gtk/.cvsignore, headers/gtk/C/.cvsignore,
	headers/gtk2/.cvsignore, headers/gtk2/C/.cvsignore,
	headers/libc/.cvsignore, headers/libc/C/.cvsignore,
	headers64/.cvsignore, headers64/libc/.cvsignore,
	headers64/libc/C/.cvsignore, hemlock/.cvsignore,
	hemlock/bin/.cvsignore, hemlock/bin/openmcl/.cvsignore,
	hemlock/doc/.cvsignore, hemlock/doc/cim/.cvsignore,
	hemlock/doc/misc/.cvsignore,
	hemlock/doc/scribe-converter/.cvsignore,
	hemlock/doc/user/.cvsignore, hemlock/maint/.cvsignore,
	hemlock/resources/.cvsignore, hemlock/src/.cvsignore,
	hemlock/src/elisp/.cvsignore, hemlock/src/spell/.cvsignore,
	hemlock/src/tty/.cvsignore, hemlock/unused/.cvsignore,
	hemlock/website/.cvsignore, level-1/.cvsignore: Ensure that more
	.cvsignore files exist and that files matching *~.* (e.g., Cocoa
	NSDocument backup files) are ignored.

2005-07-23 03:38  gb

	* lib/macros.lisp: First cut at handling (lots of) FP args in
	Darwin callbacks.  (Probably needs some further testing: there are
	lots of boundary cases.)

2005-07-23 03:36  gb

	* level-0/PPC/ppc-float.lisp: %GET-FP-ARG-REGS, for Darwin
	callbacks.

2005-07-22 02:01  gb

	* examples/objc-runtime.lisp: Look for pointers in data sections
	(cfstrings) via binary search (vice linear search.)

2005-07-22 02:00  gb

	* examples/cocoa-editor.lisp: Don't bind HI::NOW-TICK per-thread.

2005-07-22 01:59  gb

	* hemlock/src/buffer.lisp: In %SET-BUFFER-MODIFIED: do
	QUEUE-BUFFER-CHANGE (e.g., update modified status in modeline)
	after status change.

2005-07-22 01:33  gb

	* lib/db-io.lisp: Remove a FORMAT (debugging) call.

2005-07-22 00:58  gb

	* level-1/version.lisp: Haven't bumped in a while.

2005-07-22 00:57  gb

	* lib/db-io.lisp: Ensure that ASCII info in trailer block is
	space-delimited.

2005-07-22 00:57  gb

	* level-0/PPC/ppc-io.lisp: %GET-ERRNO: errno value is always 32-bit
	int; pointer to errno may be 32/64 bits ...

2005-07-22 00:56  gb

	* level-1/l1-aprims.lisp: Add SETF-FUNCTION-NAME-P, use it in
	VALID-FUNCTION-NAME-P.

2005-07-22 00:52  gb

	* headers/libc/C/populate.sh: Include /usr/include/ifaddrs.h, for
	#_getifaddrs/#_freeifaddrs.

2005-07-22 00:51  gb

	* level-1/l1-sockets.lisp: Kinder, gentler %GET-IP-INTERFACES,
	based on #_getifaddrs.	 #_getifaddrs seems to be supported on
	Darwin at least as far back as Jaguar,	 and on Linux at least as
	far back as ... libc versions from 2002 or so.	 (Note that
	/usr/include/ifaddrs.h hasn't been included in the Linux interfaces
	  up until this point; note also that the interface names aren't
	returned correctly   on PPC64 Darwin as of OS release 10.4.1).

2005-07-15 18:31  gb

	* level-1/l1-aprims.lisp: Don't assume that all function names
	that're lists of 2 symbols are SETF function names in
	VALID-FUNCTION-NAME-P.	(Unless they -are- SETF function names, of
	course.)

2005-07-15 18:28  gb

	* level-0/PPC/ppc-symbol.lisp: %SVAR-BINDING-ADDRESS fixes.

2005-07-15 18:27  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp:
	PPC64::PPC64-ARRAY-TYPE-NAME-FROM-CTYPE should return a keyword or
	NIL, not ppc32::subtag-simple-vector (sic).

2005-07-15 18:27  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp:
	PPC32::PPC32-ARRAY-TYPE-NAME-FROM-CTYPE should return a keyword or
	NIL, not ppc32::subtag-simple-vector.

2005-07-15 12:29  gb

	* examples/objc-runtime.lisp: Clear the "private" class tree on
	application exit; ensure that it gets re-populated on application
	launch.

2005-07-15 06:47  gb

	* examples/rubix/rubix.lisp: Reference *CUBE*, not CUBE.  (Need to
	ask Hamilton about this, and incorporate his "ctrl-left-moust =
	right-mouse" patches.)

2005-07-15 06:45  gb

	* examples/objc-clos.lisp: Clarify that foreign direct slotds's
	"offset" is a bit offset; change the name of the slot and its
	accessor/initarg to reflect this.
	
	Foreign effective slot definitions generally treat the location as
	a byte offset (except the slot's type is a bit or bitfield.)
	
	Fix some bugs in calculating instance size of lisp-defined classes,
	which had led to general chaos/memory corruption problems.

2005-07-15 06:42  gb

	* examples/objc-runtime.lisp: Declare the class
	NSConcreteAttributedString, until SEND is converted to always use
	decl info.
	
	Recognize instances of private (i.e., undeclared) classes.
	
	When creating a foreign direct slot,  ensure that the type's bits
	have been determined; use the new :BIT-OFFSET initarg.

2005-07-15 06:38  gb

	* level-1/l1-readloop-lds.lisp: NEW-BACKTRACE-INFO records the
	(new) break level.

2005-07-15 06:38  gb

	* library/lispequ.lisp: Add a bt.break-level field to backtrace
	info.

2005-07-15 06:34  gb

	* lib/backtrace-lds.lisp: Comments.

2005-07-15 06:33  gb

	* examples/cocoa.lisp: Change some indentation; make
	UI-OBJECT-DO-OPERATION use EQL specializers on the operation name.

2005-07-15 06:32  gb

	* examples/cocoa-backtrace.lisp: Set backtrace window title to
	indicate process and its break level.

2005-07-15 06:31  gb

	* examples/bridge.lisp: SEND still punts to old SEND code
	sometimes, but formats the message differently.

2005-07-15 04:25  gb

	* level-1/ppc-trap-support.lisp: Look for an RLDICL that clears the
	left 61 (not 62) bits, preceding a (TDNEI <reg> PPC64::TAG-FIXNUM)
	trap, in XCMAIN.

2005-07-15 00:30  gb

	* examples/rubix/rubix.lisp: Hamilton's patch for the
	right-mouse-button challenged.

2005-07-14 15:11  gb

	* level-1/version.lisp: Bump.

2005-07-14 15:01  gb

	* lisp-kernel/gc.h: PPC64 VOID-ALLOCPTR is "most-positive-dnode"
	(e.g, non-negative.)

2005-07-14 15:00  gb

	* level-0/PPC/ppc-utils.lisp: In #+ppc64 walk-dynamic-area, use a
	signed alloc trap; ensure that ALLOCBASE contains the new
	(non-negative) VOID_ALLOCPTR.

2005-07-13 09:58  gb

	* lisp-kernel/: lisp-exceptions.c, lisp-exceptions.h: Only
	recognize unsigned alloc_trap on PPC32; only recognize signed
	alloc_trap on PPC64.

2005-07-13 09:57  gb

	* lisp-kernel/: darwin64/Makefile, darwin/Makefile: Don't pass
	major/minor release version to CPP.

2005-07-13 09:28  gb

	* xdump/heap-image.lisp: Write newfangled ABI-VERSION to image
	header.

2005-07-13 09:27  gb

	* lisp-kernel/image.c: Check abi version in image header;
	SAVE-APPLICATION writes current version to header.

2005-07-13 09:26  gb

	* lisp-kernel/image.h: Define min,max, current ABI version
	(arbitrarily, 1001.  I've lost count.)

2005-07-13 09:24  gb

	* lisp-kernel/linux/Makefile: Dont define version numbers in
	Makefile.

2005-07-13 08:59  gb

	* level-1/version.lisp: Bump.  Will need new binaries to bootstrap.

2005-07-13 08:58  gb

	* lib/nfcomp.lisp, xdump/faslenv.lisp: Increment FASL version.

2005-07-13 08:41  gb

	* xdump/xppcfasload.lisp: Increase heap-image-base for DarwinPPC32.

2005-07-13 08:41  gb

	* lisp-kernel/macros.s: Define platform-specific alloc_trap, use
	it.

2005-07-13 08:40  gb

	* lisp-kernel/: constants64.h, constants64.s: Redefine RATIO,
	COMPLEX subtags.

2005-07-13 08:40  gb

	* lisp-kernel/area.h: new (higher) HEAP_IMAGE_BASE for DarwinPPC32.

2005-07-13 08:38  gb

	* level-0/l0-pred.lisp: New NUMBERP/REALP for PPC64 (depends on new
	complex/ratio typecodes.) Redefine PPC64 *NODEHEADER-TYPES*.

2005-07-13 08:37  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp: Redefine PPC64::SUBTAG-RATIO
	and PPC64::SUBTAG-COMPLEX, so that a mask of all numeric typecodes
	fits (just barely) in a fixnum.  (This enables things like NUMBERP
	and REALP to check several typecodes via LOGBITP, rather than via a
	6-or-7 arm CASE statement.)
	
	This requires some bootstrapping and will require new binaries.

2005-07-13 08:33  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: Define some missing vinsns
	(some of which were found/defined by jamesjb) for 64-bit vector
	set, SINGLE-FLOAT-BITS.

2005-07-13 08:32  gb

	* compiler/PPC/ppc2.lisp: Fix some cases of PPC2-VSET involving
	64-bit arrays.

2005-07-13 08:31  gb

	* compiler/vinsn.lisp: Define MISSING-VINSNS, which found a handful
	of them.

2005-07-13 08:30  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp: Revert to using "trap
	logical" alloc-traps on PPC32.
	
	Rationale: the largest object we can allocate is about 2^27 bytes
	in size (a DOUBLE-FLOAT vector with almost 2^24 elements).  If
	HEAP-IMAGE-BASE is effectively above 2^27, we can never cause
	allocptr to change sign from positive to negative (to wrap around
	0), but we -might-  cause it to change sign from negative to
	positive (to wrap around #x80000000).
	
	On PPC64, we'd have to be able to guarantee that HEAP-IMAGE-BASE
	was above 2^59 to ensure this.	That's hard to do, so we have to
	basically limit ourselves to the low 63 bits of memory ("positive"
	addresses) and do signed comparisons. (Wrapping around 0 should
	trap; wrapping around #x8000000000000000 shouldn't be possible.)

2005-07-13 08:19  gb

	* compiler/optimizers.lisp: Comment formatting.

2005-07-13 01:17  gb

	* lisp-kernel/spentry.s: destbind1 is now a local label (there was
	some PPC32 code that thought it was still global.)

2005-07-12 22:40  gb

	* lisp-kernel/spentry.s: Inline-lambda+keyword args support for
	PPC64.	(Needs more testing, but at least the PPC64 changes are
	nominally there.)

2005-07-12 22:38  gb

	* compiler/nx1.lisp: Don't inhibit %SET-SINGLE-FLOAT on PPC64; -do-
	inhibit %SETF-SINGLE-FLOAT there.

2005-07-11 17:50  gb

	* level-1/version.lisp: Bump.

2005-07-11 17:50  gb

	* level-1/l1-streams.lisp: Chritian Nybo's change to
	%%YIELD-TERMINAL-TO (handle the case where *TERMINAL-IO* is a
	SYNONYM-STREAM.)

2005-07-11 17:48  gb

	* level-1/l1-readloop-lds.lisp: Chritian Nybo's fix to :Y command.

2005-07-11 17:48  gb

	* compiler/X86/: x86-arch.lisp, x86-asm.lisp: Gotta start
	somewhere.

2005-07-11 08:45  gb

	* compiler/risc-lap.lisp: ALLOC-LAP-OPERAND-VECTOR takes an
	optional SIZE argument, only uses freelisting if the requested size
	matches the constant LAP-OPERAND-VECTOR-SIZE.

2005-07-11 03:07  gb

	* compiler/PPC/: PPC32/ppc32-vinsns.lisp, PPC64/ppc64-vinsns.lisp:
	MEM-REF-C-S16 was generating "lha dest,src(index)" instead of "lha
	dest,index(src)".

2005-07-10 02:40  gb

	* lib/misc.lisp: Try to be saner about DOCUMENTATION methods on
	SETF function names (as reported by alanr); define methods on the
	class CONS (not LIST), and only treat the CONS as a SETF function
	name if it is one.

2005-07-10 02:38  gb

	* level-1/ppc-error-signal.lisp: Use ;;; for file-level comments. 
	(A losing battle ...)
	
	Use target::  package prefix for stack-overflow fixup kernel call.

2005-07-10 02:37  gb

	* level-1/l1-error-signal.lisp: Use ;;; for file-level comments. 
	(A losing battle ...)

2005-07-09 08:13  gb

	* lib/: defstruct-lds.lisp, defstruct.lisp: ref-type shouldn't
	contain ppc32 subtag.

2005-07-09 08:11  gb

	* level-1/version.lisp: Bump.

2005-07-09 08:11  gb

	* level-1/l1-sockets.lisp: Check for 8-bit element type on ppc64,
	too.

2005-07-09 08:10  gb

	* level-1/l1-io.lisp: target:: package prefix.	Don't print
	block/go tags, 'cause we don't use them anymore.

2005-07-09 08:09  gb

	* level-1/l1-application.lisp, lib/arrays-fry.lisp,
	lib/backtrace.lisp: target:: package prefix.

2005-07-09 08:09  gb

	* compiler/PPC/ppc-asm.lisp: Change package in buffer attribute
	line.
	
	Always require PPC-ARCH.

2005-07-08 04:58  gb

	* lisp-kernel/pmcl-kernel.c: exit if initial mmap fails

2005-07-06 12:09  gb

	* level-1/version.lisp: Bump again, since I botched the checking
	comment the last time ...

2005-07-06 12:09  gb

	* lib/nfcomp.lisp: Move the #+pppc64-target 64-bit arrays later in
	the typecase (some other things - like FUNCTION - are probably more
	common.)

2005-07-06 11:59  gb

	* level-1/: version.lisp, linux-files.lisp: Fix a few word-size
	assumptions in CALL-WITH-STRING-VECTOR; do pipe via libc on Darwin
	(since the syscall interface is pretty bizarre.)

2005-07-06 11:58  gb

	* level-0/PPC/ppc-hash.lisp: Do STRIP-TAG-TO-FIXNUM in LAP (since
	I'm nervous about playing with	(LOGAND <non-fixnum> -1)).

2005-07-06 11:57  gb

	* level-0/PPC/ppc-float.lisp: Define %%SCALE-SFLOAT for PPC64.

2005-07-06 11:56  gb

	* level-0/nfasload.lisp: Early PROVIDE pushes (STRING MODULE) on
	*MODULES*.

2005-07-06 11:56  gb

	* level-0/l0-hash.lisp: Don't define key-mangling functions at
	compile-time (so that it's easier to experiment with them.)
	
	Mangle keys on PPC64, which seems to greatly improve GETHASH
	performance.

2005-07-06 11:54  gb

	* level-0/l0-float.lisp: SCALE-FLOAT calls %%SCALE-SFLOAT on PPC64.

2005-07-05 20:04  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: natural ALU ops were ...
	missing; problems with inlined boxing/unboxing of 64-bit integers. 
	64-bit aref.

2005-07-05 19:56  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp: natural ALU ops take 32-bit
	args, return 32-bit results on PPC32.

2005-07-05 19:48  gb

	* compiler/PPC/ppc2.lisp: natural-vref, natural-vset for ppc64. 
	Handle 64-bit integer vectors.

2005-07-05 19:47  gb

	* compiler/nx1.lisp: Two-arg addition, subtraction on unsigned
	natural-sized integers.

2005-07-05 19:46  gb

	* compiler/nx0.lisp: NX-BINARY-NATURAL-OP-P may want to look at
	result type.

2005-07-05 19:44  gb

	* compiler/arch.lisp: Error codes for not-u64, not-s64 were
	backwards.  (continue from constant redefinition CERRORs, recompile
	everything).

2005-07-05 07:25  gb

	* level-0/PPC/PPC32/l0-bignum-ppc32.lisp: Need NUMBER-CASE-MACRO at
	compile-time.

2005-07-05 07:12  gb

	* level-0/PPC/PPC64/l0-bignum-ppc64.lisp: LOGBITP: fencepost on
	fixnum-only bound (can only access most significant bit of fixnum,
	not beyond ...).  (Was looking at ppc32 constants, so this didn't
	lead to erroneous code, but may have been very inefficient in some
	cases.)

2005-07-05 07:11  gb

	* level-0/PPC/PPC32/l0-bignum-ppc32.lisp: LOGBITP: fencepost on
	fixnum-only bound (can only access most significant bit of fixnum,
	not beyond ...).

2005-07-05 04:25  gb

	* level-1/version.lisp: Bump.

2005-07-05 04:19  gb

	* level-0/: l0-aprims.lisp, l0-array.lisp, l0-complex.lisp,
	l0-def.lisp, l0-error.lisp, l0-float.lisp, l0-hash.lisp,
	l0-init.lisp, l0-int.lisp, l0-io.lisp, l0-misc.lisp,
	l0-numbers.lisp, l0-pred.lisp, l0-symbol.lisp, l0-utils.lisp: Add
	(IN-PACKAGE "CCL").

2005-07-05 04:18  gb

	* level-0/nfasload.lisp: Add (IN-PACKAGE "CCL").
	
	Do SET-PACKAGE and FIND-PACKAGE here, so that IN-PACKAGE can be
	used in level-0 and early level-1 files.  (All of these files are
	in the CCL package; the IN-PACKAGE forms are supposed to help text
	editors set the buffer package reasonably when editing these
	files.)

2005-07-05 04:11  gb

	* level-0/PPC/: PPC32/ppc32-bignum.lisp,
	PPC32/l0-bignum-ppc32.lisp, ppc-array.lisp, ppc-clos.lisp,
	ppc-def.lisp, ppc-float.lisp, ppc-hash.lisp, ppc-io.lisp,
	ppc-misc.lisp, ppc-numbers.lisp, ppc-pred.lisp, ppc-symbol.lisp,
	ppc-utils.lisp: Add (IN-PACKAGE "CCL").

2005-07-05 02:52  gb

	* level-0/PPC/PPC64/l0-bignum-ppc64.lisp: Add (IN-PACKAGE "CCL").
	
	%LDB-FIXNUM-FROM-BIGNUM: byte may span as many as 3 digits, not
	just 2.

2005-07-05 02:51  gb

	* level-0/PPC/PPC64/ppc64-bignum.lisp: Add (IN-PACKAGE "CCL").

2005-07-05 02:50  gb

	* level-1/l1-files.lisp: REMOVE . before removing :UP in REMOVE-UP.

2005-07-05 02:50  gb

	* level-1/l1-symhash.lisp: Move SET-PACKAGE stuff into level-0.

2005-07-05 02:49  gb

	* level-1/l1-typesys.lisp: Integrate 64-bit vectors into type
	system better.

2005-07-05 02:49  gb

	* level-1/level-1.lisp: #+sparc-target ? no.

2005-07-05 02:48  gb

	* lisp-kernel/lisp-debug.c: Recognize 64-bit traps, 64-bit BOUNDP
	traps.

2005-07-05 02:47  gb

	* lisp-kernel/lisp-exceptions.h: Recognize LD instructions, for
	debugger.

2005-07-05 02:47  gb

	* lib/nfcomp.lisp: Add an IN-PACKAGE; format/layout changes.

2005-07-05 02:46  gb

	* lib/macros.lisp: Nuke CLtL1 backward-compatibility stuff in
	IN-PACKAGE.

2005-07-05 02:45  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: %ILSL : zero result if
	shift count > 63 (not 31).

2005-07-05 02:44  gb

	* compiler/PPC/ppc2.lisp: Fix vcell locations in inlined lambda
	&optional/&key processing.

2005-07-04 22:22  gb

	* level-0/l0-cfm-support.lisp: no it wasn't

2005-07-04 22:20  gb

	* level-0/l0-cfm-support.lisp: file was empty

2005-07-04 01:55  gb

	* lisp-kernel/spentry.s: _SPbuiltin_length does
	list-length/circularity check on PPC64.
	
	_SPbuiltin_seqtype was checking (random) imm1 value, rather than
	typecode in imm0; this means that sequence functions sometimes
	tried to treat non-list arguments as vectors (rather than
	complaining about non-sequences.) (This seems to have been present
	on both platforms, and may have been long-standing.)

2005-07-04 01:52  gb

	* lib/time.lisp: Use reentrant #_localtime_r.
	
	GCTIME uses (host) :timeval size, not hardwired constant.

2005-07-04 01:51  gb

	* lib/db-io.lisp: Don't override field offsets assigned by
	interface translator!
	
	Assume that DarwinPPC64 uses natural PPC struct alignment.  (AFAIK,
	Apple hasn't bothered to document the ABI yet.)

2005-07-04 01:49  gb

	* level-1/: l1-io.lisp, l1-reader.lisp: Only use character names
	for non-graphic-standard-chars (for #\Newline and for
	non-standard-chars) when writing chars with #\ syntax.
	
	*NAME-CHAR-ALIST*: reorder so that standard/semi-standard char
	names are preferred.

2005-07-04 01:47  gb

	* level-1/l1-init.lisp: Make *TOTAL-GC-MICROSECONDS* big enough.

2005-07-04 01:46  gb

	* level-0/PPC/PPC64/l0-bignum-ppc64.lisp: fix-big-logandc2:  start
	complementing at second digit, since fixnum op handled low 2
	digits.

2005-07-04 01:45  gb

	* level-0/PPC/ppc-hash.lisp: EQL hashing treats +/- 0.0 the same.

2005-07-04 01:44  gb

	* level-0/PPC/ppc-array.lisp: %EXTEND-VECTOR: handle bit-vector
	case with non-zero start offset.

2005-07-04 01:43  gb

	* compiler/PPC/ppc-lap.lisp: Functions can't (easily) overflow on
	PPC64.

2005-07-04 01:42  gb

	* compiler/nx1.lisp: NX1-ASH: (ash X 0) should typecheck X.

2005-07-04 01:41  gb

	* compiler/optimizers.lisp: TRANSFORM-LOGOP: some logical
	operations aren't commutative.

2005-07-03 02:38  gb

	* lisp-kernel/spentry.s: Try to schedule special-variable reference
	subprims a little better.  (Hard, since we can't do speculative
	execution, but at least move a test further from a dependent
	branch.)

2005-07-03 02:36  gb

	* level-0/PPC/PPC64/ppc64-bignum.lisp: Single-digit LOGANDC1,
	LOGANDC2: store value in DEST if non-nil (was clobbering source
	bignum arg.)

2005-07-03 02:35  gb

	* level-0/PPC/PPC64/l0-bignum-ppc64.lisp: Bignum LOGXOR does LOGXOR
	(not LOGIOR ...) on each digit.
	
	Bignun-X-fixnum LOGANDC1, LOGANDC2 assume that the fixnum op has
	set low 2 (32-bit) digits.

2005-07-03 02:32  gb

	* level-0/PPC/ppc-float.lisp: %DOUBLE-FLOAT-SIGN, %SHORT-FLOAT-SIGN
	back in LAP, return T iff sign bit is set.

2005-07-03 02:31  gb

	* level-0/l0-hash.lisp: Some paranoia in SXHASH-AUX; ensure that
	the "similar" -0.0 and 0.0 SXHASH to the same value on PPC64.

2005-07-03 02:30  gb

	* level-0/l0-float.lisp: Move %DOUBLE-FLOAT-SIGN,
	%SINGLE-FLOAT-SIGN back to LAP (and make them return boolean
	valures, as their callers expect.)
	
	PPC64: LOG-E: coerce X to SINGLE-FLOAT before calling
	%SHORT-FLOAT-ABS on it.  (Note: bugs like this may clobber the
	tcr's single-float convert slot, making it hard to box/unbox
	single-floats in that thread.  If user code can do this (or if
	system code keeps being buggy ...), should make it easier to fix
	the tcr slot.)

2005-07-03 02:22  gb

	* compiler/optimizers.lisp: (ASH x 0) - return X, but typecheck it

2005-07-03 02:21  gb

	* compiler/nx-basic.lisp: In default compiler policy, don't trust
	declarations or do unsafe things if SAFETY optimize quantity is 3.

2005-07-02 20:01  gb

	* xdump/hashenv.lisp: TARGET-ARCH-CASE for some hash-table macros. 
	(l0-hash.lisp functions have been a little confused about
	types/tags.)

2005-07-02 20:00  gb

	* lisp-kernel/spentry.s: Store low 32 bits, not high 32 when
	storing into a (SIMPLE-ARRAY (SIGNED-BYTE 32) (*)).

2005-07-02 19:59  gb

	* lisp-kernel/lisp-debug.c: Avoid "%08x" in printf format strings,
	when size of arg isn't known to be 32 bits.

2005-07-02 19:57  gb

	* level-1/version.lisp: Lisp image du jour.

2005-07-02 19:56  gb

	* level-1/sysutils.lisp: Make a real (SETF MACRO-FUNCTION)
	function; make the old SET-MACRO-FUNCTION call it.  (Note that this
	may be a little tricky to bootstrap: it may be necessary to do:
	
	? (remhash 'macro-function ccl::%setf-methods%)
	
	to remove the old SETF inverse established by DEFSETF.)

2005-07-02 19:54  gb

	* level-1/ppc-trap-support.lisp: So many mis-indented comments, so
	little time.

2005-07-02 19:52  gb

	* level-1/l1-error-signal.lisp: Make TYPE-ERROR objects with
	implicit EXPECTED-TYPE slots if no type info available.

2005-07-02 19:51  gb

	* level-1/l1-clos.lisp: target package in %SLOT-UNBOUND-TRAP.

2005-07-02 19:50  gb

	* level-1/l1-aprims.lisp: APPEND has something to do with the CL
	definition ...

2005-07-02 19:49  gb

	* level-0/PPC/PPC64/l0-bignum-ppc64.lisp: LOGTEST of 2 bignums
	looks at both args (rather than LOGTESTing the first with itself.)
	
	LOGTEST of fixnum and bignum looks at second 32-bit digit if it
	exists and no intersection on first digit.

2005-07-02 19:47  gb

	* level-0/PPC/ppc-def.lisp: %SET-OBJECT stores a natural-sized
	value, not a 32-bit word ...

2005-07-02 19:46  gb

	* level-0/l0-misc.lisp: PROPER-LIST-P returns false on dotted lists
	(as someone may have suggested a few months ago.)

2005-07-02 19:46  gb

	* level-0/l0-hash.lisp: Comment formatting changes only.

2005-07-02 16:52  gb

	* level-0/l0-array.lisp: PPC64-specific changes: Get upper bound of
	(UNSIGNED-BYTE 64) right.

2005-07-02 16:32  gb

	* lisp-kernel/spentry.s: PPC64-specific changes: makeu64: make a
	3-digit bignum if we need 3 digits misc_set_common: get
	type-checking right on (SIGNED-BYTE 16), (UNSIGNED-BYTE 64).

2005-07-02 16:31  gb

	* lib/backtrace.lisp: ; -> ;;; on section comments.

2005-07-02 14:42  gb

	* lib/backtrace.lisp: FIND-LOCAL-NAME: encoded stack-frame
	addresses are a function of target::word-size.

2005-07-02 05:51  gb

	* level-0/PPC/PPC64/ppc64-bignum.lisp: %MULTIPLY returns (values
	"high 32 bits of product" low 32 bits of product") in that order. 
	(%MULTIPLY is currently only used to validate the "guess" digit in
	BIGNUM-TRUNCATE's aux functions, so getting things completely
	backwards here only caused some bad guess digits to be accepted.)

2005-07-02 05:47  gb

	* level-0/PPC/PPC32/ppc32-bignum.lisp: Some comments had been
	line-wrapped (presumably causing some words to become lap labels).

2005-07-02 05:45  gb

	* level-0/PPC/ppc-numbers.lisp: 64-bit
	%ROUND-NEAREST-SHORT-FLOAT->FIXNUM stores FP0 in the right place
	...

2005-07-01 16:00  gb

	* level-0/PPC/PPC64/l0-bignum-ppc64.lisp: %ADD-WITH-CARRY and
	%SUBTRACT-WITH-BORROW operate on the low 32 bits of their arguments
	(e.g, -1 is #x00000000ffffffff)).

2005-07-01 03:55  gb

	* level-0/PPC/ppc-float.lisp: ppc64 bug fixes.

2005-07-01 03:53  gb

	* level-0/PPC/ppc-pred.lisp: use T vice (+ ppc64::nil-value
	ppc64::t-offset) in EQL.

2005-07-01 03:52  gb

	* level-0/PPC/PPC64/l0-bignum-ppc64.lisp: Bug fixes.

2005-07-01 03:50  gb

	* level-1/l1-numbers.lisp: Indentation.

2005-07-01 03:49  gb

	* level-1/linux-files.lisp: yet another way to change default
	directory (CCL::CD).

2005-07-01 03:48  gb

	* level-1/sysutils.lisp: SET-MACRO-FUNCTION accepts/ignores env
	arg.

2005-07-01 03:48  gb

	* lib/numbers.lisp: Remove some comments.

2005-07-01 03:47  gb

	* lisp-kernel/spentry.s: Check for sign-extension via arithmetic
	shift (not logical shift) in makes128.

2005-07-01 03:46  gb

	* level-0/l0-numbers.lisp: Comment indentation.

2005-07-01 03:46  gb

	* level-0/l0-float.lisp: Several bug fixes ...

2005-07-01 03:43  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: ADJUST-SP was missing.

2005-07-01 03:43  gb

	* compiler/nx1.lisp: Handle LABELS declarations differently; this
	may need more thought/work.

2005-06-30 18:36  gb

	* level-1/version.lisp: bump.

2005-06-30 17:47  gb

	* lisp-kernel/spentry.s: Zero the CTR when entering/returning from
	lisp code.
	
	Fix valence when reentering lisp with exception-handler swap.

2005-06-30 17:46  gb

	* lisp-kernel/pmcl-kernel.c: commit_pages() may fail, so it returns
	Boolean.  This needs work (overcommit, etc.)

2005-06-30 17:45  gb

	* lisp-kernel/macros.s: Use signed alloc traps.

2005-06-30 17:45  gb

	* lisp-kernel/lisp-exceptions.h: resize_dyamic_heap() may fail, so
	it returns a Boolean.
	
	Define new alloc trap instructions; contunue to define old ones,
	for bootstrapping.

2005-06-30 17:43  gb

	* lisp-kernel/lisp-exceptions.c: Recognize old (unsigned) alloc
	traps as well as new (signed) ones.
	
	Check for failure in memory allocation requests; fixup allocptr
	before signalling lisp errors in case of failure.

2005-06-30 17:41  gb

	* lisp-kernel/gc.c: What exactly is a "locatitive" ?

2005-06-30 17:40  gb

	* level-1/l1-typesys.lisp: Compute an effective slot-definition's
	type predicate based on the value of its type slot, not the
	(possibly unsupplied) :TYPE initarg.

2005-06-30 17:39  gb

	* level-1/l1-error-system.lisp: Recognize (UNSIGNED-BYTE 56) as an
	expected type in some UUO type errors.

2005-06-30 17:38  gb

	* level-1/l1-clos.lisp: Slot-definition's TYPE slots default to T,
	damn it.  Compute the intersection of all direct slots' types when
	determining an effective slot's type.  (We should probably complain
	if the intersection is empty, and there may be cases where it can't
	be computed.)

2005-06-30 17:34  gb

	* level-0/PPC/PPC64/l0-bignum-ppc64.lisp: Allow
	BIGNUM-REF/BIGNUM-SET to inline.

2005-06-30 17:34  gb

	* compiler/PPC/: PPC32/ppc32-vinsns.lisp, PPC64/ppc64-vinsns.lisp:
	Use signed alloc traps.  (This means that valid heap addresses are
	limited to the low half of the address space; this has been true
	because of OS limitations.)

2005-06-30 17:31  gb

	* compiler/PPC/ppc-disassemble.lisp: Recognize SRDI.

2005-06-30 17:30  gb

	* compiler/: nx1.lisp, PPC/ppc2.lisp: (partially) revive
	%TYPED-MISCREF and %TYPED-MISCSET.

2005-06-29 16:52  gb

	* level-1/version.lisp: bump.

2005-06-29 16:30  gb

	* compiler/PPC/ppc2.lisp: %ilogand2: use clear-left, clear-right if
	appropriate.
	
	NOTE: clear-left doesn't ensure that tag bits are cleared; code
	which says (logand (the fixnum x) mask) - and lies about the type
	of X - is unsafe, but any such code is pretty bogus to begin with.

2005-06-29 16:11  gb

	* compiler/PPC/: PPC64/ppc64-vinsns.lisp, PPC32/ppc32-vinsns.lisp:
	CLEAR-LEFT and CLEAR-RIGHT.

2005-06-29 15:06  gb

	* level-0/PPC/PPC64/l0-bignum-ppc64.lisp: Reorganize TRUNCATE and
	related functions.

2005-06-29 15:04  gb

	* level-0/PPC/ppc-def.lisp: %SUB-TIMEVALS in lisp.

2005-06-29 15:03  gb

	* level-0/l0-misc.lisp: Kinder, gentler %usedbytes.

2005-06-29 15:02  gb

	* level-0/l0-hash.lisp: Comment indentation.

2005-06-29 15:01  gb

	* level-0/l0-float.lisp: Fix typos in conditionalization.

2005-06-29 15:00  gb

	* lisp-kernel/spentry.s: Missing close-paren in comment.

2005-06-29 14:59  gb

	* lisp-kernel/pmcl-kernel.c: lisp_heap_threshold, egc thresholds
	are platform-specific (twice as large on 64-bit.)
	
	Enable EGC on PPC64.

2005-06-29 14:58  gb

	* lisp-kernel/lisp-exceptions.c: PPC64 codevector header stuff.
	
	When handling an allocation trap, ensure that displacement is a
	"signed natural" (signed int of natural word size), not an "int"
	(signed-byte 32).
	
	Don't explicitly zero pages that should already be zeroed in
	new_heap_segment; the PPC64-specific bug was elsewhere.

2005-06-29 14:54  gb

	* lisp-kernel/gc.c: If EGC memoization is missing, say "doublenode"
	instead of "doubleword".
	
	When masking out bits at the end of the "refbits" bit vector,
	ensure that C does 64-bit arithmetic.

2005-06-29 14:52  gb

	* lisp-kernel/constants64.h: heap_segment_size (and log2 of it) are
	platform-specific.  Make many constants explicitly "long", to
	discourage 32-bit arithmetic.

2005-06-29 14:50  gb

	* lisp-kernel/: constants.h, constants32.h: heap_segment_size (and
	log2 of it) are platform-specific.

2005-06-29 14:49  gb

	* level-1/linux-files.lisp: Do SUB-TIMEVALS in lisp.  (Did this
	cons or something ? Why was it in LAP ?)

2005-06-29 14:48  gb

	* level-1/l1-clos-boot.lisp: Remove stray DBG call.

2005-06-17 04:48  gb

	* lisp-kernel/spentry.s: s16 and u16 cases were backwards in
	misc_ref.

2005-06-17 04:48  gb

	* lisp-kernel/pmcl-kernel.c: EGC not ready on PPC64 yet.

2005-06-17 04:47  gb

	* lisp-kernel/constants64.s: misc_dloat_offset isn't
	misc_header_offset ...	double_float_header reflects the view of a
	double-float as two 32-bit elements.

2005-06-17 04:45  gb

	* lib/arrays-fry.lisp: Sigh.  May not be ppc32, use target package.

2005-06-17 04:44  gb

	* level-1/ppc-trap-support.lisp: Define and use
	XP-GPR-SIGNED-DOUBLEWORD.

2005-06-17 04:43  gb

	* level-1/l1-aprims.lisp: Don't do APPEND two lists at a time ...

2005-06-17 04:29  gb

	* level-0/PPC/ppc-array.lisp: Don't reuse NVRs in hard case of
	%EXTEND-VECTOR on either platform.

2005-06-16 17:13  gb

	* lisp-kernel/spentry.s: Fix ppc64 bignum case of integer-sign.
	
	Some stores and loads (FP constants, fpscr, etc.) need to be
	32-bit, not ldr/str.

2005-06-16 17:11  gb

	* lisp-kernel/lisp-exceptions.c: Just say "%lx", not %08lx".

2005-06-16 17:11  gb

	* lisp-kernel/lisp-debug.c: Forgot to say "%lx" in some printf
	calls.

2005-06-16 17:10  gb

	* lisp-kernel/constants64.s: c_reg_save has room for N nodes, not N
	4-byte things.

2005-06-16 17:08  gb

	* level-0/PPC/PPC64/l0-bignum-ppc64.lisp: Define and use %LOGXOR,
	and set carry on entry to negation loop.

2005-06-16 17:07  gb

	* level-1/l1-init.lisp: ARRAY-RANK-LIMIT, CALL-ARGUMENTS-LIMIT,
	LAMBDA-PARAMETERS-LIMIT are functions of target::node-size.

2005-06-16 05:44  gb

	* level-0/l0-float.lisp: %truncate-double-float for PPC64.

2005-06-16 05:43  gb

	* level-0/l0-numbers.lisp: INIT-RANDOM-STATE-SEEDS on both
	platforms.

2005-06-16 05:41  gb

	* level-0/PPC/PPC64/l0-bignum-ppc64.lisp: Use old (safe-but-slow)
	bignum GCD routine on PPC64, for now.  Define
	ONE-BIGNUM-FACTOR-OF-TWO.

2005-06-16 05:39  gb

	* level-1/version.lisp: 050616.

2005-06-16 05:38  gb

	* lisp-kernel/darwin/Makefile: Don't try to determine GCC version
	from "reading specs from ..." verbose output if specs aren't read
	from a file (assume modern GCC in that case.)

2005-06-16 05:36  gb

	* lisp-kernel/pmcl-kernel.c: Enable EGC on PPC64.

2005-06-16 05:36  gb

	* lisp-kernel/gc.c: Zero enough bits (shift by "bitmap_shift", not
	"5") when tenuring to an area other than the oldest.

2005-06-15 23:41  gb

	* lib/nfcomp.lisp, xdump/faslenv.lisp: Bump fasl version.

2005-06-15 23:41  gb

	* level-0/PPC/PPC32/l0-bignum-ppc32.lisp: Remove embedded control
	char.

2005-06-15 23:16  gb

	* level-1/version.lisp: Bump; claim "Alpha" status for PPC64.

2005-06-15 23:15  gb

	* level-0/PPC/ppc-array.lisp: Fixes in %INIT-MISC.

2005-06-15 23:15  gb

	* level-0/PPC/ppc-def.lisp: %MAKE-CODE-EXECUTABLE fixes for PPC64.

2005-06-15 23:14  gb

	* level-0/PPC/ppc-misc.lisp: Word-size fixes.

2005-06-15 23:13  gb

	* level-0/PPC/ppc-numbers.lisp: don't do unsigned divide in
	%FIXNUM-TRUNCATE.  Bad %NEXT-RANDOM-SEED is arguably better than
	none.

2005-06-15 23:12  gb

	* level-0/PPC/ppc-utils.lisp: Fix in #+ppc64-target
	walk-static-area.

2005-06-15 23:11  gb

	* level-0/PPC/PPC64/: ppc64-bignum.lisp, l0-bignum-ppc64.lisp:
	Lots-o-bug-fixes.

2005-06-15 23:10  gb

	* level-1/l1-typesys.lisp: specialized-array-element-types include
	ppc64 64-bit array types.

2005-06-15 23:09  gb

	* level-1/l1-numbers.lisp: RANDOM-STATE changes for ppc64;
	%single-float-atanh for ppc64.

2005-06-15 23:08  gb

	* level-1/l1-clos-boot.lisp: Set up ppc64 signed/unsigned 64-bit
	vectors in class table.

2005-06-15 23:07  gb

	* xdump/xppcfasload.lisp: Define image-base-address per-backend.

2005-06-15 23:06  gb

	* xdump/xfasload.lisp: New fasl ops for 32-bit, 64-bit signed
	integers.  Image-base-address determined by backend.

2005-06-15 23:06  gb

	* xdump/faslenv.lisp: New fasl ops for 32-bit, 64-bit signed
	integers.

2005-06-15 23:04  gb

	* xdump/heap-image.lisp: Remove (obsolete) reference defs.

2005-06-15 23:03  gb

	* xdump/.cvsignore: Ignore 64-bit FASL files.

2005-06-15 23:02  gb

	* scripts/openmcl64: New file.

2005-06-15 23:01  gb

	* lisp-kernel/darwin64/Makefile: Need to check gcc version in some
	other way (actually, we can assume >= 4.0 for DarwinPPC64.)

2005-06-15 23:00  gb

	* lisp-kernel/darwin/.gdbinit: So, Apple ?  What's with all the
	SIGTTIN's ?

2005-06-15 22:59  gb

	* lisp-kernel/spentry.s: Fix bit vectore ref/set, small-bignum
	initialization after shifts/multiplies for ppc64.

2005-06-15 22:58  gb

	* lisp-kernel/ppc_print.c: Print some more uvector types in kernel
	debugger.

2005-06-15 22:57  gb

	* lisp-kernel/pmcl-kernel.c: Create much larger reserved area on
	ppc64.	Fix handling of HeapHighWaterMark, especially in cases when
	EGC is off.

2005-06-15 22:56  gb

	* lisp-kernel/lisp.h: Ensure that _align_to_power_of_2 DTRT on
	ppc64.

2005-06-15 22:53  gb

	* lisp-kernel/: lisp-exceptions.c, lisp-exceptions.h: Word-size
	changes.

2005-06-15 22:49  gb

	* lisp-kernel/lisp-debug.c: (S) command to find/describe symbol
	with matching pname.

2005-06-15 22:49  gb

	* lisp-kernel/gc.h: PPC64 code-vector-prefix.

2005-06-15 22:48  gb

	* lisp-kernel/gc.c: Lots of word-size fixes.

2005-06-15 22:47  gb

	* lisp-kernel/area.h: 64-bit IMAGE_BASE_ADDRESS for ppc64.

2005-06-15 22:46  gb

	* lib/setf-runtime.lisp: APPLY+ changes for PPC64.

2005-06-15 22:45  gb

	* lib/numbers.lisp: Use target::fixnumshift in PRINT-OBJECT method
	on RANDOM-STATE.

2005-06-15 22:44  gb

	* lib/nfcomp.lisp: Dump small integers (signed-byte 16, 32, 64) via
	specialized ops.

2005-06-15 22:14  gb

	* lib/macros.lisp: Parameterize %ilogbitp, other things for ppc64.

2005-06-15 22:13  gb

	* lib/foreign-types.lisp: :cdb-datum.size is (:unsigned 32), not
	:unsigned-long.

2005-06-15 22:12  gb

	* lib/db-io.lisp: Portability changes.

2005-06-15 22:11  gb

	* lib/backtrace.lisp: Conditionalize REGISTERS-USED-BY.

2005-06-15 22:11  gb

	* lib/backtrace-lds.lisp: target: package changes.

2005-06-15 22:10  gb

	* lib/apropos.lisp: Remove commented-out code.

2005-06-15 22:09  gb

	* level-0/PPC/PPC32/l0-bignum-ppc32.lisp: ONE-BIGNUM-FACTOR-OF-TWO,
	LOGBITP here for PPC32.

2005-06-15 22:06  gb

	* level-0/nfasload.lisp: primsizes array isn't of (non-portable)
	element-type 'fixnum.  New fasl ops for s32, s64.  Count package
	htab elements based on SYMBOLP only when resizing.

2005-06-15 22:02  gb

	* level-0/l0-pred.lisp: Fix NUMBERP typo.

2005-06-15 22:02  gb

	* level-0/l0-numbers.lisp: 
	Move ONE-BIGNUM-FACTOR-OF-TWO, LOGBITP elsewhere.

2005-06-15 22:01  gb

	* level-0/l0-misc.lisp: Look at the right area slots in
	%RESERVEDBYTES.

2005-06-15 21:58  gb

	* level-0/l0-int.lisp: Indentation and comment changes.

2005-06-15 21:57  gb

	* level-0/l0-float.lisp: ppc64 fixes.

2005-06-15 21:55  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: Several fixes, mostly in
	bit addressing.

2005-06-15 21:54  gb

	* compiler/PPC/ppc-lapmacros.lisp: UNBOX-BASE-CHAR fixes for PPC64;
	16-bit digit-part accessors are ppc32-only.

2005-06-15 21:53  gb

	* compiler/PPC/ppc-disassemble.lisp: :RAW option to
	PPC-XDISASSEMBLE, ppc-gpr handles target rcontext.

2005-06-15 21:52  gb

	* compiler/nx1.lisp: Check platform-specific "naturalness" in
	comparisons.

2005-06-13 15:17  gb

	* lisp-kernel/lisp-exceptions.h: minor_opcode_TR cut-and-paste
	mishap.

2005-06-12 15:29  gb

	* level-1/l1-symhash.lisp: Missed another thing (in
	%USE-PACKAGE-CONFLICT-CHECK) that accesses package hash tables
	directly (and was doing so incorreclty, per the New Order.)

2005-06-10 16:13  gb

	* lisp-kernel/thread_manager.c: sigaction flags, node_size changes
	in thread startup.

2005-06-10 16:12  gb

	* lisp-kernel/subprims.s: start_lisp: save/restore C registers,
	build C stack frame in node_size multiples (not 4-byte multiples.)

2005-06-10 16:11  gb

	* lisp-kernel/ppc_print.c: Print (immedate) SINGLE-FLOATs on ppc64.

2005-06-10 16:09  gb

	* lisp-kernel/pmcl-kernel.c: sigaction flags.

2005-06-10 16:08  gb

	* lisp-kernel/lisp_globals.h: Define MIN_KERNEL_GLOBAL.

2005-06-10 16:08  gb

	* lisp-kernel/lisp-exceptions.h: We seem to be committed to the
	"new" DarwinSigReturn.	Add a little bit of abstraction for trap
	opcodes.

2005-06-10 16:04  gb

	* lisp-kernel/lisp-exceptions.c: Decode some traps more portably;
	still some work to be done here.

2005-06-10 16:02  gb

	* lisp-kernel/image.c: Word-size issues; use MIN_KERNEL_GLOBAL
	rather than platform-dependent constant.

2005-06-10 15:58  gb

	* lisp-kernel/gc.c: Lots of word-size issues.

2005-06-10 15:57  gb

	* lisp-kernel/constants64.s: Split tcr.flags into two 32-bit words,
	because the .h file does so.

2005-06-10 15:56  gb

	* compiler/optimizers.lisp: Always do N-ary +/- as a sequence of
	2-arg operations.

2005-06-10 15:55  gb

	* lib/numbers.lisp: Comment indentation.

2005-06-10 15:18  gb

	* level-1/version.lisp: Version de jour.

2005-06-10 15:16  gb

	* level-1/l1-processes.lisp: target:: package prefix changes.

2005-06-10 15:16  gb

	* level-1/l1-boot-1.lisp: HOST-PLATFORM returns second (64-bit-p)
	value; PLATFORM-DESCRIPTION decodes that,
	LISP-IMPLEMENTATION-VERSION uses that info.

2005-06-10 15:13  gb

	* level-0/PPC/PPC64/: l0-bignum-ppc64.lisp, ppc64-bignum.lisp: Bug
	fixes ...

2005-06-10 15:12  gb

	* level-0/PPC/ppc-misc.lisp: Use trlgei in (IIRC)
	%%SAVE-APPLICATION trap.

2005-06-10 15:11  gb

	* level-0/PPC/ppc-float.lisp: Move some #+ppc64 code to lisp.

2005-06-10 15:09  gb

	* level-0/nfasload.lisp: Finish package changes.

2005-06-10 15:08  gb

	* level-0/l0-init.lisp: Conditionalize ARRAY-TOTAL-SIZE-LIMIT; add
	*features* for word size, endianness.

2005-06-10 15:07  gb

	* level-0/l0-float.lisp: Some 64-bit conditionalization.

2005-06-10 15:04  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp: Need to define
	ONE-DIGIT-BIGNUM-HEADER after all.

2005-06-10 15:04  gb

	* compiler/PPC/ppc-lapmacros.lisp: SET-GLOBAL sets all 64  bits on
	PPC64.

2005-06-09 15:29  gb

	* lib/compile-ccl.lisp: Compile all of target-xdev-modules, not
	just the cdr of the list (why was it ever skipping the car of that
	list ???)

2005-06-07 23:35  gb

	* xdump/xfasload.lisp: Initial element in cloned package htabs is
	0, too.  New binaries.

2005-06-07 22:49  gb

	* level-1/version.lisp: 050607,  once in a lifetime.

2005-06-07 22:48  gb

	* level-0/nfasload.lisp, level-1/l1-symhash.lisp: Finish package
	bootstrapping (unless I missed something): package hash tables
	contain symbols (NILSYM on PPC32), 0 (unused/free entries), or
	(PACKAGE-DELETED-MARKER)s.

2005-06-07 21:06  gb

	* lisp-kernel/darwin/.gdbinit: Don't stop in GDB on SIGKILL.

2005-06-07 21:06  gb

	* lisp-kernel/spentry.s: ASH can return 64-bit results, as can
	fixnum multiplication.

2005-06-07 21:05  gb

	* lisp-kernel/pmcl-kernel.c: 64-bit changes.

2005-06-07 21:04  gb

	* lisp-kernel/lisp-exceptions.h: define some PPC64 opcodes/masks.

2005-06-07 21:02  gb

	* lisp-kernel/: lisp-debug.c, lisp-exceptions.c: Propagate
	exceptions on Darwin.

2005-06-07 21:02  gb

	* lisp-kernel/gc.h: 64-bit changes/fixes.  Ensure that area_dnode
	returns natural.

2005-06-07 21:01  gb

	* lisp-kernel/gc.c: 64-bit changes/fixes.

2005-06-07 21:00  gb

	* lisp-kernel/constants64.s: 4&5-bit bignum headers.

2005-06-07 20:59  gb

	* lisp-kernel/constants.h: TCR_FLAG_BIT_PROPAGATE_EXCEPTION.

2005-06-07 20:58  gb

	* lisp-kernel/: bits.c, bits.h: 64-bit changes.

2005-06-07 20:57  gb

	* level-1/ppc-trap-support.lisp: Decode and handle 64-bit traps.

2005-06-07 20:56  gb

	* level-1/: l1-typesys.lisp, sysutils.lisp: Use
	target::target-most-positive-fixnum when applicable.

2005-06-07 20:56  gb

	* level-1/l1-symhash.lisp: Use PACKAGE-DELETED-MARKER.

2005-06-07 20:55  gb

	* level-1/l1-streams.lisp: COLUMN moved here.

2005-06-07 20:54  gb

	* level-1/l1-lisp-threads.lisp: Recognize 64-bit bogus-objects.

2005-06-07 20:53  gb

	* level-1/l1-io.lisp: lower-case 1 char.

2005-06-07 20:53  gb

	* lib/compile-ccl.lisp: Remove some duplication.

2005-06-07 20:52  gb

	* lib/format.lisp: Remove some commented-out code.

2005-06-07 20:51  gb

	* lib/macros.lisp: 64-bit (DarwinPPC) callbacks.

2005-06-07 20:50  gb

	* lib/streams.lisp: Move COLUMN definition earlier.

2005-06-07 20:47  gb

	* library/lispequ.lisp: PACKAGE-DELETED-MARKER, some
	comment/formatting changes.

2005-06-07 20:46  gb

	* level-0/PPC/PPC64/: l0-bignum-ppc64.lisp, ppc64-bignum.lisp: Bug
	fixes.

2005-06-07 18:36  gb

	* level-0/PPC/PPC32/ppc32-bignum.lisp: Comment formatting.

2005-06-07 18:35  gb

	* level-0/PPC/ppc-utils.lisp: GC returns target::nil-value.

2005-06-07 18:34  gb

	* level-0/PPC/ppc-numbers.lisp: Do an unsigned divide; there may be
	another problem here (this is almost certainly wrong.)

2005-06-07 18:31  gb

	* level-0/nfasload.lisp: Start to recognize 0 as an unused package
	htab entry.

2005-06-07 18:30  gb

	* level-0/l0-numbers.lisp: target-package stuff.

2005-06-07 18:29  gb

	* level-0/l0-int.lisp: Some more target conditionalization.

2005-06-07 18:29  gb

	* level-0/l0-float.lisp: INTEGER-DECODE-DOUBLE-FLOAT doesn't have
	to make bignums on ppc64.

2005-06-07 18:27  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: trap-unless-list traps if
	tag is unsignged< or unsigned> ppc64::fulltag-cons, to distinguish
	itself from trap-unless-cons cases.

2005-06-07 18:25  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp: tag-imm-2.

2005-06-07 18:25  gb

	* compiler/PPC/ppc2.lisp: Target-specific shift counts.

2005-06-07 18:24  gb

	* compiler/optimizers.lisp: LOCKP, INTEGERP use target types.

2005-06-07 18:23  gb

	* compiler/nx1.lisp: Parameterize ASH for target fixnum size.

2005-06-03 09:10  gb

	* level-1/version.lisp: Bump: 050603.

2005-06-03 09:09  gb

	* lisp-kernel/darwin/.gdbinit: 32/64-bit versions of some
	utilities; need to do
	
	(gdb) set $ppc64=1
	
	manually to enable 64-bit versions.

2005-06-03 09:08  gb

	* level-1/runtime.lisp: No more *LDS*.

2005-06-03 09:06  gb

	* level-1/: ppc-callback-support.lisp, ppc-trap-support.lisp:
	Target:: package changes, code-vector prefix.

2005-06-03 09:06  gb

	* level-1/: linux-files.lisp, ppc-threads-utils.lisp: Target::
	package changes.

2005-06-03 09:05  gb

	* level-1/level-1.lisp: No more LDS/*LDS*.

2005-06-03 09:02  gb

	* level-1/l1-utils.lisp: Remove some obsolete/archaic stuff.

2005-06-03 09:01  gb

	* level-1/l1-typesys.lisp: Some target-package/cross-compilation
	stuff.

2005-06-03 09:01  gb

	* level-1/l1-streams.lisp: Heap-ivector, other target-package
	fixes.

2005-06-03 09:00  gb

	* level-1/l1-readloop.lisp: Don't use (archaic) LDS macro.

2005-06-03 08:55  gb

	* level-1/l1-pathnames.lisp: Node size when getting command-line
	arguments.  Hide some pathname creation forms from COMPILE-FILE
	toplevel processing (may not be necessary now that
	cross-compilation binds *target-backend*.)

2005-06-03 08:53  gb

	* level-1/l1-numbers.lisp: LDB: look at target-package constants.

2005-06-03 08:52  gb

	* level-1/l1-lisp-threads.lisp: Lots of target-package changes.

2005-06-03 08:51  gb

	* level-1/l1-init.lisp: Use the right target-package symbols to
	initialize MOST-POSITIVE-FIXNUM and MOST-NEGATIVE-FIXNUM.

2005-06-03 08:50  gb

	* level-1/l1-format.lisp: Hide toplevel MAKE-ARRAY call (in
	*FORMAT-CHAR-TABLE* initial value); may not be necessary now that
	cross-compilation binds *target-backend*.

2005-06-03 08:49  gb

	* level-1/l1-files.lisp: Initialize *.fasl-pathname* correctly. 
	Hide toplevel macro call (in *default-pathname-defaults* initial
	value); may not be necessary now that cross-compilation binds
	*target-backend*.

2005-06-03 08:47  gb

	* level-1/l1-error-system.lisp: Remove a (meaningless) RESIDENT
	declaration.

2005-06-03 08:46  gb

	* level-1/l1-dcode.lisp: %STANDARD-INSTANCE-P uses
	TARGET-ARCH-CASE.

2005-06-03 08:45  gb

	* level-1/l1-clos-boot.lisp: Fix PPC64 ivector class names.  Lots
	of formatting changes.

2005-06-03 08:44  gb

	* level-1/l1-boot-2.lisp: More conditionalized pathnames.

2005-06-03 08:43  gb

	* level-1/l1-aprims.lisp: Some ppc64 changes + fixes.

2005-06-03 08:41  gb

	* level-0/PPC/ppc-utils.lisp: CLASS-OF, heap-walking fixes.

2005-06-03 08:40  gb

	* level-0/PPC/ppc-symbol.lisp: Don't bother conditionalizing pname
	hashes (32 bits is plenty, and we need to rehash after
	cross-compilation anyhow.)

2005-06-03 08:39  gb

	* level-0/PPC/ppc-pred.lisp: PPC64 EQUAL: recover NFN from FN after
	recursing.

2005-06-03 08:38  gb

	* level-0/PPC/ppc-numbers.lisp: Fake %NEXT-RANDOM-SEED for ppc64.

2005-06-03 08:37  gb

	* level-0/PPC/ppc-misc.lisp: Lots of fixes in 64-bit code.

2005-06-03 08:35  gb

	* level-0/PPC/ppc-float.lisp: Move some stuff used to do integer
	truncation elsewhere.

2005-06-03 08:32  gb

	* lib/compile-ccl.lisp: All PPC targets seem to have the same set
	of level-1 modules.  Compile target-xdev modules when
	cross-compiling.  Bind *TARGET-BACKEND* when cross-compiling, so
	that macros that use TARGET-ARCH-CASE or similar dtrt.

2005-06-03 08:30  gb

	* lib/nfcomp.lisp: Comment/formatting changes only.

2005-06-03 08:29  gb

	* lib/number-macros.lisp: Small bignums have two (32-bit) words on
	PPC64.

2005-06-03 08:28  gb

	* lib/pprint.lisp: No more *FRED-SPECIAL-INDENT-ALIST*.  (Might
	someday want something similar.)

2005-06-03 08:27  gb

	* lib/prepare-mcl-environment.lisp: Word size issues, target
	package.

2005-06-03 08:26  gb

	* xdump/: xfasload.lisp, xppcfasload.lisp: Multiple subdirs.

2005-06-03 08:24  gb

	* lisp-kernel/spentry.s: Lots of bug fixes, 64-bit changes.

2005-06-03 08:22  gb

	* lisp-kernel/ppc_print.c: Fix character printing (use
	charcode_shift), NIL printing on PPC64.

2005-06-03 08:21  gb

	* lisp-kernel/pmcl-kernel.c: Disable EGC on PPC64, until it works.

2005-06-03 08:20  gb

	* lisp-kernel/plbt.c: Print addresses with "l" qualifier.

2005-06-03 08:19  gb

	* lisp-kernel/lisp-exceptions.h: Quiet breakpoint trap, start to
	abstract 64-bit traps.

2005-06-03 08:18  gb

	* lisp-kernel/lisp-exceptions.c: Suppress warnings when mapping
	between TCRs and exception ports.  Recognize "quiet"
	lisp-breakpoints (no possibility of C-string messages, no changes
	to LR/PC, etc.)

2005-06-03 08:16  gb

	* lisp-kernel/lisp-debug.c: Start to learn about 64-bit traps, use
	%lx (etc) when printing 64-bit values.

2005-06-03 08:14  gb

	* library/lispequ.lisp: Comments, formatting changes.

2005-06-03 08:12  gb

	* level-0/PPC/: PPC32/.cvsignore, PPC32/l0-bignum-ppc32.lisp,
	PPC32/ppc32-bignum.lisp, PPC64/.cvsignore,
	PPC64/l0-bignum-ppc64.lisp, PPC64/ppc64-bignum.lisp: New file.

2005-06-03 08:11  gb

	* level-0/PPC/ppc-def.lisp: Lots of word-size and other ppc64
	changes.

2005-06-03 08:10  gb

	* level-0/PPC/ppc-array.lisp: Implement %extend-vector for ppc64.

2005-06-03 08:09  gb

	* level-0/nfasload.lisp: Lots-o-changes.

2005-06-03 08:08  gb

	* level-0/l0-utils.lisp: Use target package prefix.

2005-06-03 08:04  gb

	* level-0/l0-symbol.lisp: Very minor change in %ENSURE-SVAR.

2005-06-03 08:03  gb

	* level-0/l0-pred.lisp: %TYPE-OF for PPC64.

2005-06-03 08:02  gb

	* level-0/l0-numbers.lisp: target-package, some minor changes.

2005-06-03 08:01  gb

	* level-0/l0-init.lisp: Some cleanup/conditionalization of
	*FEATURES*.

2005-06-03 08:00  gb

	* level-0/l0-hash.lisp: Don't do unsafe fixnum arithmetic to
	"mixup" or "rotate" hash codes on ppc64.

2005-06-03 07:59  gb

	* level-0/l0-float.lisp: Fix a few typos.

2005-06-03 07:57  gb

	* level-0/: PPC/ppc-bignum.lisp, l0-bignum.lisp: Move functionality
	into target-specific subdirectory.

2005-06-03 07:52  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: Lots of fixes, more
	consistent use of 64-bit rotates/shifts.

2005-06-03 07:50  gb

	* compiler/PPC/PPC64/ppc64-backend.lisp: Only require PPC64-VINSNS
	if we're the native target.  Change the Darwin architecture
	identifier.

2005-06-03 07:49  gb

	* compiler/PPC/PPC32/ppc32-backend.lisp: Only require PPC32-VINSNS
	if we're the native target.

2005-06-03 07:48  gb

	* compiler/PPC/ppc2.lisp: Some 64-bit fixes.

2005-06-03 07:47  gb

	* compiler/PPC/ppc-lapmacros.lisp: BKPT trap; a few fixes
	(including 64-bit INT-TO-FREG.)

2005-06-03 07:45  gb

	* compiler/PPC/ppc-asm.lisp: CLRLSLDI[.] had arguments inverted.

2005-06-03 07:45  gb

	* compiler/optimizers.lisp: SYMBOLP.

2005-06-03 07:43  gb

	* compiler/nx0.lisp: NX-BINARY-FIXNUM-OP-P is sensitive to target
	fixnum size.

2005-05-27 14:44  gb

	* level-1/version.lisp: 050527a.

2005-05-27 14:43  gb

	* lisp-kernel/: constants.h, constants.s: rcontext defined
	per-architecture.

2005-05-27 14:43  gb

	* lisp-kernel/: constants32.s, constants32.h: rcontext = r13.

2005-05-27 14:41  gb

	* lisp-kernel/: constants64.s, constants64.h: rcontext = r2.  Fix
	several typos/inconsistencies.

2005-05-27 14:40  gb

	* lisp-kernel/lisp-debug.c: Print wide registers (needs some
	tweaking.)

2005-05-27 14:38  gb

	* lisp-kernel/lisp-exceptions.c: Word-size fixes; preserve r13 when
	setting up pseudo-signal trampoline on ppc64.

2005-05-27 14:37  gb

	* lisp-kernel/lisp-exceptions.h: Define ALLOCPTR_TRAP for PPC64.

2005-05-27 14:36  gb

	* lisp-kernel/m4macros.m4: Use .machine directive in _beginfile. 
	Define stack-frame-type equates.

2005-05-27 14:34  gb

	* lisp-kernel/macros.s: header_length looks at all of the bits, as
	does extract_unsigned_byte_bits_.

2005-05-27 14:33  gb

	* lisp-kernel/plbt.c: Use dlsym() on Darwinppc64; print wide
	addresses on ppc64.

2005-05-27 14:32  gb

	* lisp-kernel/pmcl-kernel.c: Remap the subprims jump table on
	Darwinppc64

2005-05-27 14:31  gb

	* lisp-kernel/ppc_print.c: Print "natural-sized" integers.

2005-05-27 14:23  gb

	* lisp-kernel/spentry.s: Lots of word-size fixes, flesh out
	misc-set, deal with Tiger ld64/as64 alignment crap.  (Filed a bug.)

2005-05-27 14:22  gb

	* lisp-kernel/spjump.s: Add, export labels, so that we can work
	around Tiger ld64 lossage.

2005-05-27 14:21  gb

	* lisp-kernel/subprims.s: Use lwz to load each half of fp
	conversion constant.  (Hmmm.  May need another constant for 64-bit
	conversions.)

2005-05-27 14:19  gb

	* level-0/: l0-aprims.lisp, l0-array.lisp, l0-cfm-support.lisp,
	l0-def.lisp, l0-hash.lisp, l0-misc.lisp, l0-numbers.lisp,
	l0-pred.lisp, l0-symbol.lisp, l0-utils.lisp, nfasload.lisp,
	PPC/ppc-array.lisp, PPC/ppc-def.lisp, PPC/ppc-float.lisp,
	PPC/ppc-io.lisp, PPC/ppc-misc.lisp, PPC/ppc-numbers.lisp,
	PPC/ppc-pred.lisp, PPC/ppc-symbol.lisp, PPC/ppc-utils.lisp: Lots of
	word-size/tagging conditionalization.

2005-05-27 14:18  gb

	* level-1/ppc-trap-support.lisp: PPC-LAP-WORD (this version, at
	least ...) accounts for code-vector prefix.

2005-05-27 14:17  gb

	* level-1/: l1-boot-2.lisp, level-1.lisp: Load 64-bit fasls.

2005-05-27 14:16  gb

	* lib/nfcomp.lisp: Fix constant handling, slightly.

2005-05-27 14:16  gb

	* xdump/xppcfasload.lisp: Handle code-vectors more portably.

2005-05-27 14:15  gb

	* xdump/xfasload.lisp: A few word-size fixes; show addresses of
	cold-load functions, for debugging.

2005-05-27 14:14  gb

	* lisp-kernel/darwin64/Makefile: Give up (for the time being) on
	the notion of getting Apple's ld64 to do anything useful.

2005-05-27 14:12  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: Bugs.

2005-05-27 14:11  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp: rcontext = r2.  Not TCR bias;
	no low words in TCR def.  Fix kernel-global, nrs-offset.

2005-05-27 14:10  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp: SCALE-NODE-MISC-OFFSET.

2005-05-27 14:09  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp: rcontext = r13 for ppc32.

2005-05-27 14:08  gb

	* compiler/PPC/ppc2.lisp: fix lots of word-size assumptions in
	stack-unwinding, lambda-list processing.

2005-05-27 14:07  gb

	* compiler/PPC/ppc-lapmacros.lisp: rcontext is target-dependent fix
	int-to-freg for ppc64.

2005-05-27 14:05  gb

	* compiler/PPC/ppc-arch.lisp: r2, r16: usage is target-dependent.
	(Need to tell disassembler about this.)

2005-05-24 00:04  gb

	* lisp-kernel/linux/elf32ppclinux.x: Move image up a page.

2005-05-24 00:03  gb

	* level-1/l1-numbers.lisp: Fix botched #+ conditionalization.

2005-05-24 00:01  gb

	* lib/nfcomp.lisp, xdump/faslenv.lisp: Increment FASL version.

2005-05-24 00:00  gb

	* lisp-kernel/spjump.s: Don't pad jump table by extra page; revert
	to pc-relative branches.

2005-05-24 00:00  gb

	* lisp-kernel/pmcl-kernel.c: Don't copy spjump table anymore.

2005-05-23 23:59  gb

	* lisp-kernel/darwin/Makefile: Adjust image start address.

2005-05-23 23:36  gb

	* level-1/version.lisp: New binaries soon.

2005-05-23 23:29  gb

	* xdump/: heap-image.lisp, xfasload.lisp, xppcfasload.lisp: 64-bit
	xloader, cross-xloader.  New image header stuff for PPC64.

2005-05-23 23:28  gb

	* lisp-kernel/darwin64/Makefile: Mach Header too far away from old
	spjump address, so we'll have to move the spjump table.

2005-05-23 23:28  gb

	* lisp-kernel/pmcl-kernel.c: Duplicate the subprims jump table
	(bootstrapping kludge.)
	
	Observe word size when vpushing initial function.

2005-05-23 23:26  gb

	* lisp-kernel/macros.s: Use STRU when allocating TSP frames.

2005-05-23 23:25  gb

	* lisp-kernel/spentry.s: Fix bignum boxing for __ifdef([PPC64])
	case.

2005-05-23 23:24  gb

	* lisp-kernel/spjump.s: Do absolute jumps, to make relocation of
	the jump table itself simpler.

2005-05-23 23:24  gb

	* lisp-kernel/lisp_globals.h: Remove some very old stuff.

2005-05-23 23:23  gb

	* lisp-kernel/lisp-exceptions.c: Fix at least one Mach
	exception-handling case.

2005-05-23 23:22  gb

	* lisp-kernel/image.h: Allow loading 64-bit images.

2005-05-23 23:21  gb

	* lisp-kernel/image.c: Load PPC64 images.

2005-05-23 23:21  gb

	* lisp-kernel/constants64.s: Fix t_offset def.	Align TCR fields
	correctly.

2005-05-23 23:20  gb

	* lisp-kernel/area.h: area_codes are native fixnums.

2005-05-23 23:20  gb

	* lib/numbers.lisp: Call non-destructive single-float stuff on
	ppc64.

2005-05-23 23:19  gb

	* lib/nfcomp.lisp: Fix compile-time compilation (env/function name
	screwup).  Fasdump bignums using new fasl-op.

2005-05-23 23:17  gb

	* lib/backtrace.lisp: FIND-LOCAL-NAME: fix some incorrect
	stack-frame layout assumptions.

2005-05-23 23:15  gb

	* level-0/: l0-array.lisp, l0-float.lisp, l0-numbers.lisp,
	l0-pred.lisp, PPC/ppc-float.lisp, PPC/ppc-hash.lisp,
	PPC/ppc-misc.lisp, PPC/ppc-numbers.lisp, PPC/ppc-pred.lisp,
	PPC/ppc-symbol.lisp: Lots of #+ppc64 bug fixes and
	conditionalization.

2005-05-23 23:14  gb

	* level-1/l1-numbers.lisp: More non-destuctive short/single-float
	stuff.

2005-05-23 23:14  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: LOAD-DOUBLE-FLOAT-CONSTANT
	in 2 32-bit halves.

2005-05-23 23:13  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp: Double-float -cell indices.

2005-05-23 23:12  gb

	* compiler/PPC/ppc2.lisp: Renamed syscall stuff.

2005-05-23 23:12  gb

	* compiler/PPC/ppc-lapmacros.lisp: SINGLE-FLOAT-CONVERT: use TCR.
	prefix.

2005-05-23 23:11  gb

	* compiler/subprims.lisp: Subprims jump table moved from 0x4000 to
	0x5000 (at the moment, it's both places.)

2005-05-23 23:10  gb

	* compiler/nxenv.lisp: Rename syscall operators.

2005-05-23 23:10  gb

	* compiler/nx1.lisp: Use (new, renamed) POWEROPEN-SYSCALL for both
	PPC64 platforms.

2005-05-23 23:08  gb

	* compiler/arch.lisp: Define more error/UUO codes.

2005-05-20 07:38  gb

	* level-1/version.lisp: 050520b.

2005-05-20 07:38  gb

	* level-0/l0-io.lisp, level-1/l1-sockets.lisp,
	level-1/l1-streams.lisp, level-1/linux-files.lisp,
	lib/foreign-types.lisp, library/darwin-syscalls.lisp,
	library/linux-syscalls.lisp, library/syscall.lisp: System calls
	defined in OS-specific hash tables, not in the FTD.  System call
	indices are in the "SYSCALLS" package, not "OS".  (These changes
	make it a little easier to cross-compile between different
	architectures on the same OS, and perhaps a little more awkward to
	cross-compile between OSes.)

2005-05-20 04:18  gb

	* lib/macros.lisp: TARGET-OS-CASE.

2005-05-20 03:26  gb

	* level-1/l1-aprims.lisp: OS is now a nickname for the
	platform-specific package.
	
	Remove %COERCE-TO-UVECTOR. Whatever it was ...

2005-05-20 03:23  gb

	* level-1/l1-clos-boot.lisp: Fix typos in code which initializes
	ppc64 class table.

2005-05-20 03:22  gb

	* level-1/l1-numbers.lisp: Avoid "consing"
	single-floats/destructive operations on single-floats on PPC64.

2005-05-20 03:21  gb

	* level-1/l1-pathnames.lisp: setup CCL pathname translations for
	64-bit fasls.

2005-05-20 03:20  gb

	* level-1/l1-sockets.lisp: htonl, ntohs, etc. may not be defined in
	Tiger header files (and are no-ops on big-endian machines, anyway.)
	 Use lisp macros to remind ourselves that there may be byte-order
	issues here, someday.

2005-05-20 03:19  gb

	* level-1/l1-streams.lisp: Conditionalize MAKE-HEAP-IVECTOR.

2005-05-20 03:18  gb

	* level-1/version.lisp: 050520a.

2005-05-20 03:17  gb

	* lib/compile-ccl.lisp: CROSS-COMPILE-CCl.  A lot of the stuff in
	this file is way too complicated (left over from 68k->PPC MCL
	bootstrapping a long time ago); there were and may still be some
	duplicate function definitions and other nonsense here.

2005-05-20 03:15  gb

	* lib/db-io.lisp: Allow "the wrong target" to open .cdb files (as
	needs to be done during cross-compilation.)  Need a better
	solution/scheme here, to prevent this from happening by accident.

2005-05-20 03:13  gb

	* lib/foreign-types.lisp: Don't use the :PRINT-OBJECT DEFSTRUCT
	option (just define a couple of methods.)

2005-05-20 03:12  gb

	* lib/nfcomp.lisp: Some cross-compilation infrastructure.  Careful
	about references to 64-bit array types when cross-compiling.

2005-05-20 03:10  gb

	* lib/numbers.lisp: Avoid using %MAKE-SFLOAT/destructive
	single-float operations on ppc64.

2005-05-20 03:09  gb

	* lib/sequences.lisp: Fix #+ppc64-target typos in
	SIMPLE-1D-ARRAY-SUBSEQ.

2005-05-20 03:08  gb

	* library/parse-ffi.lisp: Make the target argument &optional, not
	&key.  Install the target backend while we're parsing, so that .cdb
	files will have the right signature even if they're cross-compiled.

2005-05-20 03:03  gb

	* library/syscall.lisp: Don't map arg/result types to
	representation types here (now happens in compiler frontend).

2005-05-20 02:59  gb

	* level-0/l0-float.lisp: FSQRT: do the single-float case
	non-destructively on PPC64.

2005-05-20 02:58  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: u32-shift-* ->
	natural-shift-*, and some other fixes...

2005-05-20 02:57  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp: u32-shift-* ->
	natural-shift-*.

2005-05-20 02:56  gb

	* compiler/optimizers.lisp: listp: don't expand into references to
	the gensym on ppc64.

2005-05-20 02:55  gb

	* level-0/.cvsignore, level-0/PPC/.cvsignore, library/.cvsignore,
	tools/.cvsignore: Ignore more kinds of fasl files.

2005-05-20 02:49  gb

	* bindarwin/.cvsignore, .cvsignore, l1-dfsls/.cvsignore: Ignore
	more kinds of fasl files.

2005-05-20 02:47  gb

	* compiler/nx1.lisp: Map syscall arg/result types to representation
	types here.

2005-05-19 02:02  gb

	* lib/compile-ccl.lisp: Compiler backend stuff.

2005-05-19 02:02  gb

	* lib/foreign-types.lisp: Record types passed by address on Linux
	(and any other sane ABI.) Integer encoding is in natural-sized
	words (32/64) when ABI is not sane.

2005-05-19 02:00  gb

	* library/darwin-syscalls.lisp: A few things (at least a few of
	those that we know about) take/return :LONG or :UNSIGNED-LONG.

2005-05-19 01:59  gb

	* library/syscall.lisp: Pass args/results through
	FOREIGN-TYPE-TO-REPRESENTATION-TYPE (to handle things like :LONG,
	etc.)

2005-05-19 01:58  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: Fix UNBOX-S32.

2005-05-19 01:58  gb

	* compiler/PPC/ppc2.lisp: :signed/unsigned-HALFword.

2005-05-18 23:35  gb

	* compiler/nx.lisp: Remove FORMAT call.

2005-05-18 23:17  gb

	* compiler/PPC/ppc2.lisp: Fix parenthesization in
	PPC2-POWEROPEN-FOREIGN-ARGS.

2005-05-18 23:10  gb

	* darwin-headers64/libc/C/populate.sh: Don't warn about tokens
	after #endif.  (Don't know how to suppress warnings about tokens
	after #include <foo>.)
	
	Don't pre-include float.h in limits.h

2005-05-18 23:07  gb

	* compiler/PPC/ppc2.lisp: ppc64 changes in poweropen-ffi-arglist
	stuff.

2005-05-18 23:01  gb

	* compiler/nx1.lisp: Pretend that :darwinppc64/:linuxppc64 targets
	follow PowerOpen ABI, which is kind of half-right, at least.

2005-05-18 23:00  gb

	* compiler/nx.lisp: XCOMPILE-LAMBDA binds target-ftd.

2005-05-18 22:59  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: Fix eep.address.

2005-05-18 22:56  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: No more
	PPC64::ONE-DIGIT-BIGNUM-HEADER; fix a few things that thought that
	there was.

2005-05-18 22:55  gb

	* compiler/PPC/ppc2.lisp: New PPC2-UNBOXED-INTEGER-ARG-TO-REG.

2005-05-18 20:07  gb

	* lib/db-io.lisp: CDB-OPEN creates a CDB structure (which may have
	a null FID); %CDB-GET does nothing if the FID is null.	(This is
	intended to avoid repeated attempts to open a missing .cdb file, as
	when populating an interface directory for the first time.)

2005-05-18 20:04  gb

	* library/parse-ffi.lisp: Handle 128-bit integers here.  (Well,
	they aren't really handled anywhere, but we should at least
	recognize the data types.)

2005-05-18 19:05  gb

	* compiler/PPC/ppc2.lisp: Fix missing close-paren.

2005-05-18 19:01  gb

	* lisp-kernel/lisp-exceptions.h: a 64-bit opcode or two.

2005-05-18 19:00  gb

	* lisp-kernel/constants64.s: Bignum header constants.

2005-05-18 19:00  gb

	* level-0/PPC/ppc-array.lisp: %init-misc for PPC64.

2005-05-18 18:59  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: fix copy/past bug in
	box-u8.

2005-05-18 18:59  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp: 2, 3 digit bignum headers are
	interesting; 1 (32-bit) digit headers don't exist.

2005-05-18 18:57  gb

	* compiler/PPC/ppc2.lisp: a bit more ppc64 conditionaliztion. 
	(This is probably pretty close to complete - modulo 64-bit ivectors
	- but probably pretty buggy.)

2005-05-18 18:55  gb

	* compiler/PPC/ppc-lapmacros.lisp: extract-unsigned-byte-bits. for
	PPC64.

2005-05-18 00:58  gb

	* lib/ccl-export-syms.lisp, level-1/l1-utils.lisp: Remove some more
	old/unreferenced stuff.

2005-05-18 00:58  gb

	* level-1/version.lisp: 050518a, since it's reasonable to assume
	that there will be more than 1-per-day.

2005-05-18 00:48  gb

	* xdump/xsym.lisp: no longer 1994

2005-05-18 00:44  gb

	* level-1/l1-utils.lisp: Lose some more old stuff.

2005-05-18 00:38  gb

	* lisp-kernel/spentry.s: Kinder, gentler .SPgetxlong (u32/s32
	only.)

2005-05-18 00:38  gb

	* library/lispequ.lisp: Remove some unused foreign struct
	definitions; make PTASKSTATE an istruct.

2005-05-18 00:37  gb

	* lib/foreign-types.lisp: All (lisp-level) foreign structs defined
	per-ftd.

2005-05-18 00:37  gb

	* lib/describe.lisp: Don't try to describe exception frames ...

2005-05-18 00:37  gb

	* lib/ccl-export-syms.lisp: Export STREAM-DEVICE; don't export some
	old MCL stuff, %PUT-* functions.

2005-05-18 00:35  gb

	* lib/db-io.lisp: Move foreign struct definitions elsewhere.

2005-05-18 00:34  gb

	* lib/level-2.lisp: Don't eval-redef %put-* functions.

2005-05-18 00:34  gb

	* level-1/l1-lisp-threads.lisp: Don't mess with stack overflow
	limits on new stacks.

2005-05-18 00:33  gb

	* level-1/l1-events.lisp: PTASKSTATE is now an istruct.

2005-05-18 00:33  gb

	* compiler/PPC/: PPC32/ppc32-vinsns.lisp, PPC64/ppc64-vinsns.lisp:
	New memory access stuff.

2005-05-18 00:32  gb

	* compiler/PPC/ppc-disassemble.lisp: Recognize LA to TSP.

2005-05-18 00:32  gb

	* compiler/: nx1.lisp, PPC/ppc2.lisp: Drop old (undocumented,
	problematic) %PUT-* memory update functions.  Try to handle some
	64-bit memory reference/assignments, make encoding a little more
	sane.

2005-05-18 00:30  gb

	* compiler/nx.lisp: Enable vinsn debugging in XCOMPILE-LAMBDA.

2005-05-18 00:30  gb

	* compiler/backend.lisp: Recognize :SIGNED-NATURAL alias, as well.

2005-05-17 09:20  gb

	* library/solaris-records.lisp: old old file

2005-05-17 08:43  gb

	* library/parse-ffi.lisp: change target ftd arg handling

2005-05-17 07:22  gb

	* lib/foreign-types.lisp: Arrgh.

2005-05-17 07:18  gb

	* darwin-headers64/libc/: .cvsignore, C/.cvsignore: new files.

2005-05-17 07:16  gb

	* darwin-headers64/libc/C/populate.sh: new file; generates some
	warnings.

2005-05-17 07:12  gb

	* headers64/libc/: C/.cvsignore, .cvsignore: new files.

2005-05-17 07:11  gb

	* headers64/libc/C/populate.sh: New file; use Fedora Core 4 test 3
	headers.

2005-05-17 07:10  gb

	* compiler/PPC/: PPC32/ppc32-backend.lisp,
	PPC64/ppc64-backend.lisp: make & install foreign type data for
	non-native backends.

2005-05-17 07:09  gb

	* lib/foreign-types.lisp: Straighten out :void type identity.

2005-05-17 05:05  gb

	* lib/db-io.lisp: Pass the ftd around, mostly so that we can
	determine the (ftd-specific/ target-specific) size of a pointer.

2005-05-17 04:44  gb

	* lib/foreign-types.lisp: fix linux typo.

2005-05-17 04:44  gb

	* level-1/version.lisp: um, 050517b.

2005-05-17 04:32  gb

	* lib/foreign-types.lisp: Get GETF arg order right.  Set
	long/pointer type sizes based on :bits-per-word.

2005-05-17 04:32  gb

	* lib/db-io.lisp, library/parse-ffi.lisp: Get GETF arg order right
	...

2005-05-17 03:48  gb

	* library/parse-ffi.lisp: ftd-attributes is now a plist; use its
	:bits-per-word key to determine bit size of primitive :long,
	:unsigned-long types.

2005-05-17 03:45  gb

	* lib/db-io.lisp: Pass the target ftd around a bit more, but that's
	probably hopeless.  ftd-attributes is now a plist.

2005-05-17 03:44  gb

	* lib/foreign-types.lisp: Conditionalize more; pass the target ftd
	around a bit more, but that's probably hopeless.  Type translators
	are ftd-specific after all; basic types get installed per-ftd. 
	ftd-attributes is now a plist.

2005-05-17 01:32  gb

	* level-1/version.lisp: Bump  version.

2005-05-17 01:31  gb

	* xdump/faslenv.lisp, lib/nfcomp.lisp: Bump fasl version.

2005-05-17 01:04  gb

	* lib/foreign-types.lisp: Lose ftype-info/ordinal stuff.  (Causes
	bootstrapping problems, as does its removal.)
	
	Primitive types (translators) are global, not per-ftd.

2005-05-17 01:02  gb

	* level-1/l1-io.lisp: WRITE-A-MACPTR: no ftype info.

2005-05-16 22:29  gb

	* lisp-kernel/spentry.s: fix typos.

2005-05-16 22:10  gb

	* lisp-kernel/spentry.s: Define a lot of PPC64 stuff.

2005-05-16 22:10  gb

	* lisp-kernel/constants64.s: Migrate builtin_function indices,
	fpscr bits to constants.s.  Add lowtag defs.  Fix double-float
	struct.

2005-05-16 22:09  gb

	* lisp-kernel/constants32.s: Migrate builtin_function indices,
	fpscr bits to constants.s.

2005-05-16 22:09  gb

	* lisp-kernel/constants.s: Migrate builtin_function indices, fpscr
	bits here from arch-specific files.

2005-05-16 22:08  gb

	* lisp-kernel/pmcl-kernel.c: Work around lack of
	<asm-ppc64/cputable.h>

2005-05-16 22:07  gb

	* lisp-kernel/macros.s: extract_lowtag for PPC64.

2005-05-16 22:07  gb

	* lisp-kernel/: errors.s, lisp-errors.h: Add
	error_object_not_unsigned_byte_56.

2005-05-16 22:03  gb

	* lib/foreign-types.lisp: Target packages, interface dirs.

2005-05-16 22:03  gb

	* lib/db-io.lisp: Don't garble error messages when checking
	trailer.

2005-05-16 22:02  gb

	* level-1/l1-aprims.lisp: Rename OS package.

2005-05-16 22:02  gb

	* compiler/PPC/: PPC32/ppc32-vinsns.lisp, PPC64/ppc64-vinsns.lisp:
	Try to distinguish between referencing fullwords and "natural"
	words in memory.

2005-05-16 22:02  gb

	* compiler/PPC/ppc2.lisp: Don't dereference pointers more than once
	(old %HGET stuff.) Try to distinguish between referencing fullwords
	and "natural" words in memory.

2005-05-16 22:00  gb

	* compiler/PPC/ppc-disassemble.lisp: Recognize a few more
	operations.

2005-05-16 21:59  gb

	* compiler/nx1.lisp: %SET-SINGLE-FLOAT is ppc32-specific.  Don't
	dereference pointers more than once (old %HGET stuff.)

2005-05-15 05:29  gb

	* level-1/version.lisp: Bump; new binaries soon.

2005-05-15 05:29  gb

	* compiler/nx.lisp, compiler/nx1.lisp, compiler/PPC/ppc2.lisp,
	lib/nfcomp.lisp: Lose old, obsolet LFUN-MAKER argument.  May need
	to use XCOMPILE-CCL to bootstrap.

2005-05-15 01:18  gb

	* examples/objc-clos.lisp: Shift in the right direction when
	converting bit- to byte-offsets.

2005-05-15 01:18  gb

	* lib/nfcomp.lisp: Default to *target-backend* (need to re-think
	some of this), use new (more specialized) fasl ops.

2005-05-15 01:16  gb

	* xdump/xfasload.lisp: XLOAD-DNODE-ALIGN: always account for
	header.

2005-05-15 01:15  gb

	* level-0/PPC/ppc-def.lisp: Change an STW to an STR.

2005-05-15 01:15  gb

	* level-0/l0-pred.lisp: A few target-package changes, comments,
	indentation.

2005-05-15 01:14  gb

	* compiler/PPC/: PPC32/ppc32-arch.lisp, PPC64/ppc64-arch.lisp: Add
	vector/array headers to target-uvector alist.

2005-05-15 00:39  gb

	* level-0/nfasload.lisp: Recognize new fasl operators (specialized
	uvector/array types.)

2005-05-15 00:38  gb

	* xdump/: xfasload.lisp, xppcfasload.lisp: More fasl operators, for
	specialized array types.  Remove some (very) old code/concepts.

2005-05-15 00:38  gb

	* xdump/faslenv.lisp: More fasl operators, for specialized array
	types.

2005-05-14 17:18  gb

	* xdump/xsparcfasload.lisp: very old, irrelevant

2005-05-13 14:50  gb

	* lisp-kernel/spentry.s: Fix typo in makeu64.

2005-05-13 04:21  gb

	* compiler/PPC/ppc2.lisp: U32/natural changes, start handling
	64-bit register copies.

2005-05-13 04:20  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp: misc byte-count stuff.

2005-05-13 04:19  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: rename most u32 operations
	to "natural" ones.  Handle some of them, as well as some u64/s64
	boxing/unboxing operations.

2005-05-13 04:18  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp: rename most u32 operations
	to "natural" ones.

2005-05-13 04:18  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp: Implement byte-count stuff.

2005-05-13 04:17  gb

	* compiler/nx1.lisp: u32/natural changes.

2005-05-13 04:16  gb

	* compiler/nx0.lisp: Recognize "natural" constants and operands, as
	well as U32 ones.

2005-05-13 04:15  gb

	* compiler/nxenv.lisp: Change most *u32* operator names to
	*natural*.

2005-05-13 04:14  gb

	* compiler/vinsn.lisp: FIXUP-VINSN-TEMPLATE: account for the
	possibility that some (target-specific) vinsn templates may be
	missing.

2005-05-13 04:13  gb

	* compiler/vreg.lisp: Note when vinsn parameters/results have modes
	:s64/:u64, to prevent the corresponding registers from being used
	as temps.

2005-05-13 04:12  gb

	* compiler/backend.lisp: Accept :NATURAL as an alias for an
	unsigned "natural width" (32/64-bit) integer.
	
	AVAILABLE-IMM-TEMP defaults mode to :NATURAL, as does the
	WITH-IMM-TARGET macro.

2005-05-13 04:10  gb

	* compiler/arch.lisp: Architecture-specific
	ARRAY-DATA-SIZE-FUNCTION.

2005-05-13 04:09  gb

	* examples/objc-runtime.lisp: Skip the library version checks (at
	least in theory, the only classes/foreign methods we believe in are
	those described by the interface files.)
	
	Make %MLIST-CONTAINING force canonicaliazation of class pointers
	when updating message signature tables.

2005-05-13 04:07  gb

	* examples/bridge.lisp: UPDATE-TYPE-SIGNATURES-FOR-METHOD
	optionally canonicalizes the class, so that references to
	user-defined classes in method descriptor tables get revived when a
	saved image is restarted.

2005-05-13 04:05  gb

	* level-0/PPC/ppc-def.lisp: %FIXNUM-REF-U32 -> %FIXNUM-REF-NATURAL,
	and other 32/64-bit changes.

2005-05-13 04:04  gb

	* level-1/: ppc-threads-utils.lisp, l1-lisp-threads.lisp:
	%FIXNUM-REF-U32 -> %FIXNUM-REF-NATURAL.

2005-05-13 04:04  gb

	* lisp-kernel/spentry.s: fix some 32/64-bit boxing stuff.

2005-05-13 04:02  gb

	* level-1/version.lisp: 050513.

2005-05-11 23:10  gb

	* lisp-kernel/subprims.s: save/load NVRs without using stmw/lmw
	(since there aren't 64-bit equivalents.) use new __ifdef mechanism
	(old mechanism interfered with source line number scheme.)

2005-05-11 23:10  gb

	* lisp-kernel/spentry.s: save/load NVRs without using stmw/lmw
	(since there aren't 64-bit equivalents.) use new __ifdef mechanism
	(old mechanism interfered with source line number scheme.) A little
	bit of __ifdef([PPC64]) stuff works.

2005-05-11 23:06  gb

	* lisp-kernel/macros.s: save/load NVRs without using stmw/lmw
	(since there aren't 64-bit equivalents.)

2005-05-11 23:05  gb

	* lisp-kernel/m4macros.m4: New __ifdef mechanism.

2005-05-11 23:04  gb

	* lisp-kernel/constants64.s: min_array_subtag, min_vector_subtag.

2005-05-11 23:04  gb

	* lisp-kernel/constants.s: Enumerate all NVR names.  Apple's
	assembler sucks.

2005-05-11 23:03  gb

	* lisp-kernel/: asmutils.s, imports.s: Use new __ifdef mechanism.

2005-05-11 23:03  gb

	* examples/objc-support.lisp: Provide a more ... descriptive
	description for lisp exceptions.

2005-05-11 23:02  gb

	* examples/objc-runtime.lisp: Declare a few more private classes,
	for document load/save.  Need a better long-term solution,
	obviously.

2005-05-11 23:01  gb

	* examples/cocoa-editor.lisp: Don't call CCL::DBG on duplicate
	Hemlock buffer names.
	
	Disable "smart insertion and deletion"; apparently, this has
	something to do with frameworks.
	
	Turn on backup files, which would be named "foo~.lisp".  Not sure
	how easy this is to change.

2005-05-11 22:59  gb

	* examples/bridge.lisp: Failures in OBJC-CLASS-OF are often
	spurious, but we really shouldn't be asking this question in a lot
	of cases.  When #+debug, try to print the object's class name, so
	that we can special-case it.

2005-05-11 22:14  gb

	* examples/bridge.lisp: Remove a DBG trap; don't TIME the call to
	import method type signatures.

2005-05-11 22:04  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp: Be more careful to
	distinguish between (ARRAY *) and (ARRAY T) cases.  Treat
	DOUBLE-FLOAT objects as if they consisted of 2 32-bit elements.

2005-05-11 22:04  gb

	* compiler/optimizers.lisp: Use TARGET-ARCH-CASE; try to simplify
	simple MAKE-ARRAY calls

2005-05-11 22:03  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp: Be more careful to
	distinguish between (ARRAY *) and (ARRAY T) cases.

2005-05-11 22:02  gb

	* level-0/l0-numbers.lisp: Don't use
	WITH-STACK-SHORT-FLOATS/destuctive sfloat operations on PPC64.

2005-05-11 22:01  gb

	* level-0/l0-float.lisp: Changes for immediate single/short floats
	on ppc64.

2005-05-11 22:00  gb

	* level-0/PPC/ppc-def.lisp: Remove a comment.

2005-05-11 22:00  gb

	* level-0/PPC/ppc-float.lisp: Add #\Newline at EOF.

2005-05-11 21:59  gb

	* level-1/l1-aprims.lisp: %PASCAL-FUNCTIONS% starts out a little
	bigger.

2005-05-11 21:58  gb

	* level-1/l1-callbacks.lisp: DELETE-PASCAL-FUNCTION, be a little
	more careful about assumptions that PFEs are named/named globally.

2005-05-11 21:57  gb

	* level-1/l1-utils.lisp: %MAKE-SIMPLE-ARRAY.

2005-05-11 21:57  gb

	* level-1/ppc-callback-support.lisp: Make shorter trampolines (use
	absolute branches.)

2005-05-11 21:56  gb

	* level-1/version.lisp: 050511.

2005-05-11 21:56  gb

	* lib/number-macros.lisp: Use TARGET-ARCH-CASE in most macros.

2005-05-11 21:55  gb

	* lib/numbers.lisp: Some non-destructive SINGLE/SHORT-FLOAT stuff
	for PPC64.

2005-05-11 21:54  gb

	* lib/sequences.lisp: Comment indentation.

2005-05-11 21:54  gb

	* lib/number-case-macro.lisp: Use architecture-specific
	NUMERIC-TYPE-NAME-TO-TYPECODE-FUNCTION.

2005-05-11 21:54  gb

	* compiler/arch.lisp: NUMERIC-TYPE-NAME-TO-TYPECODE-FUNCTION.

2005-05-10 20:47  gb

	* lib/format.lisp: Don't revert to standard float printer if MARKER
	argument provided, in FORMAT-EXP-AUX.

2005-05-10 13:16  gb

	* level-1/version.lisp: Bump.

2005-05-10 13:16  gb

	* level-0/l0-float.lisp: Use ! to indicate destructive operation in
	LOG-E.

2005-05-10 13:16  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp: Bring back (and
	comment-out) the old %ILSR-C vinsn, just in case (I had some
	problems reading float contants around the time that the previous
	change was made; I was messing with how shift operations were
	compiled at the time, and the problem may have been elsewhere. 
	Just in case.)

2005-05-10 12:45  gb

	* lisp-kernel/asmutils.s: conditionalize count_leading_zeros,
	conditional loads/stores.

2005-05-10 12:44  gb

	* lisp-kernel/: constants32.s, constants.s: New scheme for
	assembler kernel globals.

2005-05-10 12:43  gb

	* lisp-kernel/constants64.h: Move SUBTAG_CHARACTER.

2005-05-10 12:42  gb

	* lisp-kernel/constants64.s: Move SUBTAG_CHARACTER.  New scheme for
	assembler kernel globals.

2005-05-10 12:39  gb

	* lisp-kernel/macros.s: CLEAR_ALLOC_TAG: parenthesize operands.

2005-05-10 12:39  gb

	* lisp-kernel/lisp-exceptions.c: Typo.

2005-05-10 12:39  gb

	* level-0/nfasload.lisp: Colons.

2005-05-10 12:38  gb

	* level-0/l0-symbol.lisp: #+PPC64-target: special-case (SYMBOL-NAME
	NIL).

2005-05-10 12:37  gb

	* level-0/l0-numbers.lisp: LOGIOR X 0 is X, LOGIOR 0 Y is Y. 
	Sheesh.

2005-05-10 12:37  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp: There were 2 (different)
	definitions of %ILSR-C; the second (which took effect) generated
	slightly worse code (for an operation that's rarely used.)

2005-05-10 12:35  gb

	* compiler/vinsn.lisp: Change source file indicator.

2005-05-10 12:34  gb

	* compiler/nx1.lisp: Parameterize LOGBITP a bit.

2005-05-10 12:34  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: Lots of changes, mostly for
	the better ...

2005-05-10 12:33  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp: Target package-name,
	t-offset.  Lots of other changes, including reassigning
	SUBTAG-CHARACTER to make SUBTAG-SINGLE-FLOAT easier to identify.

2005-05-10 12:32  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp: Target package-name,
	t-offset.

2005-05-10 12:31  gb

	* compiler/PPC/ppc-lap.lisp: Support T as a (constant) operand.

2005-05-10 12:31  gb

	* compiler/PPC/ppc-disassemble.lisp: Conditionalize for ppc64.

2005-05-10 12:30  gb

	* compiler/optimizers.lisp: Conditionalize for ppc64, partly (but
	see MAKE-ARRAY).

2005-05-10 12:29  gb

	* compiler/nx.lisp: XCOMPILE-LAMBDA, to test cross-compiler.

2005-05-10 12:29  gb

	* compiler/arch.lisp: Package name, t-offset in target-arch struct.

2005-05-10 00:39  gb

	* lisp-kernel/bits.h: Parameterize, try to force a few more things
	to inline.

2005-05-10 00:39  gb

	* lisp-kernel/darwin64/Makefile: Link with -lmx.

2005-05-10 00:39  gb

	* level-1/l1-numbers.lisp: Add a non-destructive %SINGLE-FLOAT-LOG
	for PPC64.  (Assumes -lmx on Darwin64).

2005-05-10 00:37  gb

	* level-1/l1-init.lisp: Use target::most-positive/negative-fixnum. 
	Remove a few MCL-isms.

2005-05-10 00:36  gb

	* level-0/: l0-def.lisp, l0-float.lisp, l0-io.lisp, l0-pred.lisp,
	l0-utils.lisp, PPC/ppc-debug.lisp, PPC/ppc-float.lisp,
	PPC/ppc-hash.lisp, PPC/ppc-misc.lisp, PPC/ppc-numbers.lisp,
	PPC/ppc-pred.lisp, PPC/ppc-symbol.lisp: some more #+ppc64-target
	conditionalization; still more to be done (especially bignum
	stuff.)

2005-05-10 00:33  gb

	* level-0/: l0-clos.lisp, l0-dcode.lisp, l0-debug.lisp: remove
	empty files.  (Remember to remove old fasls before (XLOAD-LEVEL-0).

2005-05-10 00:32  gb

	* compiler/PPC/: PPC32/ppc32-arch.lisp, PPC64/ppc64-arch.lisp:
	NODE-SIZE.

2005-05-10 00:31  gb

	* compiler/PPC/ppc-lapmacros.lisp: interlocked loads/stores, some
	more shifts, interrupt-checking fixes.

2005-05-09 07:42  gb

	* level-0/PPC/: ppc-clos.lisp, ppc-utils.lisp: conditionalize for
	ppc64.

2005-05-09 07:41  gb

	* compiler/PPC/ppc-lapmacros.lisp: EXTRACT-LOWBYTE for ppc64.

2005-05-09 05:43  gb

	* level-0/PPC/ppc-array.lisp: Conditionalize some for ppc64; warn
	at compile time about missing ppc64 functions.

2005-05-09 05:30  gb

	* level-0/l0-utils.lisp: Remove some unused functions.

2005-05-09 05:29  gb

	* level-0/l0-cfm-support.lisp: TARGET package.

2005-05-09 05:29  gb

	* level-0/: l0-array.lisp, nfasload.lisp: Use CL arithmetic to
	create 32-bit integers ...

2005-05-09 05:28  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp: lowtag constants.

2005-05-09 05:28  gb

	* compiler/PPC/ppc-lapmacros.lisp: TRLGEI, EXTRACT-LOWTAG.

2005-05-09 05:27  gb

	* level-1/l1-clos-boot.lisp: 64-bit vectors, *CLASS-TABLE* changes
	for #+ppc64-target.

2005-05-08 23:01  gb

	* level-0/l0-array.lisp: Start to conditionalize for
	#+ppc64-target; -mostly- involves changing PPC32 package prefix to
	TARGET (but some -real- differences.) 2 down, about 100 to go.

2005-05-08 23:01  gb

	* level-0/l0-aprims.lisp: Start to conditionalize for
	#+ppc64-target; -mostly- involves changing PPC32 package prefix to
	TARGET.

2005-05-08 22:59  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp: Define lowtag constants,
	min-{vector,array}-subtag values.

2005-05-08 21:14  gb

	* lisp-kernel/constants64.s, compiler/PPC/PPC64/ppc64-arch.lisp:
	Fix some tag definitions, add missing ratio/complex.

2005-05-08 21:14  gb

	* lisp-kernel/constants64.h: Fix some tag definitions, add missing
	ratio/complex, define tag_of_nil.

2005-05-08 21:12  gb

	* lisp-kernel/constants32.s: Define tag_of_nil, for lisp_globals
	parameterization.

2005-05-08 21:11  gb

	* lisp-kernel/constants.s: Parameterize lisp_globals struct origin
	stuff.

2005-05-08 06:25  gb

	* level-1/version.lisp: Bump; time for new binaries.

2005-05-08 06:24  gb

	* xdump/xfasload.lisp, level-0/nfasload.lisp: Remove old
	code-vector/svar loading cases.

2005-05-08 06:17  gb

	* lib/nfcomp.lisp: Remove old code-vector/svar dumping cases.

2005-05-08 05:59  gb

	* compiler/PPC/ppc-arch.lisp, compiler/PPC/PPC32/ppc32-arch.lisp,
	compiler/PPC/PPC64/ppc64-arch.lisp, level-0/l0-misc.lisp,
	level-0/l0-utils.lisp, level-0/nfasload.lisp,
	level-1/l1-lisp-threads.lisp, xdump/xfasload.lisp: AREA-
	enumeration constants are PPC-specific, not platform-specific. 
	(AREA. accessors -are- platform-specific).

2005-05-08 05:57  gb

	* lib/nfcomp.lisp: Use $fasl-svar, $fasl-codevector.

2005-05-08 05:10  gb

	* level-0/nfasload.lisp, xdump/faslenv.lisp, xdump/xfasload.lisp:
	Define (and use) $FASL-CODE-VECTOR, $FASL-SVAR.

2005-05-08 04:30  gb

	* xdump/xfasload.lisp: Remove obsolete function.

2005-05-08 04:20  gb

	* lib/nfcomp.lisp: FASL-DUMP-FUNCTION.

2005-05-08 04:19  gb

	* level-0/nfasload.lisp: Report file position of bad fasl opcode.

2005-05-08 03:56  gb

	* xdump/xfasload.lisp: Fix typo.

2005-05-08 03:51  gb

	* xdump/: xfasload.lisp, faslenv.lisp: Drop old operators; add
	$FASL-FUNCTION.

2005-05-08 03:46  gb

	* level-0/nfasload.lisp: Drop old operators; add $FASL-FUNCTION.

2005-05-08 03:30  gb

	* lib/nfcomp.lisp: Use new $fasl-vetab-alloc/count, not
	$fasl-etab-alloc/long.

2005-05-08 03:07  gb

	* lib/nfcomp.lisp, xdump/faslenv.lisp: Increment fasl version.

2005-05-08 02:52  gb

	* lib/nfcomp.lisp: FASL-DUMP-DISPATCH: don't forget to dump
	character constants, and use ETYPECASE to keep from quietly
	neglecting to dump other types in the future.
	
	(All of this is getting tricky to bootstrap; there will be new
	binaries soon.)

2005-05-08 01:17  gb

	* lib/nfcomp.lisp: Know (a bit) less about platform-dependent
	typecodes when dumping; still more work to be done here.

2005-05-08 01:16  gb

	* xdump/: faslenv.lisp, xfasload.lisp: Define (and implement)
	$FASL-SFLOAT.

2005-05-08 01:11  gb

	* level-0/PPC/ppc-float.lisp: DOUBLE-FLOAT-BITS,
	DOUBLE-FLOAT-FROM-BITS.

2005-05-08 01:09  gb

	* level-1/l1-utils.lisp: DEFINE-CONSTANT: report new, old value in
	CERROR message.

2005-05-08 01:08  gb

	* level-0/nfasload.lisp: $FASL-SFLOAT.

2005-05-08 01:07  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp, lisp-kernel/constants64.h,
	lisp-kernel/constants64.s: BIGNUM, DOUBLE-FLOAT have 32-bit
	elements on PPC64 (to ease bootstrapping.)

2005-05-07 23:52  gb

	* level-0/PPC/ppc-float.lisp: (host) support to get/set
	single-float bits.

2005-05-07 23:51  gb

	* lib/nfcomp.lisp: Use new (so far ...) operators.

2005-05-07 23:51  gb

	* xdump/xfasload.lisp: Add support for new (so far) operators.

2005-05-07 23:50  gb

	* xdump/faslenv.lisp: Rename $FASL-FLOAT to $FASL-DFLOAT.

2005-05-07 23:50  gb

	* level-0/nfasload.lisp: Ignore (ignored) extended-string flag in
	obsolete FASL-READSTR and equally obsolete callers.

2005-05-07 22:01  gb

	* lib/nfcomp.lisp: Remove (old, unused) extended-string stuff.

2005-05-07 21:46  gb

	* lib/nfcomp.lisp: FASL-OUT-COUNT, to encode arbitrary-sized
	UNSIGNED-BYTE values.

2005-05-07 21:45  gb

	* level-0/nfasload.lisp: implement some new fasl operators.

2005-05-07 21:45  gb

	* xdump/faslenv.lisp: Define some new fasl operators.

2005-05-07 17:54  gb

	* lib/: defstruct.lisp, defstruct-lds.lisp: use $DEFSTUCT-STRUCT,
	to simplify cross-compilation.

2005-05-07 17:36  gb

	* lib/defstruct-macros.lisp: define $DEFSTUCT-STRUCT, to simplify
	cross-compilation.

2005-05-07 17:34  gb

	* lib/macros.lisp: Provide a couple of doc strings.

2005-05-07 17:34  gb

	* lib/misc.lisp: Function (macro, special-operator) documentation
	associated with function object.

2005-05-07 17:28  gb

	* level-1/l1-aprims.lisp, lib/sequences.lisp: Don't use
	%VECT-SUBTYPE.

2005-05-07 17:28  gb

	* level-0/l0-misc.lisp: Associate documentation with the
	definition.

2005-05-07 17:27  gb

	* level-0/l0-array.lisp: Don't define %VECT-SUBTYPE, to remove
	temptation to use it.

2005-05-07 17:27  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp: TRAP-UNLESS-CHARACTER,
	TRAP-UNLESS-CONS.

2005-05-07 17:26  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp: Use :struct to name structure
	type.

2005-05-07 17:26  gb

	* compiler/PPC/ppc2.lisp: Hide a few more ppc32 dependencies. 
	Still issues when native typecodes are involved (%gvector,
	%alloc-misc, etc.)

2005-05-07 17:24  gb

	* compiler/PPC/ppc-lapmacros.lisp: Remove doc string from IF lap
	macro.

2005-05-06 22:59  gb

	* compiler/PPC/ppc2.lisp: Typed-uvref/uvset operators accept
	keywords.

2005-05-06 22:59  gb

	* compiler/nx1.lisp: Use the new (keyword-based) typed-uvref/uvset
	operators.

2005-05-06 22:21  gb

	* compiler/PPC/ppc2.lisp: Remove some ppc32 package constants.

2005-05-06 22:15  gb

	* compiler/: arch.lisp, PPC/PPC32/ppc32-arch.lisp:
	ARRAY-TYPE-NAME-FROM-CTYPE-FUNCTION in arch struct, and PPC32
	implementation.

2005-05-06 19:54  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp: SINGLE-FLOAT-BITS.

2005-05-06 19:54  gb

	* lib/level-2.lisp: Don't define %TYPED-MISC-REF, %TYPED-MISC-SET
	anymore.

2005-05-06 19:53  gb

	* level-0/l0-array.lisp, lib/sequences.lisp,
	compiler/optimizers.lisp: Don't use %TYPED-MISC-REF,
	%TYPED-MISC-SET anymore.

2005-05-06 18:17  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp: Fix typo.

2005-05-06 18:06  gb

	* lib/sequences.lisp: Change typecode name in TYPE-KEYWORD-CODE
	call, do the call at readtime, not runtime.

2005-05-06 18:05  gb

	* level-1/sysutils.lisp: TYPE-KEYWORD-CODE uses vector types from
	target.

2005-05-06 18:05  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp: Define vector type names. 
	Flesh out uvector type codes.

2005-05-06 18:04  gb

	* compiler/arch.lisp: Add vector type names (gvector,
	n-bit-ivector.)

2005-05-03 16:31  gb

	* lisp-kernel/gc.c: No need to zero_last_page() anymore.

2005-05-03 16:31  gb

	* lisp-kernel/gc.h: use HeapHighWaterMark to mark highest mapped
	address known to be zero-filled.

2005-05-03 16:30  gb

	* lisp-kernel/image.c: No memory protection anymore, so no need to
	zero_last_page().

2005-05-03 16:30  gb

	* lisp-kernel/lisp-debug.c: Add a missing #\Newline.

2005-05-03 16:29  gb

	* lisp-kernel/lisp-exceptions.c: New handling of heap resizing and
	segment allocation/zeroing.

2005-05-03 16:28  gb

	* lisp-kernel/pmcl-kernel.c: Turn the EGC on again; track
	HeapHighWaterMark.

2005-05-03 16:28  gb

	* lisp-kernel/thread_manager.c: Use allocate_tcr() to ... allocate
	TCR pointers, to ensure that a Mach port can be assigned the TCR's
	address as a "name".

2005-05-03 16:27  gb

	* xdump/xfasload.lisp: Support doc strings in level-0.

2005-05-03 16:26  gb

	* level-1/linux-files.lisp: Return another value from %STAT-VALUES.

2005-05-03 16:25  gb

	* level-1/l1-utils.lisp: MEMBER/ASSOC support, MACRO-FUNCTION moved
	to level-0 (to handle early doc strings.)

2005-05-03 16:25  gb

	* level-0/nfasload.lisp: Handle cold-load documentation.

2005-05-03 16:24  gb

	* level-0/l0-utils.lisp: Some MEMBER/ASSOC support here.

2005-05-03 16:24  gb

	* level-0/l0-misc.lisp: Change the wording in ROOM: it's not 1989
	anymore.

2005-05-03 16:23  gb

	* level-0/l0-def.lisp: Remove (this version of) SET-DOCUMENTATION,
	which might or might not have been overridden by another version
	...
	
	Define a SET-FUNCTION-INFO, which handles the case where a
	function's information is just a doc string.
	
	Move the definition of MACRO-FUNCTION here.

2005-05-01 17:53  gb

	* examples/rubix/blocks.lisp: Hamilton's fix in
	RENDER-FOR-SELECTION.

2005-04-29 03:35  gb

	* lib/nfcomp.lisp, xdump/faslenv.lisp: Increment FASL version.

2005-04-29 03:07  gb

	* lisp-kernel/spentry.s: Writes that may introduce
	intergenerational references should all be handled here; ensuring
	atomicity and handling locatives requires some support in
	pc_luser_xp().

2005-04-29 03:05  gb

	* lisp-kernel/spjump.s: New subprims replace some old ones.

2005-04-29 03:05  gb

	* lisp-kernel/pmcl-kernel.c: No more hardware EGC write barrier. 
	EGC off by default (for bootstrapping new write barrier.)

2005-04-29 03:03  gb

	* lisp-kernel/memprotect.h: No more hardware EGC write barrier.

2005-04-29 03:02  gb

	* lisp-kernel/macros.s: A little more 32/64 macrology; some support
	for bitvector operations.

2005-04-29 03:01  gb

	* lisp-kernel/lisptypes.h: No more pageentry type.

2005-04-29 03:01  gb

	* lisp-kernel/lisp_globals.h: New globals (REFBITS,
	OLDSPACE_DNODE_COUNT).

2005-04-29 03:00  gb

	* lisp-kernel/lisp-exceptions.c: No more protectin-based write
	barrier.  Some new pc-luser support to make software write barrier
	appear to be atomic (needs testing.)

2005-04-29 02:59  gb

	* lisp-kernel/gc.h: No more pagemap.

2005-04-29 02:59  gb

	* lisp-kernel/gc.c: New (software) EGC write barrier; drop support
	for the old one ...

2005-04-29 02:57  gb

	* lisp-kernel/: constants32.s, constants64.s: Move lisp-global
	definitions elsewhere; define some bitvector-related values.

2005-04-29 02:57  gb

	* lisp-kernel/constants32.h: Define t_value.

2005-04-29 02:56  gb

	* lisp-kernel/constants.s: Move lisp-global definitions here.

2005-04-29 02:54  gb

	* lisp-kernel/: bits.c, bits.h: Some word-size issues; still very
	32-bit-centric.

2005-04-29 02:53  gb

	* lisp-kernel/asmutils.s: Add atomic_ior.

2005-04-29 02:51  gb

	* level-1/version.lisp: Bump.

2005-04-29 02:51  gb

	* level-0/PPC/ppc-misc.lisp: %STORE-NODE-CONDITIONAL goes
	out-of-line, for EGC write barrier.
	
	%STORE-IMMEDIATE-CONDITIONAL skips that, when fixnums/immediates
	are known to be involved.

2005-04-29 02:50  gb

	* level-0/PPC/ppc-hash.lisp: %SET-HASH-TABLE-VECTOR-KEY goes out of
	line, to handle EGC write barrier.

2005-04-29 02:49  gb

	* level-0/l0-misc.lisp: Use %STORE-IMMEDIATE-CONDITIONAL when
	fixnums are involved.

2005-04-29 02:48  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp: Remove misc-set-node and
	vcell-set.

2005-04-29 02:48  gb

	* compiler/PPC/ppc2.lisp: lwi -> lri.  Do setq of closed-over
	vcells via .SPgvset, for EGC.

2005-04-29 02:46  gb

	* compiler/PPC/ppc-arch.lisp: Replace some obsolete globals with
	refbits and oldspace-dnode-count.

2005-04-29 02:45  gb

	* compiler/subprims.lisp: Replace something obsolete with
	.SPset-hash-key.

2005-04-26 11:02  gb

	* lisp-kernel/spentry.s: Make Darwin assembler happy.  (Well,
	happier than it ordinarily is.)

2005-04-26 11:01  gb

	* examples/objc-runtime.lisp: Declare NSConcreteData.

2005-04-26 10:59  gb

	* lisp-kernel/: spentry.s, spjump.s: SPstore_node_conditional.

2005-04-26 10:58  gb

	* level-0/PPC/ppc-misc.lisp: Remove (very) obsolete %BIND-SPECIAL.

2005-04-26 10:57  gb

	* compiler/PPC/ppc2.lisp: Do rplaca/rplacd (and variants), svset
	(and variants) out-of-line, for new write-barrier scheme.

2005-04-26 10:55  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp: A few indentation changes.

2005-04-26 10:55  gb

	* compiler/subprims.lisp: Add .SPstore-node-conditional.

2005-04-26 04:57  gb

	* compiler/subprims.lisp: Updated.

2005-04-26 04:56  gb

	* lisp-kernel/pmcl-kernel.c: Disable EGC, initially.

2005-04-26 04:54  gb

	* lisp-kernel/: spentry.s, spjump.s: Start new write-barrier
	scheme.

2005-04-26 00:55  gb

	* examples/bridge.lisp: Partially implement SEND in terms of
	interface information.

2005-04-26 00:54  gb

	* examples/cocoa-editor.lisp: Avoid message arg type ambiguity.

2005-04-26 00:53  gb

	* examples/: cocoa-typeout.lisp, cocoa-listener.lisp: Declare SEND
	arg type.

2005-04-26 00:52  gb

	* examples/objc-clos.lisp: Handle foreign slots differently, since
	offset/width info is available from interfaces.

2005-04-26 00:52  gb

	* examples/objc-runtime.lisp: Derive class info from interfaces,
	not via introspection.

2005-04-26 00:51  gb

	* examples/objc-support.lisp: Don't references private slots or use
	SEND to send undeclared messages.

2005-04-26 00:50  gb

	* level-1/version.lisp: Bump.

2005-04-26 00:50  gb

	* lib/foreign-types.lisp: Start thinking about making some of this
	target-sensitive.  Pre-define :<BOOL> as an integer type.

2005-04-26 00:48  gb

	* library/parse-ffi.lisp, lib/db-io.lisp: Handle protocol methods,
	protocols in ObjC class decls.

2005-04-26 00:47  gb

	* library/splay-tree.lisp: Add MAP-SPLAY-TREE-KEYS-AND-VALUES.

2005-04-24 00:01  gb

	* lib/arrays-fry.lisp: Ignore fill-pointers when looking at array
	dimensions in RESULT-BIT-ARRAY.

2005-04-20 06:25  gb

	* lib/db-io.lisp: Write trailer on CDB files, check for it.

2005-04-20 06:25  gb

	* level-1/version.lisp: Bump, once again.

2005-04-20 06:24  gb

	* headers/gnome2/C/.cvsignore: New file.

2005-04-20 03:08  gb

	* lib/db-io.lisp: Prepend 2K of NULs to .CDB files, for backward
	compatibility (sort of).  Still more bootstrapping ...

2005-04-20 00:53  gb

	* lib/db-io.lisp, library/parse-ffi.lisp: Changes to how some
	things are encoded in .cdb files; field offsets and widths are now
	provided explicitly.  This will require new .cdb files and is a
	little hard to bootstrap ...

2005-04-20 00:50  gb

	* level-1/l1-reader.lisp: Bryan's change to allow potential numbers
	with package prefixes to be treated as symbols.

2005-04-20 00:49  gb

	* headers/libc/C/populate.sh: Updated, a bit.

2005-04-20 00:48  gb

	* headers/gnome/C/populate.sh: Assume new-style location for
	gnome.h

2005-04-20 00:47  gb

	* headers/: gl/.cvsignore, gnome/.cvsignore, gtk/.cvsignore,
	libc/.cvsignore: Ignore backup .cdb files.

2005-04-20 00:44  gb

	* headers/: gl/C/.cvsignore, gnome/C/.cvsignore, gnome2/.cvsignore,
	gnome2/C/populate.sh, gnustep/.cvsignore, gnustep/C/populate.sh,
	gtk/C/.cvsignore, gtk2/C/.cvsignore, gtk2/C/populate.sh,
	libc/C/.cvsignore, gnustep/C/.cvsignore, gtk2/.cvsignore: New file.

2005-04-18 00:48  gb

	* examples/bridge.lisp: Fix typo: "dictionaryWithObjectsAndKeys:".

2005-04-18 00:47  gb

	* lib/db-io.lisp, lib/foreign-types.lisp, library/parse-ffi.lisp:
	Support for ObjC class info, method info in interface files.

2005-04-18 00:46  gb

	* lib/ccl-export-syms.lisp: Export CURRENT-DIRECTORY; drop
	COMPILE-LOAD.

2005-04-18 00:44  gb

	* level-1/version.lisp: Bump, yet again.

2005-04-18 00:44  gb

	* level-1/linux-files.lisp: Implement CURRENT-DIRECTORY and (SETF
	CURRENT-DIRECTORY).

2005-04-18 00:44  gb

	* level-1/l1-readloop-lds.lisp: Some toplevel commands for
	getting/setting the current directory.

2005-04-18 00:43  gb

	* level-1/l1-typesys.lisp: %DEFTYPE clears the type cache.

2005-04-18 00:43  gb

	* level-1/l1-files.lisp: Remove COMPILE-LOAD, which doesn't offer
	much functionality beyond that offered by (compile ... :load t),
	does it ?

2005-04-18 00:41  gb

	* level-0/l0-error.lisp: Say "FASL", not "PFSL" in error messages.

2005-04-18 00:41  gb

	* darwin-headers/libc/C/populate.sh: Use more recent headers
	(current Panther headers.)

2005-04-18 00:40  gb

	* darwin-headers/gl/C/populate.sh: Process agl.h as well.

2005-04-18 00:38  gb

	* darwin-headers/: gl/C/.cvsignore, quicktime/C/.cvsignore,
	quicktime/C/populate.sh: New file.

2005-04-18 00:38  gb

	* darwin-headers/: carbon/.cvsignore, cocoa/.cvsignore,
	gl/.cvsignore, libc/.cvsignore: Ignore *.cdb-BAK as well.

2005-04-18 00:36  gb

	* darwin-headers/: carbon/C/.cvsignore, chud/.cvsignore,
	chud/C/.cvsignore, chud/C/populate.sh, cocoa/C/.cvsignore,
	libc/C/.cvsignore, quicktime/.cvsignore: New files.

2005-04-18 00:26  gb

	* compiler/optimizers.lisp: Handle the 2-argument case of
	case-sensitive character comparison functions.

2005-04-17 19:29  alex

	* examples/objc-clos.lisp: 
	
	edited %objc-domain-slots-vector to allocate slot vectors on demand
	for object instantiated outside of lisp (AppKit).

2005-04-17 19:27  alex

	* level-1/l1-callbacks.lisp: 
	
	added a trace flag to the callback table and extended
	%pascal-functions% to set a special variable *callback-trace-p*
	during execution.

2005-04-17 19:26  alex

	* lib/encapsulate.lisp: 
	
	extended the trace facility to support tracing of callbacks, a
	:backtrace argument and hook variables for the IDE

2005-04-17 19:25  alex

	* lib/macros.lisp: 
	
	Extended DEFINE-CALLBACK and DEFCALLBACK-BODY to support tracing.

2005-04-17 08:56  beer

	* examples/bridge.lisp: evised %PARSE-MESSAGE and
	CHECK-MESSAGE-ARG-COUNT to fix a bug with interpreting some
	variable-arity message sends

2005-04-15 06:23  gb

	* level-1/version.lisp: Bump.

2005-04-15 06:13  gb

	* lib/level-2.lisp: Fix EVAL-REDEF of %ALLOC-MISC.

2005-04-15 06:00  gb

	* lisp-kernel/: constants64.h, constants64.s: Define charcodeshift,
	ncharchodebits consistently with what ppc64-arch says.

2005-04-15 06:00  gb

	* lisp-kernel/darwin64/Makefile: Apparently, it isn't necessary to
	use the well-known -weak_references_mismatch argument when that has
	nothing to do with anything.  ld64 just keeps getting better and
	better!

2005-04-15 05:59  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: TRAP-UNLESS-MACPTR.  Do a
	few more 64-bit comparisons.

2005-04-15 05:57  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp: TRAP-UNLESS-MACPTR.

2005-04-15 05:57  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp: Need a 1-word code-vector
	prefix here.

2005-04-15 05:56  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp: No code-vector prefix here.

2005-04-15 05:56  gb

	* compiler/PPC/ppc2.lisp: Maybe emit a "prefix" on the code vector.
	 More PPC64 conditionalization.

2005-04-15 05:53  gb

	* compiler/PPC/ppc-lap.lisp: Maybe emit a "prefix" on the code
	vector.

2005-04-15 05:52  gb

	* compiler/PPC/ppc-disassemble.lisp: Skip over any code-vector
	prefix.  Start to conditionalize to make PPC64 disassembly better.

2005-04-15 05:51  gb

	* compiler/nx0.lisp: Define, use, NX1-TARGET-FIXNUMP.

2005-04-15 05:50  gb

	* compiler/arch.lisp: CODE-VECTOR-PREFIX, for PPC64 alignment.

2005-04-14 21:27  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp: charcode-shift is 8;
	ncharcodebits is 8 (for now).

2005-04-14 21:26  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp: Actually bother to define
	LOAD-CHARACTER-CONSTANT.

2005-04-14 21:26  gb

	* compiler/vreg.lisp: :u64const, :s64const.

2005-04-14 21:20  gb

	* compiler/PPC/ppc2.lisp: LWI -> LRI, PPC2-LWI -> PPC2-LRI.

2005-04-14 21:20  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp: LWI -> LRI.

2005-04-14 21:19  gb

	* compiler/PPC/ppc-lapmacros.lisp: Use TARGET-ARCH-CASE, no need
	for PPC-LAP-TARGET-ARCH-CASE.

2005-04-14 21:18  gb

	* lib/macros.lisp: TARGET-ARCH-CASE here.

2005-04-14 01:39  gb

	* compiler/backend.lisp: Finish bootstrapping backend changes.

2005-04-14 01:13  gb

	* compiler/: backend.lisp, PPC/PPC32/ppc32-backend.lisp,
	PPC/PPC64/ppc64-backend.lisp: Start to remove obsolete target
	slots.

2005-04-14 00:51  gb

	* lib/sequences.lisp: Fix typos, exposed by Bryan's fix to #+/#-
	readers.

2005-04-14 00:21  gb

	* level-1/version.lisp: Bump version.

2005-04-14 00:20  gb

	* examples/bridge.lisp: #\B in typestrings is :<BOOL>.	C arrays
	are always passed by reference.

2005-04-14 00:19  gb

	* compiler/PPC/: PPC32/ppc32-vinsns.lisp, PPC64/ppc64-vinsns.lisp:
	Factor out some typecode-specific stuff.

2005-04-14 00:19  gb

	* compiler/PPC/: PPC32/ppc32-arch.lisp, PPC32/ppc32-backend.lisp,
	PPC64/ppc64-arch.lisp, PPC64/ppc64-backend.lisp: Backend/arch
	parameterization.

2005-04-14 00:18  gb

	* compiler/PPC/ppc2.lisp: Use target-specific parameters from 
	structure, not individually.  2d-aref/aset acode changes.

2005-04-14 00:18  gb

	* compiler/PPC/: ppc-lap.lisp, ppc-lapmacros.lisp: Use
	target-specific parameters from  structure, not individually.

2005-04-14 00:17  gb

	* compiler/PPC/ppc-arch.lisp: Require "ARCH" at load-time.

2005-04-14 00:16  gb

	* compiler/nx1.lisp: Try to keep target tags out of acode (for 2d
	array access only, so far.)

2005-04-14 00:16  gb

	* compiler/backend.lisp: Add a "target-arch" slot to backend
	structure (this should allow several other slots to be removed.)

2005-04-14 00:15  gb

	* compiler/arch.lisp: Start moving parameters from "backend"
	structure to new "target-arch" structure.

2005-04-13 12:23  bryan

	* lib/nfcomp.lisp: "file not found" during compile-file should be a
	file-error.

2005-04-12 22:57  bryan

	* level-1/l1-reader.lisp: per 2.4.8.17, "#+(or) #+(or) nil nil t"
	should probably read as T

2005-04-01 03:23  gb

	* darwin-headers/cocoa/C/populate.sh: No they weren't: parse
	PreferencePanes.h

2005-04-01 00:15  gb

	* compiler/PPC/ppc2.lisp: Minor target package changes.

2005-03-29 22:53  gb

	* compiler/: backend.lisp, PPC/PPC32/ppc32-backend.lisp: Start to
	add target-uvector-subtags to backend.

2005-03-29 07:06  gb

	* lisp-kernel/linux64/Makefile: First cut at a Makefile.

2005-03-29 07:05  gb

	* lisp-kernel/linux64/elf64ppc.x: Linker script for linux64; force
	kernel into low memory.

2005-03-29 07:05  gb

	* lisp-kernel/pmcl-kernel.c: May be grief including
	#<asm/cputable.h> on linux64.  Note that fact.

2005-03-29 07:04  gb

	* lisp-kernel/macros.s: extract_lowbyte uses clrlri.

2005-03-29 07:04  gb

	* lisp-kernel/lisp-exceptions.c: Don't save/restore PT_MQ; this had
	something to do with saving/restoring Altivec registers, a long
	time ago.

2005-03-29 07:03  gb

	* lisp-kernel/imports.s: Don't import __trampoline_setup on
	linux64.

2005-03-29 07:02  gb

	* lisp-kernel/plbt.c: No eabi_c_frame on linux64.

2005-03-28 04:34  gb

	* darwin-headers/cocoa/C/populate.sh: The actual cocoa interfaces
	(from darwin-interfaces-040505.tar.gz) were built from this, not
	from what's been in CVS.

2005-03-28 04:33  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp:
	TRAP-UNLESS-{SINGLE,DOUBLE}-FLOAT, refer to the least significant
	bit as "lowbit", not as "bit31".  A few other things implemented; a
	lot to go.

2005-03-28 04:31  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp:
	TRAP-UNLESS-{SINGLE,DOUBLE}-FLOAT, refer to the least significant
	bit as "lowbit", not as "bit31".

2005-03-28 04:28  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp: Some fixes & cleanups;
	TCR-BIAS.

2005-03-28 04:26  gb

	* compiler/PPC/: PPC32/ppc32-backend.lisp,
	PPC64/ppc64-backend.lisp: More compilation-target parameters in the
	backend.

2005-03-28 04:25  gb

	* compiler/PPC/ppc2.lisp: Start to remove some ppc32-isms.

2005-03-28 04:24  gb

	* compiler/PPC/ppc-lapmacros.lisp: MOST (not all) things run-time
	conditionalized for ppc32/ppc64.

2005-03-28 04:24  gb

	* compiler/PPC/ppc-lap.lisp: Remove some PPC32-isms.

2005-03-28 04:23  gb

	* compiler/backend.lisp: Put more target stuff in the backend
	structure.

2005-03-28 04:22  gb

	* level-0/PPC/ppc-clos.lisp: GF protos, trampolines: LAP moved
	here.

2005-03-28 04:21  gb

	* level-0/PPC/ppc-float.lisp: Float sign, zerop functions in lisp.

2005-03-28 04:21  gb

	* level-0/PPC/ppc-io.lisp: A little bit of conditionalization (for
	a little bit of code.)

2005-03-28 04:20  gb

	* level-0/PPC/ppc-misc.lisp: A little bit of conditionalization
	(needs more work.)

2005-03-28 04:19  gb

	* level-0/PPC/ppc-numbers.lisp: %DOUBLE-FLOAT-PLUSP,
	%SHORT-FLOAT-PLUSP in lisp.

2005-03-28 04:18  gb

	* level-0/l0-numbers.lisp: %DOUBLE-FLOAT-ZEROP, %SHORT-FLOAT-ZEROP
	in lisp.

2005-03-28 04:18  gb

	* level-0/l0-float.lisp: %DOUBLE-FLOAT-SIGN, %SHORT-FLOAT-SIGN in
	lisp.

2005-03-28 04:17  gb

	* level-1/version.lisp: Bump; again, a little hard to bootstrap.

2005-03-28 04:16  gb

	* lib/number-macros.lisp: Remove some commented-out code.

2005-03-28 04:16  gb

	* lib/systems.lisp: Define PPC64-VINSNS.

2005-03-28 04:15  gb

	* lib/compile-ccl.lisp: Include PPC64-ARCH in
	*PPC-COMPILER-MODULES*.

2005-03-28 04:14  gb

	* lisp-kernel/constants32.h: Define TCR_BIAS.

2005-03-28 04:13  gb

	* lisp-kernel/constants64.h: Don't use NATURAL_POINTER_FIELD. 
	Define TCR_BIAS.

2005-03-28 04:13  gb

	* lisp-kernel/constants64.s: Define TCR_BIAS; ensure that TCR has
	single_float_convert field.

2005-03-28 04:12  gb

	* lisp-kernel/darwin/.gdbinit: No TCR_BIAS on Darwin32; rcontext is
	now r13.

2005-03-28 04:11  gb

	* lisp-kernel/lisptypes.h: Don't (try to) support 32-bit foreign
	pointers in 64-bit code.

2005-03-28 04:10  gb

	* lisp-kernel/lisp.h: Don't define NATURAL_POINTER_FIELD.

2005-03-28 04:10  gb

	* lisp-kernel/area.h: Don't use NATURAL_POINTER_FIELD.

2005-03-28 04:09  gb

	* lisp-kernel/Threads.h: Don't use NATURAL_POINTER_FIELD.  Define
	TCR_BIAS in constants{32,64}.h

2005-03-28 04:08  gb

	* level-1/l1-dcode.lisp: Move LAP code to level-0.

2005-03-27 14:36  gb

	* xdump/faslenv.lisp: Increment min fasl version.

2005-03-27 14:30  gb

	* lib/nfcomp.lisp: Increment fasl version.

2005-03-27 14:22  gb

	* level-1/version.lisp: Bump.

2005-03-27 14:22  gb

	* xdump/faslenv.lisp: Increment $fasl_vers.

2005-03-27 14:17  gb

	* compiler/PPC/ppc-arch.lisp: Don't define old-rcontext.

2005-03-27 14:16  gb

	* lisp-kernel/: constants.h, constants.s, spentry.s, subprims.s,
	thread_manager.c: Stop maintaining old_rcontext.  Don't need
	special get_interrupt_tcr() on Linux; review other TCR-related
	cruft.

2005-03-27 13:38  gb

	* lisp-kernel/: constants.h, constants.s, spentry.s, subprims.s:
	r13 is rcontext; maintain r2 (old_rcontext) in parallel, until
	we're bootstrapped.

2005-03-27 13:38  gb

	* compiler/PPC/ppc-arch.lisp: r13 is rcontext; r2 (maintained by
	the kernel) is old-rcontext, until we stop referencing it.

2005-03-27 12:01  gb

	* level-0/PPC/ppc-bignum.lisp, level-0/PPC/ppc-def.lisp,
	level-0/PPC/ppc-float.lisp, level-0/PPC/ppc-misc.lisp,
	lisp-kernel/constants.h, lisp-kernel/constants.s,
	lisp-kernel/macros.s, lisp-kernel/spentry.s,
	lisp-kernel/subprims.s, compiler/PPC/ppc-arch.lisp,
	compiler/PPC/ppc-lapmacros.lisp,
	compiler/PPC/PPC32/ppc32-vinsns.lisp: Stop maintaining OLD-VSP; R13
	will soon (one more round of bootstrapping) become RCONTEXT, and
	then the fasl version will change and there'll be new binaries.

2005-03-27 11:27  gb

	* level-0/PPC/: ppc-bignum.lisp, ppc-def.lisp, ppc-float.lisp,
	ppc-misc.lisp: Maintain OLD-VSP, not NEW-VSP.

2005-03-27 11:13  gb

	* compiler/PPC/: ppc-lapmacros.lisp, ppc2.lisp,
	PPC32/ppc32-vinsns.lisp: VSP is now r15, OLD-VSP is r13.  Keep them
	in sync.  Don't use PPC2-FIX-STACKREG or vinsn
	ADJUST-STACK-REGISTER, for bootstrapping reasons.

2005-03-27 11:08  gb

	* compiler/PPC/ppc-arch.lisp: VSP is now r15, OLD-VSP is r13.

2005-03-27 11:04  gb

	* lisp-kernel/: constants.h, constants.s, macros.s, spentry.s,
	subprims.s: VSP is now r15, OLD-VSP is r13.  They should be
	equivalent until we're finished bootstrapping; use check_vsp to
	enforce that at discrete execution points.

2005-03-27 07:39  gb

	* level-0/PPC/ppc-float.lisp, level-0/PPC/ppc-misc.lisp,
	compiler/PPC/PPC32/ppc32-vinsns.lisp: Ensure vsp = new-vsp, harder.

2005-03-27 07:39  gb

	* lisp-kernel/spentry.s: do check_vsp on subprim entry.

2005-03-27 07:38  gb

	* lisp-kernel/macros.s: define check_vsp (trap if vsp != new_vsp)

2005-03-27 06:55  gb

	* compiler/PPC/ppc-arch.lisp, compiler/PPC/ppc-lapmacros.lisp,
	compiler/PPC/PPC32/ppc32-vinsns.lisp, level-0/PPC/ppc-bignum.lisp,
	level-0/PPC/ppc-def.lisp, level-0/PPC/ppc-misc.lisp,
	lisp-kernel/constants.s, lisp-kernel/macros.s,
	lisp-kernel/spentry.s, lisp-kernel/subprims.s: Really no more
	old-fn.  R15 is new-vsp; try to keep it in synch with VSP (soon to
	become "old-vsp") at all times.

2005-03-27 06:00  gb

	* compiler/PPC/ppc-arch.lisp, compiler/PPC/ppc-lapmacros.lisp,
	compiler/PPC/PPC32/ppc32-vinsns.lisp, level-0/PPC/ppc-def.lisp,
	lisp-kernel/constants.h, lisp-kernel/constants.s,
	lisp-kernel/lisp-debug.c, lisp-kernel/spentry.s,
	lisp-kernel/subprims.s: No more old-fn.

2005-03-27 04:53  gb

	* level-0/PPC/ppc-def.lisp: Copy FN to OLD-FN in
	%APPLY-LEXPR-TAIL-WISE.

2005-03-27 04:52  gb

	* compiler/PPC/: ppc-arch.lisp, ppc-lapmacros.lisp,
	PPC32/ppc32-vinsns.lisp: Lisp believes that FN = R16, copies it to
	OLD-FN whenever it's set (for bootstrapping).

2005-03-27 03:04  gb

	* compiler/PPC/ppc-arch.lisp, compiler/PPC/ppc-lapmacros.lisp,
	compiler/PPC/PPC32/ppc32-vinsns.lisp, lisp-kernel/constants.h,
	lisp-kernel/constants.s, lisp-kernel/constants32.s,
	lisp-kernel/lisp-debug.c, lisp-kernel/spentry.s,
	lisp-kernel/subprims.s: Remove remaining uses of temp4; define r16
	as "new_fn".  All assignments to fn copy to new_fn, as well (more
	bootstrapping).

2005-03-27 00:50  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp, level-0/PPC/ppc-clos.lisp,
	lib/ppcenv.lisp, lisp-kernel/Threads.h, lisp-kernel/constants32.s,
	lisp-kernel/thread_manager.c: Back out of previous change, since
	even current versions of Debian unstable don't provide a TLS-aware
	gcc/glibc.  Set TCR_BIAS to 0 where relevant.
	
	Start to take another approach (moving rcontext to r13), by
	starting to phase out temp4 (= r16).  Don't let the compiler
	allocate temp4, don't use temp4 in LAP code.

2005-03-26 20:35  gb

	* level-1/version.lisp: Bump.

2005-03-26 20:34  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp, lisp-kernel/Threads.h,
	lisp-kernel/constants32.s, lisp-kernel/lisp-exceptions.c,
	lisp-kernel/pmcl-kernel.c, lisp-kernel/spentry.s,
	lisp-kernel/thread_manager.c, lisp-kernel/darwin/.gdbinit,
	lisp-kernel/darwin/Makefile: Start to bootstrap changes to
	reconcile OpenMCL's notion of thread-specific-data (the TCR) with
	Linux's.  On Darwin, this means that r2 (rcontext) points #x7000
	bytes beyond the TCR; on Linux, the TCR structure will be the first
	(real) thread-local variable, and the C runtime's thread pointer
	will therefore point ... #x7000 bytes beyond the TCR.  (This
	basically means that we can keep the same value in r2/rcontext when
	running lisp and foreign code on Linux; Linux C and thread and
	debugging utilities are getting increasingly insistent about that.)
	
	This introduces binary incompatibility; there'll need to be a
	change in the fasl version and new images when the dust settles a
	bit.

2005-03-26 20:20  gb

	* lib/dumplisp.lisp: Hmm.  Not likely that MultiFinder/UniFinder
	are involved anymore.

2005-03-18 22:00  gb

	* lisp-kernel/m4macros.m4: Try to use .size directive on ELF.

2005-03-18 21:59  gb

	* lib/ccl-export-syms.lisp: Export
	*IGNORE-EXTRA-CLOSE-PARENTHESIS*.

2005-03-18 21:58  gb

	* level-1/version.lisp: Are we 0.14.3 yet ?

2005-03-18 21:57  gb

	* level-1/l1-reader.lisp: By default, signal errors on dangling
	close parens.

2005-03-18 21:57  gb

	* lib/encapsulate.lisp: Doc string for TRACE: don't describe
	obscure SBCL options.  Or obscure OpenMCL options, either

2005-03-18 21:56  gb

	* level-1/l1-clos.lisp: Add missing #\Newline at EOF.

2005-03-18 21:48  gb

	* lib/: eval.lisp, step.lisp: no more eval, step

2005-03-18 21:07  gb

	* tools/.cvsignore: ignore fasls

2005-03-18 20:42  gb

	* lisp-kernel/lisp-exceptions.c: Word-size and integer/pointer
	64-bit issues.	Some 64-bit Mach exception stuff (needs more work.)

2005-03-18 20:41  gb

	* lisp-kernel/pmcl-kernel.c: Word-size and integer/pointer 64-bit
	issues.  Use vm_region64 if applicable; someday soon, use it with
	reasonable parameters.

2005-03-18 20:39  gb

	* lisp-kernel/: thread_manager.c, plsym.c, plbt.c: Word-size and
	integer/pointer 64-bit issues.

2005-03-18 20:22  gb

	* lisp-kernel/: gc.c, image.c, lisp-debug.c, lisp-exceptions.h:
	Word-size and integer/pointer 64-bit issues.

2005-03-18 20:20  gb

	* lisp-kernel/constants64.h: ppc64 C frame (may be the same on
	linux/darwin.)

2005-03-18 20:19  gb

	* lisp-kernel/bits.h: ppc64 inline asm for count_leading_zeros. 
	(Still lots of 32-bit assumptions in callers ...)

2005-03-18 20:18  gb

	* lisp-kernel/bits.c: Include lisp-exceptions.h, for some obscure
	reason ...

2005-03-18 20:18  gb

	* lisp-kernel/asmutils.s: Some 64-bit fixes.

2005-03-18 20:07  gb

	* lisp-kernel/Threads.h: some extra casts

2005-03-18 19:53  gb

	* lisp-kernel/darwin64/Makefile: work around some new bugs in ld64

2005-03-17 23:55  gb

	* lisp-kernel/lisp-exceptions.c: Use printf-style '%', not
	format-style '~', in MACH_CHECK_ERROR.
	
	Try to get some thread state stuff for PPC64.
	
	Complain if we can't get thread state  in
	create_thread_context_frame.
	
	When deallocate thread exception port before destroying it, just in
	case.
	
	Hold the mach_exception_lock_set lock before suspending in
	suspend_tcr.

2005-03-17 23:51  gb

	* lisp-kernel/pmcl-kernel.c: Keep trying to get xFindSymbol to
	compile without warnings on current and future OS releases.

2005-03-13 04:47  gb

	* lisp-kernel/linux/Makefile: Add -maltivec to ASFLAGS.

2005-03-08 21:15  gb

	* lisp-kernel/spentry.s: Ensure that the XER is zeroed in the
	shared ff_call return code (doh!) and in a slightly more subtle
	case involving Linux syscall return: it seems that the XER[SO] bit
	can be set when the CR0[SO] bit is clear on syscall return, and we
	weren't zeroing the XER in that case (causing spurious arithmetic
	overflows on subsequent arithmetic operations.)

2005-03-08 21:05  gb

	* level-0/PPC/ppc-misc.lisp: Move YIELD, READ-LOCK-RWLOCK, and
	WRITE-LOCK-RWLOCK to lisp code, mostly 'cause I don't want to have
	to trust inline syscalls from LAP.

2005-03-08 21:04  gb

	* level-0/l0-misc.lisp: Move YIELD, READ-LOCK-RWLOCK, and
	WRITE-LOCK-RWLOCK here (from ppc-misc), mostly 'cause I don't want
	to have to trust inline syscalls from LAP.

2005-03-06 20:55  gb

	* level-0/PPC/ppc-misc.lisp: After doing inline syscalls, ensure
	that the XER (especially the XER[SO] bit) is cleared.

2005-03-05 02:07  bryan

	* level-1/l1-io.lisp: when *print-array*, use #nA(..) syntax even
	when array-element-type is something other than t.

2005-03-05 01:13  bryan

	* level-1/l1-io.lisp: print-unreadable-object should accept t
	(*terminal-io*) and nil (*standard-output*) for the stream.

2005-03-04 23:55  bryan

	* level-1/l1-io.lisp: %print-unreadable-object should always return
	nil.
	
	when type is t, %print-unreadable-object should always print a
	space after the type not just when it's followed by more stuff. 
	(seems less aesthetically pleasing, but that's what the spec says).

2005-03-04 14:46  bryan

	* level-1/l1-streams.lisp: ioblock-element-shift should never be <
	0.

2005-03-02 23:28  bryan

	* level-1/version.lisp: bump.

2005-03-02 20:05  bryan

	* level-1/l1-files.lisp: when *print-escape*, pathnames always
	print starting with #P.  (per clhs 22.1.3.11)

2005-03-02 19:18  bryan

	* level-1/l1-io.lisp: when *print-array* is nil, print bit-vectors
	unreadably.

2005-03-02 18:04  bryan

	* level-1/l1-io.lisp: don't do *print-level* truncation for
	bit-vectors and strings.

2005-03-02 16:42  bryan

	* level-1/l1-io.lisp: write-a-cons: when *print-length*=0, write
	"..." for the entire cons.  when the cons is a dotted pair, don't
	decrement print-length before printing the cdr.

2005-03-02 14:49  bryan

	* level-1/l1-io.lisp: when *print-length* would cause "..." to be
	printed immediately following "#(", don't print a space.  thus
	"#(...)", not "#( ...)".

2005-03-02 13:42  bryan

	* lib/format.lisp: don't insert commas inbetween padchars in #\r
	format directive.

2005-03-01 00:41  bryan

	* level-1/version.lisp: bump.

2005-03-01 00:40  bryan

	* lib/macros.lisp: defclass: signal program error when a slot is
	initialized more than once in :default-initargs.  defclass: make
	duplicate slot name program error a bit more verbose.

2005-02-28 23:06  bryan

	* lib/describe.lisp: really big BIGNUMS shouldn't cause describe to
	FLOATING-POINT-OVERFLOW.  instead just print the fact that it would
	if you tried.

2005-02-27 23:43  gb

	* lisp-kernel/darwin64/Makefile: Build on 64-bit DarwinPPC.  Work
	around some linker lossage.

2005-02-27 23:42  gb

	* lisp-kernel/darwin/Makefile: Remove some obsolete stuff.  Try to
	handle cases where OS libs are gratuitously deleted and added in
	unnamed, undiscussed OS releases.

2005-02-27 23:35  gb

	* lisp-kernel/pmcl-kernel.c: Some word size/signedness cleanup. 
	Use dlsym() in cases where we're sure that it exists.

2005-02-27 23:34  gb

	* lisp-kernel/plbt.c: Rename 'dladdr' to 'darwin_dladdr', in case
	The OS Release That Can Not Be Discussed defines its own dladdr
	function.

2005-02-27 23:32  gb

	* lisp-kernel/lisp-exceptions.h: Try to work around the (old, now
	fixed) OSX G5 kernel signal handler bug, by flipping an unused bug
	in the XER.

2005-02-27 23:31  gb

	* lisp-kernel/lisp-exceptions.c: Some word size/signedness cleanup.

2005-02-27 23:30  gb

	* lisp-kernel/lisp-debug.c: Don't prototype print_lisp_object().

2005-02-27 23:29  gb

	* lisp-kernel/image.c: Be fussy about word size, signedness. 
	(Needs more fussiness.)

2005-02-27 23:29  gb

	* lisp-kernel/imports.s: User PTR macro for imported addresses
	(word size issues.)

2005-02-27 23:28  gb

	* lisp-kernel/m4macros.m4: Tweak FUN .stabs handling, to make fussy
	assemblers (that can't be discussed in public yet) happy.

2005-02-27 23:23  gb

	* lisp-kernel/pantherg5/Makefile: no more pantherg5 stuff

2005-02-27 23:20  gb

	* lisp-kernel/spjump.s: Force 12 bit alignment.  (See if this
	breaks Linux.)

2005-02-27 23:18  gb

	* level-1/l1-streams.lisp: Remove obsolete INSTANCE-INITIALIZE
	methods.

2005-02-27 15:25  bryan

	* lib/format.lisp: width parameter <=0 passed to ~f format
	directive should act as if it never was specified.  previously
	(when 0) would loop.

2005-02-25 20:21  gb

	* lib/ccl-export-syms.lisp: Export WITH-POINTER-TO-IVECTOR from
	CCL; export a few missing things from OPENMCL-MOP.

2005-02-25 20:20  gb

	* lib/macros.lisp: WITH-POINTER-TO-IVECTOR.

2005-02-25 20:18  gb

	* level-0/l0-pred.lisp: Add UVECTORP & IVECTORP; make them type
	predicates.

2005-02-25 19:40  gb

	* level-0/PPC/ppc-misc.lisp: Handle the DOUBLE-FLOAT case(es) in
	%VECT-DATA-TO-MACPTR.

2005-02-25 19:36  gb

	* level-1/l1-streams.lisp: %MAKE-HEAP-IVECTOR: element count not
	optional.

2005-02-25 18:00  gb

	* level-1/version.lisp: Bump.

2005-02-25 17:59  gb

	* lisp-kernel/lisp-debug.c: Add an 'extern' to definition of
	debug_command_entries[].  In lisp_debugger(), define 'state' before
	executable body.

2005-02-25 17:57  gb

	* compiler/PPC/ppc-arch.lisp: A few name changes, for consistency
	with kernel notion of kernel-globals.

2005-02-25 17:56  gb

	* examples/: objc-clos.lisp, objc-support.lisp: Handle changes to
	DEFCLASS's processing of random slot options (:FOREIGN-TYPE).

2005-02-25 17:55  gb

	* lib/macros.lisp: DEFCLASS: only collect random slot option values
	into a list if option was provided more than once.

2005-02-25 17:52  gb

	* level-1/l1-clos.lisp: Preserve values of class slots (:ALLOCATION
	:CLASS) during class redefinition.

2005-02-25 17:51  gb

	* level-1/l1-boot-2.lisp: Bind *LOADING-FILE-SOURCE-FILE* around
	calls to %FASLOAD.

2005-02-25 17:50  gb

	* level-1/l1-init.lisp: Define *LOADING-FILE-SOURCE-FILE*
	elsewhere.

2005-02-25 17:49  gb

	* level-0/l0-init.lisp: Define *LOADING-FILE-SOURCE-FILE* here.

2005-02-25 17:48  gb

	* level-0/l0-misc.lisp: Kernel globals in PPC (not PPC32) package.

2005-02-25 17:44  gb

	* level-1/: l1-pathnames.lisp, l1-boot-1.lisp,
	l1-lisp-threads.lisp: Kernel globals in PPC (not PPC32) package.

2005-02-23 01:01  bryan

	* level-1/version.lisp: bump.

2005-02-22 16:24  gb

	* lisp-kernel/spentry.s: Load f1 from the right stack offset when
	returning from EABI callback.

2005-02-22 16:01  gb

	* lisp-kernel/spentry.s: All callback variants try to return values
	in r3, r4, and f1.

2005-02-22 15:59  gb

	* lib/macros.lisp: Handle float returns in callbacks (needs related
	kernel changes; untested on Linux.)

2005-02-22 13:26  bryan

	* lib/pprint.lisp: when *pretty-print* and *print-base* > 10, use
	the slightly slower #'write-a-symbol to properly determine
	potential numbers.

2005-02-22 13:22  bryan

	* level-1/l1-io.lisp: use *print-base*, not *read-base*, when
	deciding whether to quote a potential number.

2005-02-20 18:47  bryan

	* lib/format.lisp: handle ~v when nil for ~{...~}

2005-02-20 16:25  bryan

	* level-1/version.lisp: bump.  use this version to check for
	stream-external-format being a generic function.

2005-02-20 16:24  bryan

	* level-1/l1-sysio.lisp: rewrite stream-external-format as a
	generic function.

2005-02-20 15:36  bryan

	* lib/format.lisp: treat ~vr as ~r when arg is nil.  per clhs 22.3.

2005-02-20 13:33  bryan

	* level-1/l1-streams.lisp: remove unused code: (defmethod
	file-stream-external-format ((s broadcast-stream))

2005-02-20 03:08  bryan

	* level-1/version.lisp: bump.

2005-02-20 03:05  bryan

	* lib/format.lisp: treat ~v[...~] as ~[...~] when arg is nil.  per
	clhs 22.3.

2005-02-19 19:13  bryan

	* lib/arrays-fry.lisp: somebody misses printf.. format uses ~ and
	not %.

2005-02-19 16:51  bryan

	* lib/format.lisp: reverse ~:@C printing per clhs: "~:@C prints
	what ~:C would, and then if the character requires unusual  shift
	keys on the keyboard to type it, this fact is mentioned."

2005-02-19 15:34  bryan

	* level-1/l1-reader.lisp: add Fs (file separator), Gs (group
	separator), Rs (record separator), and Us (unit seperator) to
	*name-char-alist*.
	
	#\Fs to avoid printing something unescaped #\^\, the others for
	completeness.  the extra four entries in the alist shouldn't have
	any noticeable effect.
	
	probably could fix the printer (and reader?) to handle the escaped
	case, but i like seeing the textual representation.

2005-02-19 14:29  bryan

	* lib/format.lisp: when printing a number with a sign and padding,
	print padding first and then the sign.

2005-02-18 22:42  bryan

	* level-1/version.lisp: bump for #A changes.

2005-02-18 16:19  bryan

	* lib/read.lisp: rewrite #A dispatch handler to allow for all types
	of sequences (bitfields, strings, vectors, lists) when they make
	sense for the supplied rank.

2005-02-17 17:02  gb

	* examples/: objc-readtable.lisp, objc-runtime.lisp: Observe
	*READ-SUPPRESS* in reader macros.

2005-02-16 18:42  bryan

	* tools/asdf.lisp: hook asdf into *module-provider-functions*.

2005-02-16 16:15  bryan

	* level-1/version.lisp: bump.

2005-02-16 14:09  bryan

	* compiler/nx-basic.lisp, compiler/nx.lisp, compiler/nx0.lisp,
	compiler/PPC/ppc-disassemble.lisp, compiler/PPC/ppc-lapmacros.lisp,
	level-0/l0-aprims.lisp, level-0/l0-array.lisp, level-0/l0-def.lisp,
	level-0/l0-float.lisp, level-0/l0-hash.lisp, level-0/l0-init.lisp,
	level-0/l0-misc.lisp, level-0/l0-numbers.lisp,
	level-0/l0-pred.lisp, level-0/l0-symbol.lisp,
	level-0/PPC/ppc-pred.lisp, level-1/l1-aprims.lisp,
	level-1/l1-boot-1.lisp, level-1/l1-clos-boot.lisp,
	level-1/l1-error-signal.lisp, level-1/l1-error-system.lisp,
	level-1/l1-files.lisp, level-1/l1-init.lisp, level-1/l1-io.lisp,
	level-1/l1-numbers.lisp, level-1/l1-pathnames.lisp,
	level-1/l1-reader.lisp, level-1/l1-readloop-lds.lisp,
	level-1/l1-readloop.lisp, level-1/l1-streams.lisp,
	level-1/l1-symhash.lisp, level-1/l1-sysio.lisp,
	level-1/l1-typesys.lisp, level-1/l1-utils.lisp,
	level-1/sysutils.lisp, lib/apropos.lisp, lib/arrays-fry.lisp,
	lib/chars.lisp, lib/defstruct-lds.lisp, lib/defstruct.lisp,
	lib/describe.lisp, lib/encapsulate.lisp, lib/format.lisp,
	lib/hash.lisp, lib/lists.lisp, lib/macros.lisp, lib/misc.lisp,
	lib/nfcomp.lisp, lib/numbers.lisp, lib/pathnames.lisp,
	lib/pprint.lisp, lib/read.lisp, lib/sequences.lisp, lib/setf.lisp,
	lib/sort.lisp, lib/streams.lisp, lib/time.lisp, library/loop.lisp:
	add docstrings to the majority of common-lisp-user symbols starting
	with a snapshot of those found in SBCL 0.8.18.

2005-02-16 13:34  bryan

	* tools/asdf-install/: COPYRIGHT, load-asdf-install.lisp,
	split-sequence.lisp: initial repository version from 050201 import.

2005-02-16 13:29  bryan

	* level-1/l1-reader.lisp: unmatched ') when
	ccl::*ignore-extra-close-parenthesis* is nil should signal a
	reader-error.
	
	the default for ccl::*ignore-extra-close-parenthesis* remains t. 
	set it to nil in your init file for maximum ansi-compliance.

2005-02-16 13:12  bryan

	* tools/: README-OpenMCL.txt, asdf-install/README,
	asdf-install/asdf-install.asd, asdf-install/defpackage.lisp,
	asdf-install/installer.lisp, asdf-install/port.lisp,
	asdf-install/doc/index.html: sync with latest asdf-install code.

2005-02-16 12:53  bryan

	* tools/asdf.lisp: import latest ASDF from clocc repository.
	
	identical (besides revision number) to asdf.lisp found in SBCL
	0.8.18.

2005-02-16 12:50  bryan

	* xdump/xfasload.lisp: turn on *save-doc-strings* and
	*fasl-save-doc-strings*.

2005-02-16 12:45  bryan

	* level-1/l1-reader.lisp: ccl::%unreadable should signal a
	reader-error.
	
	ccl::%unreadable is called when the reader encounters #<, #), or
	#<whitespace>.

2005-02-16 12:44  bryan

	* lib/read.lisp: ## when *read-suppress* should return nil, not
	(values).

2005-02-16 12:43  bryan

	* level-1/l1-reader.lisp: #nr shouldn't type-check n when
	*read-suppress*.

2005-02-16 12:42  bryan

	* level-1/l1-reader.lisp: #( when *read-suppress should ignore
	array length problems.

2005-02-16 12:41  bryan

	* lib/read.lisp: rewrite #* handler
	
	#* must signal a reader-error if any of the token characters are
	not 0 or 1.  previously it would stop at the first character that
	was not 0 or 1.  single- and multi-escape are not allowed in the
	token for #*.
	
	#n* when n > 0 must have at least one element.	the number of
	elements can not exceed n.
	
	except if *read-suppress*, then anything goes until the next
	whitespace or terminating macro.

2005-02-16 12:39  bryan

	* level-1/l1-reader.lisp: more occurrences where error should be a
	reader-error.

2005-02-16 12:35  bryan

	* level-1/l1-streams.lisp: fill in some missing methods for
	echo-streams and concatenated-streams.
	
	  (defmethod stream-read-char-no-hang ((s echo-stream))
	  (defmethod stream-read-byte ((s echo-stream))
	  (defmethod stream-read-line ((s echo-stream))
	  (defmethod stream-read-vector ((s echo-stream) vector start end)
	
	  (defmethod stream-read-char-no-hang ((s concatenated-stream))
	  (defmethod stream-peek-char ((s concatenated-stream))
	  (defmethod stream-read-line ((s concatenated-stream))
	  (defmethod stream-read-list ((s concatenated-stream) list count)
	  (defmethod stream-read-vector ((s concatenated-stream) vector
	start end)

2005-02-16 12:31  bryan

	* level-0/l0-symbol.lisp, level-0/nfasload.lisp,
	level-1/l1-symhash.lisp: ccl::hash-pname loses when given a
	non-simple-string
	
	find-all-symbols did no checking and didn't massage.  added a
	ccl::ensure-simple-string to both check and massage.
	
	make-symbol checked that the arg was a 'simple-string using
	#'require-type.  replacing that with ccl::ensure-simple-string both
	checks and massages.
	
	ccl::pkg-arg (called by a bunch of symbol iterator macros) did
	check that if the arg was a string, that it was a simple string.  i
	rewrote the initial if form as a cond that will call
	ccl::ensure-simple-string if the arg is indeed a string.
	
	also updated ccl::new-package-name.

2005-02-16 12:22  bryan

	* lib/backquote.lisp: comma not inside backquote should signal
	reader-error.

2005-02-16 12:20  bryan

	* level-1/l1-reader.lisp: if *read-suppress*, return NIL from
	read(-*) forms.

2005-02-16 12:19  bryan

	* level-1/l1-io.lisp: adjustable arrays should print readably when
	*print-array* (per clhs 22.1.3.7-8)

2005-02-16 12:16  bryan

	* lib/pprint.lisp: don't declare dynamic-extent for the unused args
	passed to (funcall (formatter "~A") ..) which end up being returned
	to the caller.

2005-02-16 12:11  bryan

	* lib/apropos.lisp: "" is a substring to all strings, update
	%apropos-substring-p to explicitly check for that and return t
	before doing any more work.

2005-02-16 12:09  bryan

	* level-1/l1-utils.lisp: a string-designator can also be a
	singleton character, update string-argp to reflect that.

2005-02-16 12:05  bryan

	* lib/macros.lisp: typecase was always pushing the t clause (if
	present) to the end of the clauses.  i suspect that most cases when
	it appears before the end, the user intended for it to be
	equivalent to a final OTHERWISE clause.  hopefully the warning
	messages about later clauses being shadowed will be sufficient to
	alert them.  as an added benefit it dead-code strips any cases
	following a t-clause.
	
	finally it now correctly raises an error if OTHERWISE (if present)
	is not the final clause.

2005-02-16 11:56  bryan

	* lib/sequences.lisp: ccl::simple-vector-delete loses with
	displaced arrays with a displaced-index-offset > 0.
	
	the second loop (looping through the scratch bit vector) to copy
	the items that survive into the new array misuses the offset with
	the bit vector.  this causes an array out of bounds error.  instead
	it should use the offset with the original array to reference the
	item.
	
	the third loop which copies the remaining items that were
	explicitly excluded from the test also needs the offset to copy the
	right items.

2005-02-16 11:52  bryan

	* lib/format.lisp: allow mincol, minpad in format directives to be
	negative.

2005-02-16 11:46  bryan

	* lib/format.lisp: non-list args in ~{..~} format directive should
	signal type-error.

2005-02-16 11:41  bryan

	* level-1/l1-format.lisp: allow #\+ in format directives.

2005-02-16 11:40  bryan

	* compiler/PPC/ppc-lap.lisp: modify defppclapfunction to accept a
	docstring.

2005-02-16 00:24  bryan

	* lib/macros.lisp: don't update index if with-input-from-string
	exits abnormally.

2005-02-16 00:17  bryan

	* lib/setf.lisp: spec says that the long form of defsetf encloses
	the body in a block named after the access function.
	
	defsetf was doing the wrong thing and putting the block around the
	eventual setf-expansion instead of the body that's evaluated to
	generate the setf-expansion.
	
	defsetf should also return the name of the access-fn and not the
	doc string.

2005-02-15 19:23  bryan

	* level-1/l1-reader.lisp: accept #:. per CLHS and ansi-test
	SYNTAX.SHARP-COLON.7

2005-02-15 19:14  bryan

	* level-0/l0-hash.lisp: %hash-table-equalp uses :test arg instead
	of equalp.
	
	spec says: equalp descends hash-tables by first comparing the count
	of entries and the :test function; if those are the same, it
	compares the keys of the tables using the :test function and then
	the values of the matching keys using equalp recursively.

2005-02-15 19:04  bryan

	* level-1/l1-reader.lisp: suppress unused lexical variable warning
	in #: handler

2005-02-15 18:58  bryan

	* level-1/l1-io.lisp: clhs 22.1.3.8 says an array is printed
	started with #A.

2005-02-15 18:52  bryan

	* level-1/l1-io.lisp: clhs 22.1.3.1.4 says a complex number is
	printed started with #C.

2004-10-27 00:56  gb

	* lisp-kernel/lisp-exceptions.c: Hacks to keep fp exceptions
	enabled after pthread_kill() on Darwin.
	
	Allways enable fp exceptions when calling back into lisp.

2004-10-26 23:28  gb

	* lisp-kernel/asmutils.s: back out of earlier change, now that
	signal_handler calls get_interrupt_tcr

2004-10-26 23:23  gb

	* lisp-kernel/lisp-exceptions.c: Use get_interrupt_tcr() in
	signal_handler on linux.

2004-10-26 23:22  gb

	* lisp-kernel/thread_manager.c: get_interrupt_tcr() takes a
	"create-p" argument, like some callers thought it did.

2004-10-26 22:51  gb

	* lisp-kernel/: asmutils.s, lisp-exceptions.c: play around with r2
	when zeroing FPSCR

2004-10-06 16:44  gb

	* examples/: cocoa-editor.lisp, cocoa-listener.lisp,
	cocoa-typeout.lisp: Alex Crain's patches (paste in listener,
	typeout window size)

2004-10-01 05:03  gb

	* level-1/l1-clos.lisp: if a CERROR offers to change the class of
	an existing GF, actually call CHANGE-CLASS to do so

2004-09-25 18:38  gb

	* level-1/l1-clos.lisp: Use a real SHARED-INITIALIZE after CLOS is
	bootstrapped.  Default superclasses based on metaclass, in
	(SHARED-INITIALIZE :AFTER) method on SLOTS-CLASS.  Don't add use
	:INITARGS for most SLOTS-CLASS slots (the initargs to
	SHARED-INITIALIZE :AFTER should generally set them to computed
	values.) Make sure that the right version of UPDATE-SLOTS is
	committed.

2004-09-25 18:31  gb

	* level-1/l1-dcode.lisp: New support for funcallable instances,
	from Tim Moore.

2004-09-25 18:31  gb

	* level-1/l1-clos-boot.lisp: INSTANCE-SLOTS knows where to find
	slots in funcallable instances that aren't GF's (from Tim Moore.)

2004-09-25 15:38  gb

	* level-1/l1-lisp-threads.lisp: Use %HEAP-IVECTOR-P when checking
	bogosity.

2004-09-25 15:37  gb

	* level-1/l1-streams.lisp: Kinder, gentler heap-ivector stuff.	Use
	it.

2004-09-25 15:37  gb

	* level-1/version.lisp: Bump.

2004-09-25 15:36  gb

	* lib/ccl-export-syms.lisp: Export MAKE-HEAP-IVECTOR and
	DISPOSE-HEAP-IVECTOR.

2004-09-25 15:35  gb

	* lisp-kernel/darwin/Makefile, lib/macros.lisp: DEFCLASS macro:
	handle :DOCUMENTATION as a single option, if provided.	Don't
	default superclasses (from Tim Moore.).  Pass class name, not
	class, in :METACLASS option.

2004-09-25 15:16  gb

	* level-0/PPC/ppc-misc.lisp: FUDGE-HEAP-POINTER: user clrrwi to
	clear three bits.

2004-09-25 15:15  gb

	* hemlock/src/macros.lisp: WITH-POPUP-DISPLAY: use typeout-stream
	(from Alex Crain.)

2004-09-25 15:14  gb

	* hemlock/src/interp.lisp: Indentation change.

2004-09-25 15:13  gb

	* examples/cocoa-editor.lisp: Send backtrace info to typeout window
	on error (from Alex Crain.)

2004-09-25 15:12  gb

	* examples/cocoa-window.lisp: Typeout-window changes, from Alex
	Crain.

2004-09-25 15:08  gb

	* examples/cocoa-typeout.lisp: New file, from Alex Crain

2004-09-25 15:08  gb

	* examples/bridge.lisp: Fixes to COERCE-TO-FOREIGN-TYPE, from
	Randall Beer.

2004-09-25 15:07  gb

	* OpenMCL.app/Contents/Resources/English.lproj/MainMenu.nib/:
	classes.nib, info.nib, objects.nib: Changes from Alex Crain, for
	typeout window.

2004-09-25 15:07  gb

	* OpenMCL.app/Contents/Resources/English.lproj/.cvsignore: new file

2004-09-19 17:21  gb

	* lisp-kernel/lisp-exceptions.c: use thread_abort_safely() when
	suspending Mach threads

2004-09-13 01:26  gb

	* lisp-kernel/thread_manager.c: wait_on_semaphore: return
	KERN_OPERATION_TIMED_OUT if wait was aborted and we'd timed out
	anyway.  suspend_tcr: use mach_suspend_tcr() preferentially on
	Darwin.

2004-09-13 01:21  gb

	* lisp-kernel/lisp-exceptions.c: mach_resume_tcr: it would be a
	good idea to actually resume the thread, not just do the
	bookkeeping (a call to thread_resume() was missing.)

2004-08-30 16:20  gb

	* examples/cocoa-editor.lisp: Lots of changes, mostly:
	
	- try to speed up callbacks that fetch characters from the virtual
	nsstring - kill echo-area buffers when closing windows - windows
	should be released when closed; documents should close when the  
	last window closes.  - try not to invalidate the buffer cache on
	insertions - disable background layout before closing the window
	(in case that's still	going on ...) - clear the buffer's modified
	state when buffer is saved (not sure if the   modeline indicator's
	updated correctly) - DISABLE-BLINK tells the layout manager to
	force redisplay of the (now   non-blinking) character.

2004-08-30 15:59  gb

	* examples/objc-runtime.lisp: Assert that SELF is an instance in
	instance method (should also assert that :ID-typed parameters are
	instances/classes.)

2004-08-30 15:58  gb

	* examples/objc-clos.lisp: set pointer types directly

2004-08-30 15:33  gb

	* examples/: cocoa-listener.lisp, cocoa-window.lisp: Use (THE ...)
	to help the bridge resolve some messages.

2004-08-30 15:31  gb

	* hemlock/src/modeline.lisp: Use DEFPARAMETER to initialize
	*DEFAULT-MODELINE-FIELDS*, so it's a little easier to redefine.

2004-08-30 15:30  gb

	* hemlock/src/lispmode.lisp: Wrap some of the indentation code in a
	MODIFYING-BUFFER, to defer display updates. (This is experimental,
	and should probably be made more general.)

2004-08-30 15:29  gb

	* hemlock/src/interp.lisp: Don't be quite so eager to clear the
	echo area, especially when it's the current buffer.

2004-08-30 15:25  gb

	* lib/foreign-types.lisp: Make (:* T) be shorthand for (:* :VOID). 
	May lead to (benign) redefinition warnings.

2004-08-30 15:25  gb

	* level-1/l1-init.lisp: Remove some FRED-isms.

2004-08-30 15:22  gb

	* level-0/l0-aprims.lisp: DEREFERENCE-BASE-STRING: third return
	value is just the length (not length + displacement).

2004-08-10 18:54  gb

	* level-1/l1-readloop.lisp: Check for local macro functions (and
	complain if FUNCTION references them) in cheap evaluator.
	
	Pass a function and other information to *MACROEXPAND-HOOK* when
	expanding symbol-macros.

2004-08-10 18:19  gb

	* level-1/l1-clos.lisp: late version of %MAKE-METHOD-INSTANCE, from
	HEL

2004-08-06 01:40  gb

	* lib/pprint.lisp: distinguish finding NIL from not finding symbol
	in MAYBE-PRINT-FAST

2004-08-02 22:56  gb

	* examples/cocoa-editor.lisp: Remove subviews from hemlock-frame
	(window) before closing it.

2004-08-01 18:54  gb

	* examples/cocoa-editor.lisp: INIT-WITH-TEXT-STORAGE ->
	SET-TEXT-STORAGE (was initing twice.)

2004-07-31 17:52  gb

	* hemlock/src/: lispmode.lisp, lispbuf.lisp:
	package-name-change-hook

2004-07-31 17:50  gb

	* hemlock/src/buffer.lisp: handle modeline update in
	%SET-BUFFER-MODIFIED

2004-07-31 17:44  gb

	* examples/objc-runtime.lisp: remove a debugging call to FORMAT

2004-07-31 17:43  gb

	* hemlock/src/modeline.lisp: modeline buffer-update zeal

2004-07-31 17:40  gb

	* level-1/l1-lisp-threads.lisp: *fake-stack-frames* is
	thread-specific, just in case

2004-07-31 17:39  gb

	* level-0/PPC/ppc-def.lisp: %%FRAME-BACKLINK: this isn't 0S7

2004-07-31 17:38  gb

	* level-1/l1-io.lisp: move %NEW-PTR here

2004-07-31 17:37  gb

	* level-0/l0-io.lisp: %new-ptr can't exist in level-0

2004-07-31 17:36  gb

	* lib/nfcomp.lisp: make-load-form for foreign-variable istruct

2004-07-31 17:35  gb

	* level-1/l1-files.lisp: fix dangling close paren

2004-07-25 19:15  gb

	* examples/rubix/: blocks.lisp, opengl.lisp, rubix.lisp: newer code
	from Hamilton

2004-07-23 16:15  gb

	* examples/rubix/: blocks.lisp, lights.lisp, loader.lisp,
	opengl.lisp, rubix.lisp, vectors.lisp: new files

2004-06-27 02:55  gb

	* examples/: cocoa-window.lisp, tiny.lisp: defer window creation

2004-06-27 02:55  gb

	* examples/objc-support.lisp: canonicalize classes referenced in
	type signatures

2004-06-27 02:55  gb

	* examples/bridge.lisp: class canonicalization, for resuming images

2004-06-27 02:55  gb

	* examples/finger.lisp: new version from Barry Perryman

2004-06-27 02:55  gb

	* examples/objc-runtime.lisp: early NSThread

2004-06-23 22:24  gb

	* level-1/linux-files.lisp: Remove a (debugging) call to FORMAT.

2004-06-23 11:32  gb

	* level-1/linux-files.lisp: New external-process waiting stuff.

2004-06-23 11:32  gb

	* level-1/l1-processes.lisp: Initial restarts have descriptive
	:report clauses.

2004-06-23 11:30  gb

	* level-1/l1-files.lisp: Gary King's fix to FIND-LOAD-FILE.

2004-06-23 11:30  gb

	* level-1/l1-error-system.lisp: INVOKE-RESTART-INTERACTIVELY works
	with SIMPLE-RESTARTs again.

2004-06-23 11:29  gb

	* level-1/l1-clos.lisp: UPDATE-SLOTS fix.

2004-06-15 03:40  gb

	* OpenMCL.app/Contents/MacOS/dppccl: added

2004-06-06 03:12  gb

	* level-1/linux-files.lisp: Don't sleep/poll while monitoring
	external process; signal completion via semaphore.

2004-06-06 03:11  gb

	* level-0/l0-cfm-support.lisp: Ignore NAME in
	SHLIB-CONTAINING-ADDRESS for Linux.

2004-06-06 00:01  gb

	* lisp-kernel/spentry.s: Ensure TSP valid before asserting
	lisp-mode in ffi return.

2004-06-06 00:00  gb

	* lisp-kernel/thread_manager.c: New post-gc freeing mechanism
	(suspened thread may own malloc lock.) Similar mechanism for TCR
	cleanup.

2004-06-05 23:59  gb

	* lisp-kernel/: gc.c, gc.h, lisp-exceptions.c: New post-gc freeing
	mechanism (suspened thread may own malloc lock.)

2004-06-05 23:57  gb

	* level-1/linux-files.lisp: Do external processes differently.

2004-06-05 23:57  gb

	* level-1/l1-boot-3.lisp: No periodic task for external processes.

2004-06-05 23:56  gb

	* level-1/l1-readloop-lds.lisp: Don't pass (%CURRENT-TCR) to
	stack-walking functions in break loop commands.

2004-06-05 23:55  gb

	* lib/describe.lisp: :prompt-function takes an argument.

2004-05-23 17:37  gb

	* level-1/linux-files.lisp: In GET-DESCRIPTOR-FOR, leave room for a
	#\Newline when copying an arbitrary input stream to a temporary
	file.

2004-05-08 14:21  gb

	* examples/cocoa.lisp: Define UI-OBJECT-DO-OPERATION for *NSApp*.

2004-05-08 14:20  gb

	* examples/objc-runtime.lisp: Use #?.  Find cfstrings in __const
	section, too.

2004-05-08 14:19  gb

	* examples/cocoa-window.lisp: Use #?.  SET THE UI OBJECT (lost in
	0.14.2 merge.)

2004-05-08 14:18  gb

	* examples/cocoa-listener.lisp: Use #?.

2004-05-07 10:56  gb

	* examples/cocoa-editor.lisp: Fix duplicate
	HI::SAVE-HEMLOCK-DOCUMENT.  Don't parse buffer unless we're looking
	at a paren when trying to determine blink location.

2004-05-07 02:23  gb

	* examples/objc-clos.lisp: Handle new issues with :foreign-type
	(non-standard slot options collect values into a list.)

2004-05-07 02:22  gb

	* level-1/version.lisp: Date tag for development.

2004-05-06 00:28  gb

	* compiler/PPC/ppc2.lisp, darwin-headers/cocoa/C/populate.sh,
	examples/cocoa-window.lisp, examples/cocoa.lisp,
	examples/objc-runtime.lisp, level-0/l0-cfm-support.lisp,
	level-0/l0-misc.lisp, level-0/PPC/ppc-symbol.lisp,
	level-1/l1-aprims.lisp, level-1/l1-boot-2.lisp,
	level-1/l1-clos-boot.lisp, level-1/l1-clos.lisp,
	level-1/l1-lisp-threads.lisp, level-1/l1-sockets.lisp,
	level-1/l1-utils.lisp, level-1/linux-files.lisp,
	level-1/ppc-trap-support.lisp, level-1/version.lisp,
	lib/arglist.lisp, lib/ccl-export-syms.lisp, lib/compile-ccl.lisp,
	lib/db-io.lisp, lib/edit-callers.lisp, lib/encapsulate.lisp,
	lib/foreign-types.lisp, lib/macros.lisp, lib/nfcomp.lisp,
	lib/systems.lisp, library/parse-ffi.lisp,
	lisp-kernel/pmcl-kernel.c, lisp-kernel/darwin/.gdb_history,
	lisp-kernel/darwin/Makefile, xdump/faslenv.lisp: incorporate 0.14.2
	changes

2004-05-02 01:28  gb

	* examples/cocoa-editor.lisp: save-as, open-document for Hemlock. 
	Fix off-by-one in paren-blinking; lock view focus when disabling
	blink to fix display glitch.

2004-05-02 01:27  gb

	* hemlock/src/filecoms.lisp: Use Cocoa for more file operations.

2004-04-30 20:34  gb

	* lib/macros.lisp: SETF shows arglist in error message, if odd
	length.

2004-04-30 20:34  gb

	* level-1/version.lisp: Bump the version.

2004-04-30 20:34  gb

	* hemlock/src/struct.lisp: Font-mark/font-region stuff.

2004-04-30 20:33  gb

	* hemlock/src/streams.lisp: Add a STREAM-WRITE-STRING method for
	echo area.

2004-04-30 20:32  gb

	* hemlock/src/morecoms.lisp: Don't call HI::MAYBE-UPDATE-SELECTION
	anymore.

2004-04-30 20:32  gb

	* hemlock/src/listener.lisp: New history, font-region stuff.

2004-04-30 20:31  gb

	* hemlock/src/lispmode.lisp: Arglist stuff.

2004-04-30 20:30  gb

	* hemlock/src/interp.lisp: Clear echo area on entry to command.

2004-04-30 20:30  gb

	* hemlock/src/htext3.lisp: Check buffer modification.

2004-04-30 20:30  gb

	* hemlock/src/htext2.lisp: Remove old selection-updating code (was
	unused.)

2004-04-30 20:29  gb

	* hemlock/src/font.lisp: Partial integration with new font-region
	stuff.

2004-04-30 18:53  gb

	* hemlock/src/: filecoms.lisp, files.lisp: Partial integration with
	Cocoa document handling.

2004-04-30 18:53  gb

	* hemlock/src/edit-defs.lisp: Still not working, but closer.

2004-04-30 18:52  gb

	* hemlock/src/command.lisp: Get rid of some (very) old code. 
	CENTER-TEXT-PANE via Cocoa.

2004-04-30 18:51  gb

	* hemlock/src/cocoa-hemlock.lisp: FONT-REGION stuff.

2004-04-30 18:51  gb

	* hemlock/src/bindings.lisp: arglist-on-space,
	current-function-arglist.

2004-04-30 18:50  gb

	* examples/: cocoa-editor.lisp, cocoa-listener.lisp: Lots-o-changes
	...

2004-04-30 18:49  gb

	* examples/cocoa-window.lisp: Synthesize obliqueness/boldness.

2004-04-30 13:58  gb

	* examples/objc-runtime.lisp: %MAKE-CONSTANT-NSSTRING when
	restoring constant NSStrings.

2004-04-19 13:31  gb

	* examples/cocoa-editor.lisp: Lots of changes/fixes: selection,
	view-size, scrolling, paren-matching, etc.

2004-04-19 13:30  gb

	* hemlock/src/cocoa-hemlock.lisp: Event-queue-node constructor.

2004-04-19 00:49  gb

	* level-1/l1-error-system.lisp: Don't use %CURRENT-TCR, in
	%LAST-FN-ON-STACK.

2004-04-13 13:26  gb

	* library/lispequ.lisp: New fields in backtrace context.

2004-04-13 13:26  gb

	* library/hemlock.lisp: Simple loader, for now.

2004-04-13 13:25  gb

	* level-1/version.lisp: Bump.

2004-04-13 13:25  gb

	* level-1/l1-lisp-threads.lisp, level-1/l1-readloop-lds.lisp,
	level-1/ppc-threads-utils.lisp, lib/backtrace-lds.lisp,
	lib/backtrace.lisp, lib/describe.lisp: New stack-walking scheme:
	pass optional backtrace context, not TCR.

2004-04-13 13:24  gb

	* hemlock/src/struct.lisp: region now per-buffer.

2004-04-13 13:23  gb

	* hemlock/src/streams.lisp: Less hysteria writing to echo-area
	stream.

2004-04-13 13:23  gb

	* hemlock/src/: pop-up-stream.lisp, rompsite.lisp: Remove some
	CLXisms.

2004-04-13 13:22  gb

	* hemlock/src/listener.lisp: Better EVAL-REGION.

2004-04-13 13:22  gb

	* hemlock/src/killcoms.lisp: Reorganize; new per-buffer
	active-region scheme.

2004-04-13 13:21  gb

	* hemlock/src/key-event.lisp: Immutable key-event (not dll-node.)

2004-04-13 13:21  gb

	* hemlock/src/htext3.lisp: Always delete current-region before
	insertion.

2004-04-13 13:20  gb

	* hemlock/src/echo.lisp: Don't call DISPLAYED-P.

2004-04-13 13:18  gb

	* hemlock/src/cursor.lisp: Remove a few CLXisms.

2004-04-13 13:18  gb

	* hemlock/src/command.lisp: Mark setup for new scheme.

2004-04-13 13:17  gb

	* hemlock/src/cocoa-hemlock.lisp: Key events are interned, so don't
	make them mutable.

2004-04-13 13:16  gb

	* hemlock/src/bindings.lisp: #k"Enter" evaluates region, not
	"defun".

2004-04-13 13:16  gb

	* examples/cocoa-editor.lisp: Lots-o-changes: double-click, paste,
	etc.

2004-04-13 13:15  gb

	* examples/objc-runtime.lisp: (Partial) fixes to struct-returning
	method definitions.

2004-04-13 13:14  gb

	* examples/cocoa-backtrace.lisp: Remove some commented-out code.

2004-04-12 13:29  gb

	* level-1/l1-sockets.lisp: Erik Pearson's SOCKET-ERROR
	changes/fixes.

2004-04-07 22:32  gb

	* OpenMCL.app/Contents/Resources/English.lproj/MainMenu~.nib/:
	classes.nib, info.nib, objects.nib: remove backup files

2004-04-07 21:49  gb

	* examples/objc-runtime.lisp: Call #_GetCurrentEventQueue before
	some other thread calls it ...	Make "void" NSThread early, to tell
	AppKit we're multi-threaded.

2004-04-07 21:46  gb

	* examples/cocoa-listener.lisp: Defaults changes.

2004-04-07 21:45  gb

	* examples/cocoa-editor.lisp: Defaults changes.  Support clipview
	around echo-area (horizontal scrolling).

2004-04-07 21:43  gb

	* examples/cocoa-defaults.lisp: Changes to support constraints,
	prefs dialog.

2004-04-07 21:42  gb

	* examples/cocoa-prefs.lisp: New file.

2004-04-07 21:41  gb

	* examples/cocoa-window.lisp: Require "COCOA-PREFS".  Doc string on
	defaults; handle showPreferences: message.

2004-04-07 21:38  gb

	* hemlock/src/cocoa-hemlock.lisp: Handle control-g (abort-event) in
	GET-KEY-EVENT.

2004-04-07 21:35  gb

	* OpenMCL.app/Contents/Resources/English.lproj/MainMenu.nib/:
	classes.nib, info.nib, objects.nib: Add showPreferences: action,
	connect Preferences item to it.

2004-04-02 23:08  gb

	* lisp-kernel/pmcl-kernel.c: Use readlink() to determine executable
	pathname under Linux.  Use PATH_MAX on	both platforms.

2004-04-02 22:53  gb

	* lisp-kernel/pmcl-kernel.c: Determine executable pathname (needs
	to use /proc on Linux.)

2004-04-02 22:53  gb

	* lisp-kernel/lisp-exceptions.c: Hysteresis in stack-overflow
	recovery.  (Needs testing.)

2004-04-02 22:52  gb

	* library/lispequ.lisp: Add bt.break-condition.

2004-04-02 22:51  gb

	* lib/describe.lisp: Break condition comes from context now.

2004-04-02 22:50  gb

	* lib/backtrace-lds.lisp: %ACTIVE-AREA is deprecated.

2004-04-02 22:49  gb

	* level-1/l1-readloop-lds.lisp: Backtrace context now contains the
	break condition.

2004-04-02 22:47  gb

	* level-1/l1-lisp-threads.lisp: Fencepost in %PTR-IN-AREA-P. 
	Deprecate (and remove some calls to) %ACTIVE-AREA, since stacks
	have been contiguous for a couple of years now ...

2004-04-02 22:44  gb

	* level-1/l1-clos.lisp: Check for circularities when checking for
	forward-referenced superclasses.  Redefine %ADD-METHOD as
	ADD-METHOD when we're able to.	ENSURE-CLASS-USING-CLASS of a
	forward-referenced class passes initargs to CHANGE-CLASS.

2004-03-27 18:51  gb

	* examples/: cocoa-editor.lisp, cocoa-listener.lisp: Umm,
	background color components are of type :float.

2004-03-27 04:08  gb

	* OpenMCL.app/Contents/Resources/English.lproj/lispeditor~.nib/:
	classes.nib, info.nib, objects.nib: remove backup files from CVS

2004-03-27 04:05  gb

	*
	OpenMCL.app/Contents/Resources/English.lproj/MainMenu.nib/objects.n
	ib: Not sure what changed, but IB found inconsistencies and wanted
	the .nib to be saved.

2004-03-27 03:59  gb

	* OpenMCL.app/Contents/Resources/English.lproj/MainMenu.nib/:
	info.nib, objects.nib: Not sure what changed, but IB found
	inconsistencies and wanted the .nib to be saved.

2004-03-27 03:58  gb

	* examples/cocoa-backtrace.lisp: Integration.

2004-03-27 03:58  gb

	* examples/cocoa-editor.lisp: Color stuff, redisplay changes.  Use
	a sheet to display error messages from Hemlock command threads.

2004-03-27 03:57  gb

	* examples/cocoa-listener.lisp: Color stuff; maintain backtrace
	contexts in threads.  Menu action functions, validation for
	interrupt and backtrace.

2004-03-27 03:55  gb

	* examples/cocoa.lisp: Require COCOA-BACKTRACE.  Move
	UI-DO-OPERATION here, implement backtrace operations.

2004-03-27 03:54  gb

	* examples/objc-runtime.lisp: Don't install deallocate hook, for
	the time being.

2004-03-27 03:53  gb

	* hemlock/src/cocoa-hemlock.lisp: Update the selection before
	grabbing the next key-event.  Timed-wait on next event, for
	EDITOR-SLEEP.

2004-03-27 03:52  gb

	* hemlock/src/htext1.lisp: lock/unlock the buffer (actually the
	gap-cache) when editing.

2004-03-27 03:52  gb

	* hemlock/src/htext2.lisp: MAYBE-UPDATE-SELECTION: doesn't do
	anything anymore; should be removed.

2004-03-27 03:51  gb

	* hemlock/src/killcoms.lisp: Active region vars are now
	symbol-macros.

2004-03-27 03:50  gb

	* hemlock/src/listener.lisp: *POP-STRING* needed a newline.

2004-03-27 03:50  gb

	* hemlock/src/macros.lisp: Use new error handler.

2004-03-27 03:50  gb

	* hemlock/src/rompsite.lisp: Make EDITOR-SLEEP kind of work.

2004-03-27 03:49  gb

	* hemlock/src/struct.lisp: Keep active region stuff in gap-cache.

2004-03-27 03:48  gb

	* level-1/l1-clos.lisp: Fix error message typo when allocating GFs.

2004-03-27 03:47  gb

	* level-1/l1-dcode.lisp: Don't set &allow-other-keys in GF lambda
	lists if method only says &key.

2004-03-27 03:45  gb

	* level-1/l1-files.lisp: Quote more chars when converting from
	native namestrings.

2004-03-27 03:45  gb

	* level-1/version.lisp: 040326.

2004-03-27 03:44  gb

	* lib/macros.lisp: Unknown slot options in DEFCLASS: use CDR, not
	CADR for option value.

2004-03-27 03:43  gb

	* level-1/linux-files.lisp: NANOSCECONDS: always return two
	integers.

2004-03-25 18:13  gb

	* level-0/PPC/ppc-float.lisp: %SET-FPSCR-CONTROL: maintain stack
	discipline.  Write zeroes to status fields as well, to avoid
	enabling a signaled exception.

2004-03-25 13:10  gb

	* OpenMCL.app/Contents/Resources/English.lproj/MainMenu.nib/:
	classes.nib, info.nib, objects.nib: Lisp menu

2004-03-24 20:28  gb

	* level-1/version.lisp: 040324.

2004-03-24 18:08  gb

	* compiler/dll-node.lisp: PROVIDE's been in the CL package for the
	last decade or so.  (This (small) change was made from a
	Hemlock/Cocoa editor !)

2004-03-24 18:07  gb

	* examples/cocoa-listener.lisp: EVAL-SELECTION ui methods.

2004-03-24 18:06  gb

	* examples/cocoa-editor.lisp: Update the buffer-cache after
	processing deletion notification.  MAKE-HEMLOCK-BUFFER makes the
	gap-context, used to make all buffers except echo area. 
	NSSTRING-TO-BUFFER needs to set up gap context.

2004-03-24 18:04  gb

	* hemlock/src/bindings.lisp: #k"enter", #k"c-m-x" bound to "Editor
	Evaluate Defun".

2004-03-24 18:03  gb

	* hemlock/src/listener.lisp: Eval-region via selection queue
	mechanism.

2004-03-24 18:03  gb

	* level-1/l1-clos-boot.lisp: Fix typo in error message
	(rededefining non-GF as GF.)

2004-03-24 10:26  gb

	* examples/cocoa-editor.lisp: Clean this up: put things in the
	right package.

2004-03-24 01:51  gb

	* examples/cocoa-editor.lisp: Use new gap-cache stuff.	Keep track
	of editing in textstorage; don't move point when editing.

2004-03-24 01:49  gb

	* examples/cocoa-listener.lisp: Get FDs right when starting a
	listener process.  Note package correctly.

2004-03-24 01:48  gb

	* hemlock/src/command.lisp: Transpose Characters - do it even if at
	line end (may be bugs in %SET-NEXT-CHARACTER.)

2004-03-24 01:47  gb

	* hemlock/src/htext1.lisp: New shared gap scheme.

2004-03-24 01:46  gb

	* hemlock/src/htext2.lisp: Use circumflex in mark printer. 
	%SET-NEXT-CHARACTER changes (still bugs here.)

2004-03-24 01:44  gb

	* hemlock/src/: struct.lisp, decls.lisp: New (shared) gap-cache
	stuff.

2004-03-24 01:43  gb

	* level-1/l1-streams.lisp: SELECTION-INPUT-STREAM fixes.

2004-03-23 23:34  gb

	* level-0/nfasload.lisp: Skip the alignment bytes when reading a
	(SIMPLE-ARRAY DOUBLE-FLOAT (*)).

2004-03-23 23:33  gb

	* lib/nfcomp.lisp: Skip the alignment bytes when writing a
	(SIMPLE-ARRAY DOUBLE-FLOAT (*)), but don't act as if they were
	included in the value returned by SUBTAG-BYTES.

2004-03-22 10:41  gb

	* examples/cocoa-editor.lisp: Process Hemlock commands in a
	per-frame thread.

2004-03-22 10:40  gb

	* examples/cocoa-listener.lisp: New listener
	process/selection-stream stuff.

2004-03-22 10:39  gb

	* examples/cocoa-window.lisp: Initialize UI object here.

2004-03-22 10:38  gb

	* examples/cocoa.lisp: UI object will be *NSApp*.

2004-03-22 10:38  gb

	* hemlock/src/bindings.lisp: Rearrange a bit.

2004-03-22 10:38  gb

	* hemlock/src/cocoa-hemlock.lisp: Maintain event queue in per-frame
	thread.

2004-03-22 10:37  gb

	* hemlock/src/edit-defs.lisp: Start to make this saner.

2004-03-22 10:37  gb

	* hemlock/src/htext1.lisp: Cache buffer gap variables in buffer,
	when passing buffer between threads.

2004-03-22 10:36  gb

	* hemlock/src/interp.lisp: Run a %COMMAND-LOOP (in a separate
	thread) after all.

2004-03-22 10:35  gb

	* hemlock/src/modeline.lisp: Major mode listed before others,
	always.

2004-03-22 10:35  gb

	* hemlock/src/listener.lisp: Hook for package change.  Use
	selection stream.

2004-03-22 10:34  gb

	* hemlock/src/key-event.lisp: Maintain key-events in doubly-linked
	lists.

2004-03-22 10:34  gb

	* hemlock/src/struct.lisp: Extra slots in BUFFER, to cache gap
	variables.

2004-03-22 10:33  gb

	* hemlock/src/ring.lisp: Lock rings while operating on them.

2004-03-22 10:32  gb

	* level-1/l1-boot-lds.lisp: MAKE-MCL-LISTENER-PROCESS changes.

2004-03-22 10:32  gb

	* level-1/l1-application.lisp: New file; define application class,
	subclasses.

2004-03-22 10:31  gb

	* level-1/l1-lisp-threads.lisp: NEW-TCR converts pointer to fixnum,
	even if sign bit set.

2004-03-22 10:30  gb

	* level-1/l1-processes.lisp: MAKE-PROCESS takes :CLASS argument.

2004-03-22 10:30  gb

	* level-1/l1-reader.lisp: All control chars, #\Space are
	whitespace.

2004-03-22 10:30  gb

	* level-1/l1-readloop-lds.lisp: toplevel loop changes.

2004-03-22 10:29  gb

	* level-1/l1-readloop.lisp: Move application stuff to
	l1-application.

2004-03-22 10:28  gb

	* level-1/l1-streams.lisp: Selection-stream stuff, apparently still
	buggy.

2004-03-22 10:27  gb

	* level-1/level-1.lisp: Load l1-application.

2004-03-22 10:27  gb

	* level-1/version.lisp: 040322.

2004-03-22 10:27  gb

	* lib/: compile-ccl.lisp, systems.lisp: Add l1-application.

2004-03-22 10:26  gb

	* OpenMCL.app/Contents/Info.plist: Change document classes to
	Hemlock*.

2004-03-22 04:12  gb

	* hemlock/src/decls.lisp: restored

2004-03-22 04:12  gb

	* hemlock/src/decls.lisp: accidental removal

2004-03-20 16:38  gb

	* level-1/version.lisp: Bump version to 040320.

2004-03-20 00:38  gb

	* examples/cocoa-editor.lisp: Handle key events in echo area.

2004-03-20 00:37  gb

	* examples/compile-hemlock.lisp: Revive kbdmac.

2004-03-20 00:37  gb

	* hemlock/src/rompsite.lisp: Remove more clx/tty stuff.

2004-03-20 00:36  gb

	* hemlock/src/kbdmac.lisp: Revive,  but don't create stream yet.

2004-03-20 00:35  gb

	* hemlock/src/: cocoa-hemlock.lisp, command.lisp, interp.lisp: More
	command-interpreter changes.

2004-03-19 11:39  gb

	* lisp-kernel/thread_manager.c: set foreign thread tcr back to NULL
	in tsd on exit

2004-03-18 17:48  gb

	* hemlock/src/streams.lisp: Bind current-buffer.  No real
	difference in output-buffering stuff.

2004-03-18 17:47  gb

	* hemlock/src/: main.lisp, rompsite.lisp: Remove/comment-out some
	unused stuff.

2004-03-18 17:47  gb

	* hemlock/src/interp.lisp: Use MESSAGE for editor-errors.  Call
	command-interpreter-info-function (for extended input stuff.)

2004-03-18 17:46  gb

	* hemlock/src/echo.lisp: Bind current-buffer when clearing echo
	area.

2004-03-18 17:44  gb

	* hemlock/src/command.lisp: Quoted-insert sets up command-info
	function.

2004-03-18 17:43  gb

	* hemlock/src/cocoa-hemlock.lisp: Command-information struct moves
	here; add function slot.

2004-03-18 17:43  gb

	* examples/cocoa-editor.lisp: Add echo-area stuff, start to use it.

2004-03-17 17:19  gb

	* lisp-kernel/thread_manager.c: Foreign thread exit on first
	cleanup call.  (Should all threads do so, after all ?)

2004-03-17 17:19  gb

	* level-1/l1-lisp-threads.lisp: Return NIL (not 0/%null-ptr) if no
	underlying pthread.

2004-03-17 17:18  gb

	* examples/cocoa-listener.lisp: Window-close on listener thread
	exit: don't wait around (deadlocks during QUIT.)

2004-03-17 08:43  gb

	* lisp-kernel/lisp-exceptions.c: Suspend other threads on entry to
	debugger (not on entry to Bug.)

2004-03-17 08:29  gb

	* lisp-kernel/lisp-debug.c: Suspend other threads on entry to
	debugger (not on entry to Bug.)

2004-03-17 08:29  gb

	* library/lispequ.lisp: Backtrace-info changes.

2004-03-17 08:28  gb

	* lib/describe.lisp: tsp/vsp ranges, for bogus-object detection.

2004-03-17 08:26  gb

	* level-1/l1-readloop-lds.lisp: Backtrace/break-loop changes.

2004-03-17 08:26  gb

	* level-1/l1-lisp-threads.lisp: LLGPL.	Fix some dynamic-binding
	stuff; ad-hoc scheme for bogus-thing check in (some) other threads.

2004-03-17 08:24  gb

	* level-0/PPC/ppc-def.lisp: %CATCH-TOP is always in the same place.

2004-03-17 08:23  gb

	* examples/cocoa-listener.lisp: No more *OPEN-EDITOR-DOCUMENTS*.

2004-03-17 08:22  gb

	* examples/cocoa-backtrace.lisp: Getting closer ...

2004-03-17 08:19  gb

	* examples/cocoa-window.lisp: Create an NSThread early.

2004-03-17 08:18  gb

	* examples/objc-runtime.lisp:
	%make-nsstring/%make-constant-nsstring.

2004-03-17 08:17  gb

	* OpenMCL.app/Contents/Resources/English.lproj/backtrace.nib/:
	classes.nib, info.nib, objects.nib: Smaller, striped ...

2004-03-12 06:24  gb

	* OpenMCL.app/Contents/Resources/English.lproj/backtrace.nib/:
	classes.nib, info.nib, objects.nib: add backtrace nib

2004-03-12 06:23  gb

	* examples/cocoa-backtrace.lisp: use nib

2004-03-08 12:36  gb

	* lisp-kernel/lisp-exceptions.c: Fix fatal_mach_error() prototype.

2004-03-08 07:02  gb

	* lisp-kernel/lisp-exceptions.c: Fix MACH_CHECK_ERROR.

2004-03-08 07:01  gb

	* library/lispequ.lisp: bt.stack-group -> bt.tcr

2004-03-08 07:00  gb

	* lib/describe.lisp: Add stack-inspector stuff.

2004-03-08 06:59  gb

	* level-1/l1-clos.lisp: SLOTS-CLASS has to look for primary-p-ness.

2004-03-08 06:58  gb

	* level-1/l1-clos-boot.lisp: Set GF lfun-bits if continued after
	congruency error.  SLOTS-CLASS has to look for primary-p-ness.

2004-03-08 06:56  gb

	* examples/cocoa-window.lisp: Factor in window creation.

2004-03-08 06:56  gb

	* examples/cocoa-editor.lisp: Factor out window creation.

2004-03-08 06:55  gb

	* examples/cocoa-backtrace.lisp: New file.  Doesn't work ...

2004-03-07 12:53  gb

	* lisp-kernel/pmcl-kernel.c: Parameterize MAXIMUM_MAPPABLE_MEMORY.

2004-03-07 12:53  gb

	* lib/level-2.lisp: No EVAL-REDEF for %newgotag.

2004-03-07 12:52  gb

	* compiler/nx1.lisp: No DEFNX1 for %newgotag.

2004-03-07 01:03  gb

	* lisp-kernel/constants64.h: Note that use of go/block tags is
	deprecated.

2004-03-07 01:03  gb

	* compiler/: nx0.lisp, nx1.lisp: Don't use dynamic block/go tags. 
	Forget about event-polling, etc.

2004-03-07 01:02  gb

	* compiler/PPC/ppc2.lisp: Don't use dynamic block/go tags.

2004-03-07 01:01  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp: Try to bring inline with
	constants64.[sh]

2004-03-07 00:55  gb

	* examples/cocoa-editor.lisp: Echo areas on windows.  Start the UI
	here when asked to.  Scroll windows.

2004-03-07 00:54  gb

	* examples/cocoa-defaults.lisp: Only synch if we added a new key.

2004-03-07 00:53  gb

	* examples/cocoa.lisp: APPLICATION-WILL-FINISH-LAUNCHING: start the
	UI.

2004-03-07 00:53  gb

	* hemlock/src/command.lisp: Window-scrolling changes.

2004-03-07 00:53  gb

	* hemlock/src/cursor.lisp: Let Cocoa scroll windows.

2004-03-07 00:52  gb

	* level-0/l0-misc.lisp: Per-thread stack-space calculated on a
	per-process basis.

2004-03-07 00:52  gb

	* level-1/l1-readloop-lds.lisp: BREAK-LOOP creates backtrace
	context, tells the application when it's valid.

2004-03-07 00:50  gb

	* level-1/l1-processes.lisp: *BACKTRACE-CONTEXTS* is bound
	per-thread.

2004-03-07 00:50  gb

	* level-1/ppc-threads-utils.lisp: Foreign thread initialization
	needs to emulate shallow per-thread binding.

2004-03-07 00:49  gb

	* level-1/version.lisp: 040307

2004-03-07 00:49  gb

	* lisp-kernel/thread_manager.c: Lock the area_lock while threads
	are suspended.	TCR cleanup frees tlb_pointer.

2004-03-07 00:48  gb

	* lisp-kernel/lisp-exceptions.c: darwin_exception_cleanup() frees
	native_thread_info (foreign exception state).

2004-03-07 00:37  gb

	* lisp-kernel/ppc_print.c: Careful with the use of ptr_from_lispobj
	in add_lisp_base_string.  Careful with the use of immheader_tag_p
	when printing vectors.

2004-03-06 03:10  gb

	* lisp-kernel/: Threads.h, area.h, constants64.h, gc.c, image.c,
	lisp-debug.c, lisp-exceptions.c, lisp-exceptions.h, lisptypes.h,
	macros.h, plbt.c, plsym.c, pmcl-kernel.c, ppc_print.c,
	thread_manager.c: Lots of PPC64 changes.  Move image_base to
	#x200000 on Darwin; reserve a little under 2GB by default.  Don't
	abort() if Mach exception-port stuff fails.

2004-03-06 03:04  gb

	* xdump/xfasload.lisp: Move image-base to #x200000 on Darwin.

2004-03-06 02:47  gb

	* examples/cocoa-defaults.lisp, examples/cocoa-editor.lisp,
	examples/cocoa-listener.lisp, hemlock/src/font.lisp,
	hemlock/src/listener.lisp, hemlock/src/rompsite.lisp: Random
	changes; still barely functional.

2004-03-03 16:27  gb

	* level-1/l1-clos.lisp: Define and use
	COMPUTE-CLASS-PRECEDENCE-LIST.	Flush initargs caches whenever
	class is finalized.

2004-03-03 15:20  gb

	* examples/objc-runtime.lisp: Uninstall dealloc-hook on
	*SAVE-EXIT-FUNCTIONS* (run before SAVE-APPLICATION), not
	*LISP-CLEANUP-FUNCTIONS* (so slot-vectors stay around during
	shutdown.)

2004-03-03 15:18  gb

	* examples/objc-clos.lisp: CRLF -> LF.

2004-03-03 15:01  gb

	* examples/cocoa-window.lisp: Require (and use) "COCOA-DEFAULTS".

2004-03-03 15:00  gb

	* examples/cocoa-listener.lisp: Wait until initial thread does
	CLOSE during listener thread cleanup.

2004-03-03 15:00  gb

	* examples/cocoa-editor.lisp: CLOSE message: close document before
	invoking SUPER method, not after.  Insertion/deletion fixes.

2004-03-03 14:56  gb

	* examples/cocoa-defaults.lisp: New file: maintain "defaults" via
	NSUserDefaults.

2004-03-03 14:53  gb

	* compiler/optimizers.lisp: fix %MAKE-DISPLACED-ARRAY call

2004-03-02 19:39  gb

	* lisp-kernel/spentry.s: Fix in destructuring-bind code.

2004-03-01 17:52  gb

	* hemlock/src/: main.lisp, modeline.lisp: Fix typos, start to
	introduce package-changed hooks.

2004-03-01 11:04  gb

	* lisp-kernel/thread_manager.c: Declare the right function in
	new_tcr().

2004-03-01 10:08  gb

	* lisp-kernel/: area.h, gc.c, image.c, imports.s, lisp_globals.h,
	pmcl-kernel.c, thread_manager.c: Use AREA_LOCK when accessing
	all_areas, unless we're early in bootstrapping.  Change the API,
	such as it is.	Need to ensure that readers/GC obey locking, as
	well.

2004-03-01 10:06  gb

	* level-1/l1-readloop.lisp: APPLICATION-UI-OBJECT stuff.

2004-03-01 10:06  gb

	* level-1/l1-readloop-lds.lisp: Notify "application-ui" on package
	change.

2004-03-01 10:05  gb

	* level-1/l1-lisp-threads.lisp: Don't terminate LISP-THREADs.

2004-03-01 10:05  gb

	* level-1/l1-clos-boot.lisp: DEFAULT-INITARGS: function follows
	form ...

2004-03-01 10:04  gb

	* level-1/l1-boot-lds.lisp: Use application-ui stuff to note
	initial package.

2004-03-01 10:03  gb

	* lib/macros.lisp: Invert order of initform/initfunction (FORM
	follows FUNCTION ? Nah ..) in canonicalized
	direct-default-initargs.

2004-03-01 10:02  gb

	* level-0/l0-int.lisp: Fix SIZE-VECT in bignum printer.

2004-03-01 10:01  gb

	* examples/cocoa-editor.lisp, examples/cocoa-listener.lisp,
	examples/cocoa-window.lisp, examples/cocoa.lisp,
	examples/compile-hemlock.lisp, hemlock/src/buffer.lisp,
	hemlock/src/listener.lisp, hemlock/src/modeline.lisp,
	hemlock/src/struct.lisp: More changes.	Every day, more changes. 
	(Listeners kind of work now.)

2004-02-29 07:56  gb

	* hemlock/src/bindings.lisp: Some listener-mode bindings.

2004-02-28 18:40  gb

	* hemlock/src/listener.lisp: Derived from lispbuf.lisp; barely
	differs yet.  Start to bring this code into the 90s.

2004-02-28 18:39  gb

	* hemlock/src/bindings.lisp: Some commented-out Listener-mode
	stuff.

2004-02-28 18:38  gb

	* hemlock/src/modeline.lisp: CR-terminated files have
	:EXTERNAL-FORMAT :MACOS, not :MAC.

2004-02-28 18:36  gb

	* examples/: cocoa-editor.lisp, cocoa-listener.lisp: Various
	changes.  Listeners still aren't functional.

2004-02-28 18:36  gb

	* examples/compile-hemlock.lisp: "listener" replaces "lispbuf".

2004-02-28 18:35  gb

	* compiler/optimizers.lisp: Bryan O'Connor's fix to
	COMP-MAKE-DISPLACED-ARRAY (make displacement explicit.)

2004-02-28 16:59  gb

	* level-1/l1-typesys.lisp: Fix typo, add more cases in
	CACHEABLE-CTYPE-P.

2004-02-28 02:24  gb

	* examples/hemlock-textstorage.lisp: Merge into cocoa-editor.lisp,
	remove this file.

2004-02-28 02:23  gb

	* hemlock/src/: bindings.lisp, cocoa-hemlock.lisp, filecoms.lisp,
	htext1.lisp, htext3.lisp, modeline.lisp, streams.lisp, struct.lisp:
	More changes for Cocoa Hemlock.

2004-02-28 02:22  gb

	* level-1/l1-typesys.lisp: Don't cache things involving certain
	MEMBER-CTYPEs.

2004-02-28 02:21  gb

	* level-1/: l1-streams.lisp, l1-sysio.lisp: stream ELEMENT-SHIFT
	fixes (from Bryan O'Connor.)

2004-02-28 02:20  gb

	* level-1/l1-error-system.lisp: INVOKE-RESTART recognizes simple
	restarts (from Bryan O'Connor.)

2004-02-28 02:19  gb

	* level-1/: l1-aprims.lisp, l1-utils.lisp: MAKE-ARRAY (and
	variants) track explicit array displacement (from Bryan O'Connor).

2004-02-28 02:16  gb

	* level-0/l0-array.lisp: ARRAY-DISPLACEMENT checks for explicit
	displacement (from Bryan O'Connor.)

2004-02-28 02:14  gb

	* level-0/l0-complex.lisp: Require NUMBER-MACROS at compile-time.

2004-02-28 02:14  gb

	* level-1/version.lisp: 0.14.2-040228.

2004-02-28 02:13  gb

	* lib/arrays-fry.lisp: ADJUST-ARRAY fixes (from Bryan O'Connor).

2004-02-28 02:12  gb

	* lib/macros.lisp: WITH-SIMPLE-RESTART change (from Bryan
	O'Connor).

2004-02-28 02:11  gb

	* library/lispequ.lisp: Define $arh_exp_disp_bit (from Bryan
	O'Connor).

2004-02-27 19:24  gb

	* OpenMCL.app/Contents/Info.plist: Try to persuade system to use
	openmcl icon for lisp documents.

2004-02-27 09:32  beer

	* examples/objc-clos.lisp: ObjC generic functions and methods for
	predefined ObjC messages mostly seem to work; support for
	conversion between ObjC records and Lisp structs (mostly from Gary)

2004-02-27 09:27  beer

	* examples/bridge.lisp: *TYPE-SIGNATURE-TABLE* now contains message
	descriptors; some new automatic type coercions for message
	arguments

2004-02-27 09:25  beer

	* examples/objc-runtime.lisp: UPDATE-TYPE-SIGNATURES-FOR-METHOD now
	takes a class as a second argument

2004-02-27 09:23  beer

	* examples/name-translation.lisp: Yet a few more new ObjC special
	words

2004-02-26 12:59  gb

	* lisp-kernel/thread_manager.c: (Hopefully) return NULL if
	semaphore_create() fails.

2004-02-26 12:58  gb

	* level-0/l0-aprims.lisp: Check return value from semaphore
	creation.

2004-02-26 12:57  gb

	* examples/cocoa-editor.lisp, examples/cocoa-listener.lisp,
	examples/cocoa-window.lisp, examples/hemlock-textstorage.lisp,
	hemlock/src/bindings.lisp, hemlock/src/buffer.lisp,
	hemlock/src/cocoa-hemlock.lisp, hemlock/src/filecoms.lisp,
	hemlock/src/htext1.lisp, hemlock/src/htext2.lisp,
	hemlock/src/htext3.lisp, hemlock/src/modeline.lisp,
	hemlock/src/struct.lisp, level-1/l1-readloop.lisp: QUIT typechecks
	arg before it's too late to do so.

2004-02-24 13:31  gb

	* examples/: cocoa-editor.lisp, cocoa-listener.lisp,
	cocoa-window.lisp, hemlock-textstorage.lisp: Start to use Hemlock
	for documents.

2004-02-24 13:30  gb

	* examples/objc-runtime.lisp: Use some other obscure way of
	initializing class before looking for methods (Panther).

2004-02-23 18:41  gb

	* examples/hemlock-textstorage.lisp, hemlock/src/bindings.lisp,
	hemlock/src/cocoa-hemlock.lisp, hemlock/src/command.lisp,
	hemlock/src/interp.lisp, hemlock/src/modeline.lisp,
	hemlock/src/struct.lisp: more changes.

2004-02-23 18:40  gb

	* examples/objc-runtime.lisp: method lookup: ensure class is
	initialized, via fairly obscure means.

2004-02-23 18:40  gb

	* examples/compile-hemlock.lisp: Add COCOA-HEMLOCK.

2004-02-23 18:39  gb

	* examples/cocoa-editor.lisp: require HEMLOCK-TEXTSTORAGE.  (Blows
	up during load ...).

2004-02-23 10:20  gb

	* examples/hemlock-textstorage.lisp, hemlock/src/bindings.lisp,
	hemlock/src/htext1.lisp, hemlock/src/htext2.lisp,
	hemlock/src/htext3.lisp, hemlock/src/htext4.lisp,
	hemlock/src/interp.lisp, hemlock/src/keysym-defs.lisp,
	hemlock/src/morecoms.lisp: Lots-o-changes.

2004-02-23 10:18  gb

	* examples/compile-hemlock.lisp: Reorganize; use FASL-CONCATENATE.

2004-02-23 10:18  gb

	* compiler/PPC/ppc2.lisp: Bugs in PPC2-%SET-BIT.

2004-02-21 18:41  gb

	* hemlock/src/keysym-defs.lisp: Learn to spell.  Learn what package
	we're in.

2004-02-21 18:40  gb

	* hemlock/src/keysym-defs.lisp: Learn to spell.

2004-02-21 18:27  gb

	* lisp-kernel/: area.h, bits.c, bits.h, constants.h, constants32.h,
	constants64.h, constants64.s, gc.c, gc.h, lisp-exceptions.h,
	lisp.h, lisp_globals.h, lisptypes.h, macros.h, macros.s, plsym.c,
	pmcl-kernel.c, spentry.s, darwin/.gdb_history, darwin/Makefile,
	pantherg5/Makefile: PPC64 changes (some of them rather suspect
	...).  32-bit kernel may be a little funky ...

2004-02-21 18:21  gb

	* examples/hemlock-textstorage.lisp: Lots of changes.  Still needs
	event-translation work (and lots of other things.)

2004-02-21 18:20  gb

	* examples/compile-hemlock.lisp: Fewer files.  More warnings ...

2004-02-21 18:19  gb

	* hemlock/src/: htext2.lisp, htext1.lisp: Maybe update the
	selection if the mark we move is the buffer's point.

2004-02-21 18:16  gb

	* hemlock/src/interp.lisp: Process single events.

2004-02-21 18:16  gb

	* hemlock/src/keysym-defs.lisp: Cocoa, not an RT.  (Still needs
	some work.)

2004-02-21 18:15  gb

	* hemlock/src/struct.lisp: Buffers maybe have text-storage, but no
	windows list.

2004-02-21 18:15  gb

	* hemlock/src/modeline.lisp: Move some modeline stuff here from
	window.lisp.

2004-02-21 18:14  gb

	* examples/objc-clos.lisp: Handle INITFUNCTION/INITARG case in
	SHARED-INITIALIZE.

2004-02-18 11:51  beer

	* examples/objc-clos.lisp: More (and different!) support for ObjC
	generic functions and methods

2004-02-16 03:41  gb

	* level-0/l0-float.lisp: ACOS of DOUBLE-FLOAT wants to
	(%MAKE-DFLOAT) the result.  Again.  Still.

2004-02-15 09:25  gb

	* lisp-kernel/thread_manager.c: Foreign threads linger, too.

2004-02-15 09:23  gb

	* examples/objc-support.lisp: Remove DBG trap in NS-EXCEPTION
	method.

2004-02-15 09:23  gb

	* examples/objc-runtime.lisp: Metaclass of user-defined class
	derived from class-name symbol, not foreign string.

2004-02-15 09:22  gb

	* examples/objc-clos.lisp: ALLOCATE-INSTANCE et al: install the
	instance's slot-vector if it has one.  Error out (don't just return
	nil) if instance slot-vector is missing.  Randall's fix to
	WRITER-METHOD-CLASS.

2004-02-15 09:20  gb

	* examples/process-objc-modules.lisp: Fix PROVIDE call.

2004-02-15 09:19  gb

	* examples/cocoa-window.lisp: Change PROCESS-INTERRUPT mechanism,
	since postEvent:atStart: doesn't seem to always do so from
	subthreads.

2004-02-15 09:17  gb

	* lib/number-case-macro.lisp: SINGLE-FLOAT, in *TYPE-TO-TYPECODE*.

2004-02-15 09:16  gb

	* lib/macros.lisp: WITH-OUTPUT-TO-STRING: don't quote element-type.

2004-02-15 09:14  gb

	* lib/backtrace-lds.lisp: OPCODE is in the ARCH package.

2004-02-15 09:10  gb

	* lib/dumplisp.lisp: No more quit-acknowledgement.

2004-02-15 09:10  gb

	* level-1/version.lisp: Date suffix for bleeding-edge version.

2004-02-15 09:10  gb

	* level-1/l1-readloop.lisp: No more "quit acknowledgement".

2004-02-15 09:08  gb

	* level-0/l0-float.lisp: pick up acos/asin fixes

2004-02-13 11:18  beer

	* examples/objc-clos.lisp: Some initial steps toward integrating
	ObjC methods into CLOS generic functions

2004-02-13 11:17  beer

	* examples/name-translation.lisp: Added a few more special ObjC
	words I've come across Removed old generic function name-mangling
	code, since we're no going that route

2004-02-12 00:22  gb

	* level-0/l0-float.lisp: ACOS: double-float case uses %MAKE-DFLOAT
	to allocate result.

2004-02-11 20:19  gb

	* lisp-kernel/pantherg5/Makefile: Start to conditionalize for
	PPC64, almost.

2004-02-11 20:17  gb

	* lisp-kernel/spentry.s: Fix a lot of the cases broken by removal
	of extract_2_lisptags_.

2004-02-11 20:16  gb

	* lisp-kernel/macros.s: More portability stuff; still a ways to go.

2004-02-11 20:15  gb

	* lisp-kernel/constants64.s: Flesh out a bit.

2004-02-11 20:15  gb

	* lisp-kernel/constants32.s: Don't suppress PPC64 defs of eabi
	stack frames.

2004-02-11 18:23  gb

	* lisp-kernel/constants.s: Hoist register names, etc into main
	file.

2004-02-11 12:01  gb

	* lisp-kernel/pantherg5/Makefile: Copy of regular Darwin Makefile,
	for starters.

2004-02-11 12:00  gb

	* lisp-kernel/darwin/Makefile: Beg the assembler to be
	AltiVec-aware.	Probably a better way.

2004-02-11 12:00  gb

	* lisp-kernel/spentry.s: Partly convert to 64-bit-maybeness.

2004-02-11 11:59  gb

	* lisp-kernel/macros.s: Parameterize more for ppc32/ppc64.

2004-02-11 11:59  gb

	* lisp-kernel/constants32.s: 32-bit platform constants.

2004-02-11 11:58  gb

	* lisp-kernel/constants.s: Include platform-specific constants
	file.

2004-02-11 11:58  gb

	* lisp-kernel/asmutils.s: Assume that the assembler is AltiVec
	aware in vector save/restore.  (Do we need vector save/restore ?)

2004-02-11 01:54  gb

	* lib/: compile-ccl.lisp, systems.lisp: add asdf, defsystem

2004-02-10 12:06  gb

	* compiler/nx-basic.lisp: VARIABLE-INFORMATION returns :SPECIAL if
	visible binding is proclaimed (but not declared) SPECIAL.

2004-02-10 11:39  gb

	* level-1/version.lisp: 0.14.1

2004-02-10 10:58  gb

	* lisp-kernel/sampler.c: was never used

2004-02-09 09:26  gb

	* level-1/l1-processes.lisp: ABORT-BREAK restart around process's
	initial function.

2004-02-09 09:22  gb

	* level-1/linux-files.lisp: Aargh.

2004-02-09 09:22  gb

	* level-1/l1-readloop.lisp: WITH-STANDARD-ABORT-HANDLING around the
	idle loop.

2004-02-09 01:34  gb

	* lisp-kernel/pmcl-kernel.c: egc back on

2004-02-09 01:33  gb

	* level-1/l1-files.lisp: fix error message on REQUIRE failure

2004-02-08 19:11  gb

	* level-0/PPC/ppc-float.lisp: %%SCALE-DFLOAT reserved 16 bytes on
	tsp, but used 24.

2004-02-07 23:08  gb

	* level-1/l1-pathnames.lisp: Add "ccl:tools;" to
	*MODULE-SEARCH-PATH*.

2004-02-07 23:08  gb

	* level-1/version.lisp: 040208, Alpha->Beta.

2004-02-07 22:58  gb

	* tools/README-OpenMCL.txt: New file.

2004-02-07 22:01  gb

	* tools/defsystem.lisp: imported from SourceForge clocc project
	HEAD as of 040207

2004-02-07 22:01  gb

	* tools/asdf.lisp: imported from SourceForge cclan project HEAD as
	of 040207

2004-02-07 21:57  gb

	* tools/asdf-install/: doc/index.html, Makefile, README,
	defpackage.lisp, digitool.lisp, installer.lisp, loader.lisp,
	port.lisp, .cvsignore, asdf-install.asd: imported from SourceForge
	cclan project HEAD as of 040207

2004-02-07 18:06  gb

	* level-1/l1-pathnames.lisp: Don't include "ccl:" or "home:" on
	*module-search-path*.  Do include "ccl:openmcl;modules;".

2004-02-07 18:01  gb

	* level-1/l1-init.lisp: *MODULE-FILE-ALIST* is gone.  Honest.

2004-02-07 18:00  gb

	* level-1/l1-files.lisp: Add a doc string for
	*MODULE-PROVIDER-FUNCTIONS*; reference it in the error message if
	REQUIRE fails.

2004-02-07 17:11  gb

	* level-1/l1-files.lisp: Incorporate Bryan O'Connor's changes to
	REQUIRE (with some changes.)

2004-02-07 17:10  gb

	* lib/ccl-export-syms.lisp: Remove *MODULE-FILE-ALIST*.  Add
	*MODULE-PROVIDER-FUNCTIONS*.

2004-02-07 17:09  gb

	* lib/dumplisp.lisp: Don't reference *MODULE-FILE-ALIST* anymore.

2004-02-07 15:20  gb

	* lib/macros.lisp: Define CCL::CONDITIONAL-STORE, for use by CLX
	(and maybe other things, if it learns how to decode more "places".)

2004-02-07 15:19  gb

	* level-0/l0-misc.lisp: Add STORE-GVECTOR-CONDITIONAL, to hide some
	represenatation details.

2004-02-07 14:59  gb

	* lib/level-2.lisp: %GET-DOUBLE-FLOAT and %GET-SINGLE-FLOAT: offset
	defaults to 0.

2004-02-07 14:58  gb

	* level-1/version.lisp: bump.

2004-02-07 14:58  gb

	* level-1/l1-utils.lisp: %GET-DOUBLE-FLOAT/%SET-DOUBLE-FLOAT were
	shadowed by later versions.

2004-02-07 14:57  gb

	* level-1/l1-readloop.lisp: Initial listener doesn't claim to be
	*INTERACTIVE-ABORT-PROCESS*.

2004-02-07 14:56  gb

	* level-1/l1-files.lisp: Don't call CHOOSE-FILE-DIALOG when looking
	for a module.

2004-02-07 14:55  gb

	* level-1/l1-events.lisp: New scheme to select process for SIGINT.

2004-02-07 14:54  gb

	* examples/objc-runtime.lisp: Revive objc-classes/methods when
	restarting an image.  Check appkit/foundation versions, print a
	message & exit if mismatch.  Find cfstring-containing library
	sections after loading appkit/foundation, and again on image
	startup.

2004-02-07 14:50  gb

	* examples/cocoa-window.lisp: Change comments.

2004-02-06 12:43  gb

	* examples/objc-runtime.lisp: REVIVIE-OBJC-CLASSES (mostly working,
	but needs to happen at the right time and needs to handle version
	mismatches.)

2004-02-06 12:42  gb

	* examples/objc-support.lisp: Don't call REMAP-OBJC-CLASSES on
	saved-application startup.

2004-02-06 12:41  gb

	* examples/process-objc-modules.lisp: No more
	REMAP-ALL-LIBRARY-CLASSES.

2004-02-06 12:40  gb

	* level-1/l1-boot-2.lisp: Replace *TERMINAL-INPUT-LOCK* with the
	new shared-resource scheme.

2004-02-06 12:39  gb

	* level-1/l1-boot-lds.lisp: MAKE-MCL-LISTENER-PROCESS: spawned
	process becomes "primary owner" of input stream, if it has an
	attached SHARED-RESOURCE.

2004-02-06 12:38  gb

	* level-1/l1-processes.lisp: Probably better to have PROCESS-WAIT
	sleep explicitly, so that it doesn't spend all of its time
	yielding.

2004-02-06 12:36  gb

	* level-1/l1-readloop-lds.lisp: Tweaks to the :Y command, to handle
	new shared-resource scheme.  Marco Baringer's :SET breakloop
	command, from almost a year ago.

2004-02-06 12:35  gb

	* level-1/l1-readloop.lisp: TOPLEVEL-FUNCTION manages the "shared
	resource" attached to the shared terminal-input stream.

2004-02-06 12:33  gb

	* level-1/l1-streams.lisp: INPUT-STREAMs may have a SHARED-RESOURCE
	attached to them; use it to manage terminal-input requests.

2004-02-06 12:32  gb

	* level-1/l1-typesys.lisp: Slot type predicates use CTYPEP, to
	(kind of) deal with (FUNCTION ...) types.

2004-02-06 12:30  gb

	* level-1/level-1.lisp: Load DLL-NODE a little earlier.

2004-02-06 12:30  gb

	* level-1/linux-files.lisp: SHARED-RESOURCEs, mostly for
	arbitrating access to CCL::*TERMINAL-INPUT*.  (May not work well,
	but neither did the old scheme.)

2004-02-06 12:28  gb

	* level-1/version.lisp: 040206.

2004-02-06 12:27  gb

	* lib/dumplisp.lisp: Do handshaking with initial thread before
	shutting down for SAVE-APPLICATION.

2004-02-06 12:27  gb

	* lib/macros.lisp: WITH-TERMINAL-INPUT changed slightly.

2004-02-06 12:26  gb

	* lisp-kernel/thread_manager.c: Keep the tcr around as long as
	possible (count down from PTHREAD_DESTRUCTOR_ITERATIONS).  Handle
	the case when a pthread can no longer reveive signals but the
	underlying Mach thread still exists, in suspend_tcr/resume_tcr.

2004-02-06 12:24  gb

	* lisp-kernel/lisp-exceptions.c: Provide mach_suspend_tcr(),
	mach_resume_tcr() so that threads can be suspended between
	pthread_exit() and their actual termination.

2004-02-06 11:57  gb

	* lisp-kernel/: constants.h, constants.s: Add shutdown_count field
	to tcr.

2004-02-02 09:22  gb

	* examples/objc-runtime.lisp: New
	OBJC-[CLASS,METACLASS,INSTANCE]-p, OBJC-OBJECT-P uses them.
	
	Install a callback to take over _dealloc responsibilities.  Doing
	so seems to sometimes trigger a hang on QUIT, where the initial
	thread never gets an interrupt.  Maybe memory corruption, maybe
	something else: need to check that (free) is the right way to free
	the object.

2004-02-02 09:15  gb

	* level-1/l1-error-system.lisp: Bryan O'Connor's change to
	INVOKE-RESTART: throw NIL if simple-restart/null fn.

2004-02-02 09:14  gb

	* level-1/l1-io.lisp: FUNCTION-IS-CURRENT-DEFINITION? knows about
	these new-fangled SETF function names.

2004-02-02 09:12  gb

	* level-1/l1-lisp-threads.lisp: Disable interrupts when accessing
	the termination queue; may need to inhibit GC as well.

2004-02-02 09:11  gb

	* level-1/l1-processes.lisp: REQUIRE-GLOBAL-SYMBOL checks the
	environment, too.

2004-02-02 09:11  gb

	* level-1/l1-readloop.lisp: Handshaking during
	QUIT/PREPARE-TO-QUIT; this is intended to work around a bug where
	#_pthread_kill seems to not deliver the signal to the target thread
	if the signaling thread (a) exits and (b) runs certain Cocoa
	tsd-cleanup routines.  (I.e., it's a mystery.)

2004-02-02 09:08  gb

	* level-1/l1-streams.lisp: Bryan O'Connor's change to FILE-LENGTH. 
	Default methods on some things that are supposed to TYPE-ERROR, not
	get a NO-APPLICABLE-METHOD.

2004-02-02 09:07  gb

	* level-1/version.lisp: 040202.

2004-02-02 09:06  gb

	* lib/ccl-export-syms.lisp: export %STR-FROM-PTR.  Don't export
	%STR-FROM-PTR-IN-SCRIPT, which doesn't exist.

2004-02-02 09:06  gb

	* lib/macros.lisp: Bryan O'Connor's fix to WITH-SIMPLE-RESTART. 
	LET-GLOBALLY moved here.

2004-02-02 09:01  gb

	* lisp-kernel/lisp-exceptions.c: Remove old vector-copying stuff.

2004-02-01 12:41  beer

	* examples/objc-clos.lisp: PRINT-OBJECT shouldn't die when given an
	OBJC-OBJECT whose ObjC part has "gone away"

2004-02-01 12:38  beer

	* examples/tiny.lisp: Use DEFCLASS and MAKE-INSTANCE

2004-02-01 12:37  beer

	* examples/bridge.lisp: Move toward the use of FIND-CLASS and
	CLASS-OF

2004-02-01 11:09  gb

	* lisp-kernel/: constants.h, thread_manager.c: Experimental change,
	to defer tcr cleanup.

2004-02-01 09:50  beer

	* examples/objc-clos.lisp: REMOVE-SLOT-INITARGS was dropping the
	last KEY/VALUE pair

2004-02-01 08:42  gb

	* examples/bridge.lisp: Ivar parsing follows different ruls for
	STRUCT than for *STRUCT; #\B is for :<BOOL>.  Now seems able to
	parse all Foundation/AppKit classes in 10.3.2.

2004-02-01 06:18  gb

	* examples/objc-support.lisp: NS-LISP-EXCEPTION has a lisp slot. 
	Now, to figure out a way to get rid of that ...

2004-02-01 06:17  gb

	* examples/: objc-clos.lisp, objc-runtime.lisp: More than one class
	can share the same metaclass.

2004-01-31 20:05  gb

	* lib/number-case-macro.lisp: Remove stale comment.

2004-01-31 20:04  gb

	* lib/foreign-types.lisp: Fix missing close-paren.

2004-01-31 19:55  gb

	* lib/foreign-types.lisp: Unparse :VOID, use keywords more
	consistently when unparsing.

2004-01-31 19:54  gb

	* library/lispequ.lisp: Fix DEF-ACCESSORS for VALUES-CTYPE.

2004-01-31 19:53  gb

	* lib/macros.lisp: PARSE-DEFGENERIC fix from Bryan O'Connor.

2004-01-30 21:34  gb

	* examples/bridge.lisp: PARSE-FOREIGN-STRUCT-OR-UNION-SPEC allows
	for anonymous fields.

2004-01-30 16:58  gb

	* lisp-kernel/pmcl-kernel.c: Don't enable EGC by default (so I can
	work on tuning it some ...)

2004-01-30 16:57  gb

	* level-1/l1-sysio.lisp: Handle BROADCAST-STREAMs, error out on
	other non-FILE-STREAMs.

2004-01-30 16:56  gb

	* level-1/l1-streams.lisp: Lots of nit-picking; BROADCAST-STREAM
	methods (at least partly) fixed to return value from last stream in
	list.

2004-01-30 16:54  gb

	* level-1/l1-sockets.lisp: Fix CLOSE call to LOCAL-SOCKET-FILENAME.

2004-01-30 16:53  gb

	* level-1/l1-reader.lisp: WHITESPACEP looks in readtable.

2004-01-30 16:52  gb

	* level-1/l1-io.lisp: FRESH-LINE uses STREAM-FRESH-LINE.

2004-01-30 16:51  gb

	* level-1/l1-files.lisp: IF-EXISTS: dialog nonsense.  PROBE-FILE
	checks WILD-PATHNAME-P, which moved here.

2004-01-30 16:49  gb

	* lib/pathnames.lisp: WILD-PATHNAME-P now earlier.

2004-01-30 16:48  gb

	* xdump/faslenv.lisp, lib/nfcomp.lisp: Bump fasl version.

2004-01-30 13:09  gb

	* examples/objc-clos.lisp: Lots of changes: foreign slot
	definitions have a :FOREIGN-TYPE; initarg is used to recognize
	them.  Foreign direct slot offset is (slightly encoded, for
	bitfields) relative slot offset, can be set by parsing ivars of
	predefined classes or from :FOREIGN-TYPE when setting
	(CLASS-DIRECT-SLOTS).  Effective-slot location set from class's own
	direct slot or from superclass direct slot.  The foreign "init.."
	method is called as part of ALLOCATE-INSTANCE, not (again) in
	SHARED-INITIALIZE.  ENSURE-CLASS-USING-CLASS tries to do what we
	mean, not what we say.	Hook into the guts of NSObjectDeallocate to
	note when an instance is deallocated (and remove its lisp
	slots-vector); still needs work.  Note that saving images with
	foreign classes in them still doesn't work.

2004-01-30 12:57  gb

	* examples/objc-runtime.lisp: Lots of changes: get rid of old
	DEF-OBJC-CLASS support, initialize predefined classes using CLOS
	(mostly).

2004-01-30 12:55  gb

	* examples/objc-support.lisp: Install predefined classes here.	Use
	DEFCLASS to create NS-LISP-EXCEPTION.

2004-01-30 12:51  gb

	* examples/process-objc-modules.lisp: MAP-OBJC-CLASS ->
	INSTALL-FOREIGN-OBJC-CLASS.

2004-01-30 12:49  gb

	* examples/: cocoa-editor.lisp, cocoa-inspector.lisp,
	cocoa-listener.lisp, cocoa-window.lisp, cocoa.lisp,
	hemlock-textstorage.lisp: Used DEFCLASS to creat classes,
	SLOT-VALUE or an accessor to access slots.

2004-01-30 12:48  gb

	* examples/bridge.lisp: Parse instance-var type strings differently
	from arg type strings.

2004-01-30 12:46  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: Use CMPD vice CMPW.  (1
	down, a few hundred to go.)

2004-01-30 12:45  gb

	* level-1/version.lisp: 040130

2004-01-30 12:44  gb

	* level-1/l1-utils.lisp: %CSTRLEN.

2004-01-30 12:44  gb

	* level-1/l1-sysio.lisp: CLOSE just does CALL-NEXT-METHOD, which
	might work now.

2004-01-30 12:43  gb

	* level-1/l1-streams.lisp: CLOSE: set the closed slot to ...
	something non-NULL.  STREAM-IO-ERROR: so things like sockets can
	specialize it.	Need to test ELEMENT-SHIFT stuff; not sure if I
	merged Bryan's patch correctly.

2004-01-30 12:36  gb

	* level-1/l1-sockets.lisp: SOCKET-ERROR is (simple) STREAM-ERROR. 
	Change how it's signaled, and define STREAM-IO-ERROR for SOCKET.

2004-01-30 12:34  gb

	* level-1/l1-lisp-threads.lisp: Lock on *TERMINATION-POPULATION*
	access.

2004-01-30 12:34  gb

	* level-1/l1-clos.lisp: ADD-READER/WRITER-METHOD: less specialized.
	 Turn a few early accessors into GFs; writer methods on some slots.

2004-01-30 12:32  gb

	* level-1/l1-clos-boot.lisp: CLASS-SLOT-INITARGS,
	CREATE-READER/WRITER-METHOD-FUNCTION: less specialized.

2004-01-30 12:30  gb

	* lib/macros.lisp: WITH-STRING-FROM-CSTRING: stack allocate a
	lisp-string, getting bytes from c-string.

2004-01-30 12:28  gb

	* lib/foreign-types.lisp: BIT/BITFIELD foreign integer types.

2004-01-29 10:45  gb

	* level-0/l0-array.lisp: CTYPE-SUBTYPE: no specialized (COMPLEX )
	arrays, so check NUMERIC-CTYPE-COMPLEXP first.

2004-01-28 17:06  gb

	* lisp-kernel/lisp-exceptions.c: kinder, gentler do_tsp_overflow

2004-01-26 18:18  gb

	* lib/sequences.lisp: SUBSEQ: Array-headers aren't sequences;
	vector headers are.

2004-01-26 09:51  gb

	* lib/level-2.lisp: (SETF %GET-BITFIELD) becomes %SET-BITFIELD,
	which is what the setf inverse thought it was anyway.

2004-01-26 09:50  gb

	* lib/db-io.lisp: %DECODE-FOREIGN-NAME handles 0-length names
	correctly.

2004-01-26 05:09  gb

	* level-1/l1-clos.lisp: Kinder, gentler %SHARED-INITIALIZE uses
	INSTANCE-CLASS-WRAPPER.

2004-01-26 05:08  gb

	* level-1/l1-clos-boot.lisp: INSTANCE-CLASS-WRAPPER (how many
	versions of this are there ?) looks at pointer-based classes.

2004-01-26 05:06  gb

	* level-1/l1-error-system.lisp: Bryan O'Connor's fix to
	%ACTIVE-RESTART.

2004-01-26 05:05  gb

	* level-1/version.lisp: So much for the 040124 idea ...

2004-01-26 05:04  gb

	* lib/foreign-types.lisp: Initialize ordinal->type vector elements
	to NIL.

2004-01-25 15:16  gb

	* lisp-kernel/spentry.s: Linux "as" doesn't like semicolon
	comments, so use /* */.

2004-01-25 15:16  gb

	* lib/time.lisp: GET-INTERNAL-xxx-TIME moved here.

2004-01-25 15:16  gb

	* lib/number-macros.lisp: WITH-STACK-SHORT-FLOATS is
	PPC32-specific.

2004-01-25 15:15  gb

	* lib/macros.lisp: Start to make RLET assert foreign-type ordinals,
	then give up on the idea.  (FOREIGN-TYPES would need to work
	earlier in the cold load than they do.)

2004-01-25 15:14  gb

	* lib/foreign-types.lisp: Try to introduce "foreign type ordinals",
	which can be embedded in MACPTRs (this is hard to bootstrap for
	many reasons.) (PREF foo :thing.embedded-record) expands into some
	SETFable noise around %INC-PTR.

2004-01-25 15:12  gb

	* level-1/version.lisp: Bump.

2004-01-25 15:11  gb

	* level-1/sysutils.lisp: MAKE-ARRAY earlier.

2004-01-25 15:11  gb

	* level-1/linux-files.lisp: Move some time stuff to time.lisp.

2004-01-25 15:11  gb

	* level-1/l1-utils.lisp: %COMPOSITE-POINTER-REF, so embedded
	foreign structs can be SETF-able.

2004-01-25 15:10  gb

	* level-1/l1-typesys.lisp: Don't REQUIRE at loadtime, so we can
	maybe move earlier in the cold load.

2004-01-25 15:10  gb

	* level-1/l1-io.lisp: MACPTRs may say what they're pointing to,
	though this idea is hard to bootstrap.

2004-01-25 15:09  gb

	* level-1/l1-files.lisp: Move LOGICAL-PATHNAME-P earlier.

2004-01-25 15:08  gb

	* level-1/: l1-aprims.lisp, l1-clos-boot.lisp: Say "target:" a few
	times.

2004-01-25 15:07  gb

	* level-0/PPC/ppc-symbol.lisp: Fix %SVAR-BINDING-ADDRESS for the
	nth time.

2004-01-25 15:07  gb

	* level-0/PPC/ppc-float.lisp: Some conditionalization, mostly
	dealing with immediate/non-immediate SHORT-FLOATs.

2004-01-25 15:04  gb

	* level-0/l0-float.lisp, level-0/l0-numbers.lisp,
	level-1/l1-numbers.lisp, lib/numbers.lisp: Conditionalize use of
	WITH-STACK-SHORT-FLOATS, sortof.

2004-01-25 15:01  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp: No low (half-) word of
	lisp-fpscr.

2004-01-25 15:00  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp: WITH-STACK-SHORT-FLOATS moved
	here.

2004-01-25 15:00  gb

	* compiler/PPC/ppc-lapmacros.lisp: Halfhearted attempt at
	#+ppc32/#+ppc64 conditionalization.  Will need to split this in
	half.

2004-01-25 14:59  gb

	* compiler/optimizers.lisp: %composite-pointer-ref.

2004-01-24 16:45  gb

	* lib/systems.lisp: -some- PPC64 backend stuff.

2004-01-24 16:43  gb

	* lib/sequences.lisp: Vector case of SUBSEQ had better be faster
	...

2004-01-24 16:43  gb

	* lib/foreign-types.lisp: Start to associate "ordinal" numbers with
	types (for typed pointers.)

2004-01-24 16:40  gb

	* level-1/: l1-sockets.lisp, l1-streams.lisp, l1-sysio.lisp: Return
	was-open-p from CLOSE method.

2004-01-24 16:38  gb

	* level-1/l1-clos.lisp: UPDATE-SLOTS: assume that slotds are
	ordered, don't order them by location.

2004-01-24 16:37  gb

	* level-0/PPC/ppc-misc.lisp: %COPY-GVECTOR-TO-GVECTOR.

2004-01-24 16:36  gb

	* level-0/l0-array.lisp: Array element type of strings is
	CHARACTER, not that it matters whether it's that or BASE-CHAR.

2004-01-24 16:34  gb

	* examples/objc-runtime.lisp: Work harder to determine if an
	instance really is an instance.

2004-01-24 16:34  gb

	* examples/objc-clos.lisp: Lots of changes from Randall Beer.

2004-01-24 16:33  gb

	* examples/hemlock-textstorage.lisp: Preliminary NSBox stuff.  Not
	much of it, even.

2004-01-24 16:32  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: Some of these actually work
	...

2004-01-24 16:31  gb

	* compiler/PPC/PPC64/ppc64-backend.lisp: target-lisp-node-size is
	8.  Don't require vinsns (break circle).

2004-01-24 16:30  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp: Some fixes; call it
	fulltag-misc after all.

2004-01-24 16:30  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp: Rename some things to
	(start to) match ppc64.

2004-01-24 16:28  gb

	* compiler/PPC/PPC32/ppc32-backend.lisp: target-lisp-node-size in
	backend.  Make default if :ppc32-target, not :ppc-target.

2004-01-24 16:27  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp: Define
	target-most-[positive,negative]-fixnum

2004-01-24 16:27  gb

	* compiler/PPC/ppc2.lisp: Don't use LOAD-TIME-VALUE to reference
	vinsn-template cell; look up the template at runtime.  Change some
	vinsn usage.

2004-01-24 16:25  gb

	* compiler/PPC/ppc-asm.lisp: Fix 64-bit rotates, define clrrdi
	instead of defining clrrdi. twice.

2004-01-24 16:23  gb

	* compiler/vreg.lisp: Yawn.  Update spec class alist for new
	storage-class names.

2004-01-24 16:22  gb

	* compiler/vinsn.lisp: Match against :u64/:s64 storage class names.

2004-01-24 16:22  gb

	* compiler/reg.lisp: New constants for	64-bit storage classes.

2004-01-24 16:21  gb

	* compiler/backend.lisp: New GPR mode-names for 64-bit storage
	classes.

2004-01-24 16:20  gb

	* compiler/arch.lisp: 64-bit storage classes.

2004-01-22 03:53  gb

	* compiler/PPC/PPC32/ppc32-vinsns.lisp: Um, COPY-FPR sets (and
	uses) an FPR ...

2004-01-22 03:52  gb

	* compiler/vinsn.lisp: MAKE-VINSN zeros the GPRS-SET & FPRS-SET
	fields when pulling a vinsn off of the freelist.

2004-01-22 03:51  gb

	* lisp-kernel/spentry.s: Try to un-botch SPbuiltin_length, for
	about the third time in a week.

2004-01-21 23:11  gb

	* level-1/l1-readloop.lisp: New --version command-line argument;
	new APPLICATION-VERSION-STRING method.

2004-01-21 23:10  gb

	* level-1/version.lisp: Bump, again.

2004-01-21 23:10  gb

	* lib/compile-ccl.lisp: Correct TARGET-LEVEL-1-MODULES, to reflect
	new target names.

2004-01-21 01:32  gb

	* level-1/l1-streams.lisp: Default methods (specialized on T) of
	OPEN-STREAM-P, INTERACTIVE-STREAM-P, INPUT-STREAM-P,
	OUTPUT-STREAM-P complain that argument isn't a stream.	This is OK,
	as long as users only specialize these methods on subclasses of
	FUNDAMENTAL-STREAM, and they shouldn't be doing otherwise anyway.

2004-01-21 00:37  gb

	* level-1/l1-streams.lisp: Bryan O'Connor's fix to
	STREAM-UNREAD-CHAR method for ECHO-STREAM.

2004-01-21 00:30  gb

	* compiler/nx1.lisp: NX1-ASH: where did those numbers come from ?

2004-01-21 00:29  gb

	* level-1/l1-typesys.lisp: (SIGNED-BYTE 1) is perfectly legal ...

2004-01-20 16:54  gb

	* compiler/PPC/ppc-backend.lisp: Define FIXUP-PPC-BACKEND in terms
	of target.

2004-01-20 16:54  gb

	* lib/compile-ccl.lisp: :PPC -> :PPC32.

2004-01-20 16:43  gb

	* xdump/: xfasload.lisp, xppcfasload.lisp: Backend name changes.

2004-01-20 16:42  gb

	* lib/: compile-ccl.lisp, systems.lisp: More PPC/PPC32 changes. 
	(Not generalized yet ...)

2004-01-20 16:41  gb

	* level-1/version.lisp: Bump again.

2004-01-20 16:41  gb

	* level-1/l1-files.lisp: Bryan O'Connor's fix to PROBE-FILE.

2004-01-20 16:40  gb

	* compiler/PPC/ppc2.lisp: Don't refer to *PPC-VINSN-TEMPLATES*; use
	the target backend instead.

2004-01-20 16:39  gb

	* compiler/nx1.lisp: New backend names.

2004-01-20 16:38  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: backend changes

2004-01-20 16:37  gb

	* compiler/PPC/PPC64/ppc64-backend.lisp: new file

2004-01-20 16:17  gb

	* compiler/PPC/PPC32/: ppc32-backend.lisp, ppc32-vinsns.lisp: meet
	the new files, same as the old files

2004-01-20 16:16  gb

	* compiler/PPC/ppc-backend.lisp: new file, sorta

2004-01-20 16:15  gb

	* compiler/PPC/: ppc-backend.lisp, ppc-vinsns.lisp: removed, now
	PPC32-specific

2004-01-20 16:15  gb

	* compiler/PPC/ppc-asm.lisp: backend changes

2004-01-19 17:41  gb

	* library/loop.lisp: Bryan O'Connor's fix to force RETURNing
	clauses into the main body.

2004-01-19 17:40  gb

	* lib/nfcomp.lisp: Allow (EVAL-WHEN () ,@body).

2004-01-19 17:40  gb

	* lib/macros.lisp: PARSE-DEFGENERIC allows multiple DECLARE forms,
	passes them as :DECLARATIONS option.  HANDLER-BIND a little less
	jumpy.

2004-01-19 17:37  gb

	* lib/foreign-types.lisp: (Finally) try to handle odd poweropen
	struct alignment rules.

2004-01-19 17:37  gb

	* lib/db-io.lisp: (Finally) try to handle odd poweropen struct
	alignment rules.  Pad :DBM_CONSTANT to naturally align double-float
	field, since unnatural alignment is now the norm.

2004-01-19 17:35  gb

	* level-1/l1-readloop.lisp: SIGNAL keeps looking in the same
	cluster when a handler declines.

2004-01-19 17:34  gb

	* level-1/l1-readloop-lds.lisp: Allowing INVOKE-DEBUGGER to build a
	condition from extra arguments would clearly lead to increased
	street crime.

2004-01-19 17:33  gb

	* level-1/l1-error-system.lisp: Define (and signal) some new
	condition classes.

2004-01-19 17:30  gb

	* level-1/l1-error-signal.lisp: Map kernel "can't construct
	arglist" to a (new) TYPE-ERROR subclass.

2004-01-19 17:29  gb

	* level-1/l1-dcode.lisp: GF's need to check keywords after all. 
	Recognize :ALLOW-OTHER-KEYS T sooner, don't treat :ALLOW-OTHER-KEYS
	NIL as an unknown argument.

2004-01-19 17:27  gb

	* level-0/l0-array.lisp: Paranoia in CTYPE-SUBTYPE: allow float
	aliases.

2004-01-18 21:12  gb

	* examples/cocoa-inspector.lisp: Don't reference *objc-readtable*.

2004-01-17 21:00  gb

	* library/loop.lisp: From Bryan O'Connor: "LOOP FOR x ..." uses
	destructuring mechanism on X, so "LOOP FOR NIL ..." is accepted.

2004-01-17 20:58  gb

	* library/lispequ.lisp: More pathname info for DESCRIBE.  Use
	INSTANCE-SLOTS vice INSTANCE.SLOTS, so .accessors will work on
	other instance types.

2004-01-17 20:57  gb

	* lib/pprint.lisp: PPRINT-DISATCH: symbol is external in CL, so
	don't use it as a structure name.

2004-01-17 20:55  gb

	* lib/numbers.lisp: RATIONALIZE comments; extra typechecking in
	BOOLE.

2004-01-17 20:55  gb

	* lib/macros.lisp: WITH-HASH-TABLE-ITERATOR allows declarations.

2004-01-17 20:54  gb

	* lib/foreign-types.lisp: Handle FOREIGN-ARRAY-TYPE.  (Note: this
	is Darwin-specific.)

2004-01-17 20:53  gb

	* lib/arrays-fry.lisp: SBIT, %SBITSET hande 0-dimensional bitvector
	case.

2004-01-17 20:52  gb

	* level-1/version.lisp: Bump.

2004-01-17 20:52  gb

	* level-1/sysutils.lisp: TYPE-OF changes.  Blame CLHS.

2004-01-17 20:51  gb

	* level-1/l1-utils.lisp: More PROGRAM-ERRORs signaled during
	destructuring.

2004-01-17 20:50  gb

	* level-1/l1-typesys.lisp: Lots more changes.

2004-01-17 20:49  gb

	* level-1/l1-streams.lisp: MAKE-STRING-OUTPUT-STREAM: no such thing
	as a STRING-CHAR anymore.

2004-01-17 20:48  gb

	* level-1/l1-readloop-lds.lisp: WARN has to be more anal-retentive
	about the condition and any args it gets.

2004-01-17 20:47  gb

	* level-1/l1-numbers.lisp: Handle bytespecs with size 0.

2004-01-17 20:46  gb

	* level-1/l1-files.lisp: Quote dots in namestring components. 
	Catch a few bogus cases, like (:ABSOLUTE :UP) in directory.

2004-01-17 20:44  gb

	* level-1/l1-dcode.lisp: %%NTH-ARG-DCODE: signal program error if 0
	args.

2004-01-17 20:40  gb

	* level-1/l1-clos.lisp: Use safer accessors.  (May revert back some
	cases, since .accessors should now use INSTANCE-SLOTS rather than
	INSTANCE.SLOTS.)

2004-01-17 20:38  gb

	* level-1/l1-clos-boot.lisp: Define more accessors; INSTANCE-SLOTS
	is now used in most "early" .accessors.  Don't look at GF-AOK bit;
	whatever the problem with initarg caching is, that's not the
	solution.

2004-01-17 20:36  gb

	* level-1/l1-aprims.lisp: NRECONC uses ENDP.  %MAKE-DISPLACED-ARRAY
	always displaces to what the user said to displace to.

2004-01-17 20:35  gb

	* level-0/l0-pred.lisp: DISPLACED-ARRAY-P didn't handle transitive
	displacement.

2004-01-17 20:34  gb

	* level-0/l0-numbers.lisp: Handle denorms in
	INTEGER-DECODE-SHORT-FLOAT.

2004-01-17 20:33  gb

	* level-0/l0-float.lisp: (EXPT b e) is (COERCE 1 (TYPE-OF B)) if
	(ZEROP E).

2004-01-17 20:32  gb

	* level-0/l0-array.lisp: *BASE-CHAR-CLASS* may or may not be the
	same as *CHARACTER-CLASS*.  (integer 1 1) denotes a BIT.

2004-01-17 20:30  gb

	* compiler/optimizers.lisp: Handle negative bytespecs; don't define
	synonyms where they may be involved.  Open-code INTEGERP.

2004-01-15 01:34  gb

	* compiler/optimizers.lisp: Remove a stale comment.  Might consider
	a less-hairy typespec.

2004-01-15 01:33  gb

	* level-0/l0-array.lisp: (INTEGER 0 0) is a subtype of (INTEGER 0
	1), aka BIT.

2004-01-15 01:32  gb

	* level-1/l1-clos-boot.lisp: MAKE-INSTANCES-OBSOLETE: methods
	return class.

2004-01-15 01:29  gb

	* level-1/l1-dcode.lisp: %%CHECK-KEYWORDS is (a) slow (b) wrong (c)
	probably unnecessary.  If (c) is true, there's a similar case where
	the same things are probably true as well, and callers should be
	changed. (c) is certainly true in some cases (when the "combined
	method" is a simple method.

2004-01-15 01:26  gb

	* level-1/l1-error-system.lisp: READER-ERROR inherits from
	PARSE-ERROR and STREAM-ERROR.

2004-01-15 01:25  gb

	* level-1/l1-files.lisp: PATHNAME-DEVICE typechecks its arg before
	ignoring it.

2004-01-15 01:20  gb

	* level-1/l1-streams.lisp: Default version of STREAM-FILENAME
	signals an error; streams that aren't FILE-STREAMs aren't
	pathname-designators.

2004-01-15 01:18  gb

	* level-1/l1-typesys.lisp: Bump up the (global) type-cache size. 
	Fixes in CLASS type methods.

2004-01-15 01:16  gb

	* lisp-kernel/spentry.s: A million monkeys and a million
	typewriters: sooner or later, one of them will get ASH right ...

2004-01-14 20:59  gb

	* level-0/l0-numbers.lisp: Special-case (TRUNCATE
	MOST-NEGATIVE-FIXNUM x).

2004-01-13 21:50  gb

	* level-1/version.lisp: forgot to commit this earlier

2004-01-13 18:13  gb

	* compiler/nx-basic.lisp: Signal a PROGRAM-ERROR or two.  Better
	checking of SYMBOL-MACROs in AUGMENT-ENVIRONMENT.

2004-01-13 18:12  gb

	* compiler/nx0.lisp: Allow NIL to be a -local- function name. 
	Don't tail-call SIGNAL-PROGRAM-ERROR.

2004-01-13 18:11  gb

	* compiler/nx1.lisp: Add a (long-)missing IN-PACKAGE.

2004-01-13 18:11  gb

	* compiler/PPC/ppc-disassemble.lisp: DISASSEMBLE's output should go
	to *STANDARD-OUTPUT*.

2004-01-13 18:10  gb

	* level-0/l0-array.lisp: FILL-POINTER's lament.

2004-01-13 18:10  gb

	* level-0/l0-bignum.lisp: maybe bignum-bignum-gcd really works now.

2004-01-13 18:09  gb

	* level-0/l0-numbers.lisp: IMAGPART uses * vice FLOAT, to get the
	sign of 0.0 right.  PHASE of a negative rational returns
	single-float PI.

2004-01-13 18:08  gb

	* level-1/l1-aprims.lisp: ALT-LIST-LENGTH here.  LAST allows
	positive integers.  GET-PROPERTIES uses a TYPE-ERROR to complain
	about bad plists.

2004-01-13 18:06  gb

	* level-1/l1-clos-boot.lisp: Recognize that SLOT-MISSING might
	return if it's specialized.  Call it with the symbol SETF, not
	'(SETF SLOT-VALUE).

2004-01-13 18:04  gb

	* level-1/l1-clos.lisp: Check initargs via DESTRUCTURING-BIND in
	%SHARED-INITIALIZE.  ENSURE-CLASS-FOR-DEFCLASS and
	*defclass-redefines-improperly-named-classes-pedantically*.  (SETF
	CLASS-NAME) isn't an accessor; the real method uses
	REINITIALIZE-INSTANCE.

2004-01-13 18:02  gb

	* level-1/l1-dcode.lisp: Bad keywords trigger PROGRAM-ERRORs.

2004-01-13 18:01  gb

	* level-1/: l1-error-signal.lisp, l1-error-system.lisp: PARSE-ERROR
	isn't a STREAM-ERROR.  Tail-call ERROR from SIGNAL-PROGRAM-ERROR,
	to keep it out of backtrace.  UNDEFINED-FUNCTION-CALL: lose
	FUNCTION-NAME slot, use CELL-ERROR-NAME instead.

2004-01-13 17:58  gb

	* level-1/l1-numbers.lisp: Can't have a function called
	CL:RANDOM-STATE, so change its name and its only caller.

2004-01-13 17:58  gb

	* level-1/l1-readloop.lisp: SYMBOL-MACROLET in the cheap evaluator:
	process declarations along with symbol-macros, so that
	AUGMENT-ENVIRONMENT can complain about SPECIAL decls easier.

2004-01-13 17:56  gb

	* level-1/l1-typesys.lisp: Incorporate lots of changes (most of the
	type system, in fact) from recent CMUCL sources.  Thank Cristophe
	Rhodes and others for their work.
	
	Warning to fix an EVAL-WHEN; can't define some stuff at
	compile-time while bootstrapping from the old type system.

2004-01-13 17:55  gb

	* level-1/l1-utils.lisp: Fix ASSOC and friends, broken just a few
	days ago.  Signal PROGRAM-ERROR when detecting argument mismatches
	in macros.

2004-01-13 17:54  gb

	* level-1/sysutils.lisp: TYPE-OF's a little closer to being right
	(checks for PROPERly-named classes.)

2004-01-13 17:53  gb

	* lib/defstruct.lisp: STRUCTURE isn't a type specifier;
	STRUCTURE-OBJECT is.  Use the right one in COPY-STRUCTURE.

2004-01-13 17:52  gb

	* lib/lists.lisp: Use ENDP to detect bad alists in COPY-ALIST. 
	Move ALT-LIST-LENGTH elsewhere (and fix it ...)

2004-01-13 17:50  gb

	* lib/macros.lisp: DEFCLASS: allow NIL as slot :type, expand into
	(new) ENSURE-CLASS-FOR-DEFCLASS.  Signal a PROGRAM-ERROR in
	DEFINE-METHOD-COMBINATION.  Can't have a macro named CL:METHOD, so
	change its name to CCL::REFERENCE-METHOD for the time being.

2004-01-13 17:48  gb

	* lib/numbers.lisp: LCM-2, SIGNUM fixes.

2004-01-13 17:47  gb

	* lib/pprint.lisp: (SATISFIES (OUTPUT-STREAM-P)).  (The thing
	that's catching these things is a half-bootstrapped type system,
	but I'd have liked to have seen that one a lot earlier ...)

2004-01-13 17:46  gb

	* lib/read.lisp: Add an IN-PACKAGE.  PARSE-INTEGER signals
	PARSE-ERRORs.

2004-01-13 17:45  gb

	* lib/time.lisp: The type system is/was choking on unknown types;
	it choked on (NUMBER 0 *), which should have been (REAL 0 *) in the
	first place.

2004-01-13 17:43  gb

	* library/lispequ.lisp: New CTYPEs for negation, intersection.

2004-01-13 17:43  gb

	* lisp-kernel/spentry.s: Restore SPbuiltin_assq (ignore NILs in the
	alist.) (ash x y) returns -1 on (<= n -29); need to find a way to
	parameterize this while keeping M4 happy.

2004-01-12 08:20  beer

	* examples/objc-clos.lisp: Partial support for MAKE-INSTANCE on
	ObjC classes

2004-01-12 00:31  gb

	* level-1/l1-dcode.lisp: Too-few args to generic-function ->
	PROGRAM-ERROR, not just ERROR.

2004-01-12 00:30  gb

	* lib/lists.lisp: BUTLAST, NBUTLAST handle dotted lists again.

2004-01-12 00:29  gb

	* lib/level-2.lisp: Handle the case where &WHOLE is a structured
	lambda-list in %destructure-lambda-list.

2004-01-11 18:54  gb

	* lisp-kernel/spentry.s: Start to replace some old (old-binding
	scheme) entries with &restv support.  SPsvar_progvsave: save the
	old binding, not the new one.

2004-01-11 18:53  gb

	* lisp-kernel/spjump.s: Start to replace some old (old-binding
	scheme) entries with &restv support.

2004-01-11 18:53  gb

	* lib/arrays-fry.lisp: ARRAY-IN-BOUNDS-P allows bignum subscripts
	(which are never in bounds, of course.)

2004-01-11 18:52  gb

	* level-1/l1-utils.lisp: ASSEQL was misparenthesized.

2004-01-11 18:51  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: rename some macros:
	ppc->ppc64.

2004-01-11 18:50  gb

	* compiler/nx0.lisp: NX-TAG-INFO compares tagbody tags with EQL.

2004-01-10 23:24  gb

	* level-1/l1-clos-boot.lisp: (SETF FIND-CLASS) checks more
	carefully for "protected classes".

2004-01-10 23:14  gb

	* compiler/PPC/ppc2.lisp: Vinsn renames; slight change to remove
	backend support for "handle"-based memory accessors.

2004-01-10 23:13  gb

	* compiler/PPC/ppc-vinsns.lisp: Change some vinsn names, eliminate
	some unused vinsns.  This'll be "ppc32-vinsns.lisp" soon.

2004-01-10 23:08  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp: Fix nil-value constant.

2004-01-10 23:08  gb

	* compiler/PPC/PPC64/ppc64-vinsns.lisp: New file; not close to
	correct yet.

2004-01-10 23:07  gb

	* level-1/l1-lisp-threads.lisp: Make *DEFAULT-TEMP-STACK-SIZE* too
	big.

2004-01-10 23:06  gb

	* lib/numbers.lisp: Fix LCM/LCM-2 error checking.

2004-01-10 23:06  gb

	* lisp-kernel/spentry.s: _SPbuiltin_length handles the LIST-LENGTH
	case inline.

2004-01-09 15:09  gb

	* xdump/xfasload.lisp: Back out of the attempt to make LIST-LENGTH
	a builtin.

2004-01-09 14:36  gb

	* lib/lists.lisp: Another typo in BUTLAST.

2004-01-09 14:29  gb

	* level-1/l1-utils.lisp: Typo in ASSEQL.

2004-01-09 14:27  gb

	* xdump/xfasload.lisp: LIST-LENGTH will soon be builtin.

2004-01-09 14:27  gb

	* lib/lists.lisp: [N]BUTLAST fixes.

2004-01-09 14:26  gb

	* level-1/l1-error-system.lisp: BAD-SLOT-TYPE, IMPROPER-LIST
	conditions.

2004-01-09 14:25  gb

	* level-1/l1-error-signal.lisp: Handle IMPROPER-LIST

2004-01-09 14:24  gb

	* level-1/: l1-clos-boot.lisp, l1-clos.lisp: BAD-SLOT-TYPE errors.

2004-01-09 14:24  gb

	* level-0/l0-misc.lisp: LENGTH changes.

2004-01-07 17:30  gb

	* examples/: cocoa-window.lisp, cocoa.lisp: A little bit of
	conditionalization.

2004-01-07 17:29  gb

	* level-1/sysutils.lisp: TYPEP returns 1 value.

2004-01-07 17:29  gb

	* level-0/l0-bignum.lisp: Detect when destructive right shifts
	yield a fixnum more accurately (this was causing the bignums to be
	passed to internal functions that expect fixnums in some cases).

2004-01-07 16:40  gb

	* level-0/l0-misc.lisp: ASSQ is builtin, so just EVAL-REDEF it.

2004-01-07 16:39  gb

	* level-1/l1-utils.lisp: ASSOC variants don't allow NIL in an
	alist.	ASSEQL typechecks CAR/CDR.  MEMEQL uses ENDP, doesn't use
	%CAR/%CDR in unsafe contexts.

2004-01-07 16:38  gb

	* lib/level-2.lisp: Do an EVAL-REDEF for ASSQ.

2004-01-07 16:37  gb

	* lisp-kernel/spentry.s: Fix (at least the function case) of
	:ALLOW-OTHER-KEYS NIL.

2004-01-07 08:42  beer

	* examples/objc-clos.lisp: Added support for foreign slot
	definitions

2004-01-06 20:20  gb

	* level-0/PPC/ppc-clos.lisp: Assume that elaboration will call
	#'%SLOT-ID-REF-MISSING, #'%SLOT-ID-SET-MISSING as constant
	functions (not as symbols.)

2004-01-05 22:21  gb

	* examples/objc-clos.lisp: Print class addresses when generating
	slots, in the commented-out FORMAT calls.

2004-01-05 22:19  gb

	* examples/objc-runtime.lisp: Derive the names of superclasses when
	recursively mapping classes; don't use the name MAP-OBJC-CLASS was
	called with/defaulted to over and over.

2004-01-05 20:05  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp: Say "4" instead of "(ash 1
	ppc::word-shift)", since this is platform-dependent anyway.

2004-01-05 20:04  gb

	* examples/objc-support.lisp: Use "TARGET" package, not "ARCH".

2004-01-05 19:33  gb

	* lisp-kernel/static-linux/: .cvsignore, Makefile, staticlib.c:
	Preliminary support for statically-linked kernel.

2004-01-05 19:30  gb

	* xdump/heap-image.lisp: FIXNUMSHIFT in TARGET package.

2004-01-05 19:30  gb

	* lib/read.lisp: SUBTAG-INSTANCE in TARGET package.

2004-01-05 19:29  gb

	* level-1/l1-lisp-threads.lisp: Intern accessors in "TARGET"
	package.

2004-01-05 19:29  gb

	* compiler/PPC/ppc-disassemble.lisp: EXTRACT-DEFAULT function's in
	PPC package now.

2004-01-05 19:12  gb

	* xdump/xppcfasload.lisp: Error codes in ARCH package.

2004-01-05 19:11  gb

	* xdump/xfasload.lisp: Nilreg-relative-symbols are PPC common.

2004-01-05 19:11  gb

	* lisp-kernel/pmcl-kernel.c: Set lisp_global(STATICALLY_LINKED) if
	STATIC is defined.

2004-01-05 19:10  gb

	* lisp-kernel/plbt.c: Don't assume that dladdr exists if STATIC is
	defined.

2004-01-05 19:09  gb

	* lisp-kernel/: constants.s, lisp_globals.h: STATICALLY_LINKED
	global.

2004-01-05 19:09  gb

	* lib/ppcenv.lisp: PPC regs are in PPC package.

2004-01-05 19:08  gb

	* lib/backtrace-lds.lisp: Opcode/operand stuff's in ARCH package.

2004-01-05 19:08  gb

	* level-1/version.lisp: 040106, for a while.

2004-01-05 19:07  gb

	* level-1/: ppc-error-signal.lisp, ppc-trap-support.lisp: Error
	codes are in ARCH package.

2004-01-05 19:07  gb

	* level-1/l1-lisp-threads.lisp: TCR flags are in ARCH.	(Strange,
	but true.)

2004-01-05 19:06  gb

	* level-1/l1-io.lisp: All PPCs have an FPSCR with the same bits in
	it ...

2004-01-05 19:06  gb

	* level-1/l1-clos.lisp: Fix (bad) typo in %SHARED-INITIALIZE.

2004-01-05 19:05  gb

	* level-1/l1-clos-boot.lisp: Some changes to initarg
	checking/caching; may still not be correct.

2004-01-05 19:04  gb

	* level-0/PPC/: ppc-float.lisp, ppc-numbers.lisp, ppc-symbol.lisp:
	Internal-package dependency changes.

2004-01-05 19:03  gb

	* level-0/PPC/ppc-def.lisp: Errors in ARCH package.

2004-01-05 19:03  gb

	* level-0/l0-cfm-support.lisp: Some support for static linking
	under Linux, and changes to the startup code for when
	*STATICALLY-LINKED* is in effect.

2004-01-05 19:02  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp: Should be close to having
	PPC64 stuff (tags, object layout) here.

2004-01-05 19:02  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp: Should be close to having
	PPC32 stuff (tags, object layout) here.   May need to be
	reorganized to cross-compile cleanly.

2004-01-05 19:00  gb

	* compiler/PPC/: ppc-disassemble.lisp, ppc-lap.lisp,
	ppc-lapmacros.lisp, ppc-vinsns.lisp, ppc2.lisp: Mostly PPC (not
	PPC32 or PPC64) specific, nominally.  (Undoubtedly still some PPC32
	dependencies.)

2004-01-05 18:59  gb

	* compiler/PPC/ppc-backend.lisp: Mostly PPC (not PPC32 or PPC64)
	specific, nominally.

2004-01-05 18:59  gb

	* compiler/PPC/ppc-asm.lisp: Mostly PPC (not PPC32 or PPC64)
	specific, nominally.  Opcode/operand lap stuff's in ARCH.

2004-01-05 18:56  gb

	* compiler/PPC/: ppc-arch.lisp, ppc-arch.lisp: Most stuff that's
	truly PPC-specific should be here (in the PPC package) now.

2004-01-05 18:54  gb

	* compiler/vreg.lisp: Storage classes (s64/u64 need to be added, at
	least) are in the ARCH package.

2004-01-05 18:53  gb

	* compiler/vinsn.lisp: (generic) opcode/operand stuff is in the
	ARCH package.

2004-01-05 18:53  gb

	* compiler/nx0.lisp: Builtin-functions list is in the ARCH package.

2004-01-05 18:52  gb

	* compiler/arch.lisp: Back in the ARCH package, but there's a lot
	less stuff here.

2004-01-03 16:36  gb

	* level-0/l0-bignum.lisp: Try again, using
	WITH-NEGATED-BIGNUM-BUFFERS.

2004-01-03 16:23  gb

	* level-0/l0-bignum.lisp: %BIGNUM-BIGNUM-GCD wasn't zeroing out the
	buffers it (re-)uses, so use a simpler algorithm (that conses more)
	until this is fixed.

2004-01-03 12:52  gb

	* compiler/PPC/ppc-asm.lisp: Slight change to requirements.

2004-01-03 12:51  gb

	* compiler/PPC/ppc-arch.lisp: New file.

2004-01-03 12:51  gb

	* compiler/PPC/PPC64/ppc64-arch.lisp: New (empty, in fact) file.

2004-01-03 12:50  gb

	* compiler/arch.lisp: Try to be less ppc32-specific.

2004-01-03 12:49  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp: Try to be more
	ppc32-specific.

2004-01-03 12:49  gb

	* examples/bridge.lisp: (Mostly) work with gnu-objc; may have
	broken apple-objc ...

2004-01-03 12:48  gb

	* examples/name-translation.lisp: special-case GS under GNUstep.

2004-01-03 12:47  gb

	* examples/: objc-runtime.lisp, objc-clos.lisp: More gnu-objc
	conditionalization.  Take user-specified class-name when mapping
	objc-class.  Make CLASS-OF objc-metaclasses be OBJC-METACLASS.

2004-01-03 12:45  gb

	* examples/objc-support.lisp: More gnu-objc conditionalization.

2004-01-03 12:43  gb

	* level-0/nfasload.lisp: Generalize the notion of packages whose
	symbols are always exported.

2004-01-03 12:42  gb

	* level-1/l1-boot-1.lisp: Move command-line-arg stuff to
	l1-pathnames.

2004-01-03 12:42  gb

	* level-1/l1-boot-3.lisp: Install the kernel error callbacks, late
	in the cold load.

2004-01-03 12:41  gb

	* level-1/l1-clos-boot.lisp: Move FOREIGN-OBJECT-DOMAIN accessors
	elsewhere.  Make slot accessors work on pointer-based instances.

2004-01-03 12:40  gb

	* level-1/l1-clos.lisp: Add a VALIDATE-SUPERCLASS method for
	(FOREIGN-CLASS STANDARD-CLASS), just in case.

2004-01-03 12:39  gb

	* level-1/l1-pathnames.lisp: Move COMMAND-LINE-ARGUMENTS stuff
	here; use it to find the CCL directory, maybe.

2004-01-03 12:39  gb

	* level-1/ppc-error-signal.lisp: Rename the %ERR-DISP callback to
	%X-ERRDISP, so the kernel doesn't try to call out to %ERR-DISP too
	early in the cold load.

2004-01-03 12:38  gb

	* level-1/ppc-trap-support.lisp: Rename the CMAIN callback to
	XCMAIN, so the kernel doesn't try to call out to CMAIN too early in
	the cold load.

2004-01-03 12:37  gb

	* lib/: systems.lisp, compile-ccl.lisp: Add PPC-ARCH.  (This is all
	still a moving target.)

2004-01-03 12:37  gb

	* lisp-kernel/lisp-exceptions.c: Integrate a little better with the
	new debugger.

2004-01-03 12:36  gb

	* lisp-kernel/lisp-exceptions.h: According to my calculations, you
	need 5 bits to express a 5-bit register field (RT, RA, RB, etc.)

2004-01-03 12:35  gb

	* lisp-kernel/ppc_print.c: Print MACPTRs, get method
	names/specializers half-right.

2004-01-03 12:35  gb

	* library/lispequ.lisp: Move FOREIGN-OBJECT-DOMAIN accessors here.

2004-01-03 03:49  gb

	* lisp-kernel/spentry.s: Zero the domain/type fields when making a
	stack-block.

2003-12-31 04:12  gb

	* lib/describe.lisp: Use STANDARD-OBJECT-P to find instance
	class-wrappers.

2003-12-31 04:11  gb

	* level-1/l1-clos-boot.lisp: Fix an EQL-SPECIALIZER botch.  Lots of
	stuff to support foreign classes/foreign objects.

2003-12-31 04:09  gb

	* level-1/l1-clos.lisp: Use %class-slots instead of %CLASS.SLOTS
	when CLASS-SLOTS won't do.  Move CONSTANTLY here, remove some
	outdated comments.

2003-12-31 04:08  gb

	* level-1/l1-dcode.lisp: Careful about getting wrappers in
	dispatch.  Use %class-slots instead of %CLASS.SLOTS when
	CLASS-SLOTS won't do.

2003-12-31 04:06  gb

	* level-1/l1-io.lisp: Write the address involved in a #<Recursive
	printing error>, as if that helps ...  Use CLASS-NAME vice
	%CLASS.NAME.

2003-12-31 04:04  gb

	* level-0/PPC/ppc-utils.lisp: Macptr domain/type accessors.  In LAP
	to simplify treating them as (SIGNED-BYTE 32), but it was easier to
	make domain unsigned.

2003-12-31 04:03  gb

	* level-0/l0-pred.lisp: Half-hearted change to %TYPEP, to handle
	foreign-typed macptrs.

2003-12-31 04:02  gb

	* examples/process-objc-modules.lisp: Don't call MAP-OBJC-CLASS
	when walking modules.

2003-12-31 04:02  gb

	* examples/objc-runtime.lisp: Start to integrate CLOS & ObjC.

2003-12-31 04:01  gb

	* examples/objc-clos.lisp: New file: start to integrate CLOS/ObjC.

2003-12-31 04:01  gb

	* compiler/PPC/ppc-vinsns.lisp: MACPTR->STACK zeroes domain, type
	fields.

2003-12-29 01:19  gb

	* examples/objc-runtime.lisp: SUPER's gensym'ed in methods; FLET
	SUPER accesses it.  Remove the CFBUNDLE stuff, so this file can be
	loaded when it isn't necessary.

2003-12-29 01:17  gb

	* examples/objc-readtable.lisp: Access SUPER via (SUPER).

2003-12-29 01:17  gb

	* examples/fake-cfbundle-path.lisp: Put the CFBUNDLE nonsense here,
	independent of the rest of objc-support.

2003-12-29 01:17  gb

	* examples/cocoa.lisp: Get rid of *DEFAULT-BUNDLE-PATH* and friend;
	require FAKE-CFBUNDLE-PATH and use the function of that name
	explicitly.

2003-12-29 01:15  gb

	* examples/cocoa-window.lisp: Use (SUPER) in
	OBJC-MESSAGE-SEND-SUPER call.

2003-12-21 15:40  gb

	* examples/: cocoa-application.lisp, objc-runtime.lisp,
	process-objc-modules.lisp: revive class info, autorelease-pool when
	reiniting CCL directory

2003-12-20 05:18  gb

	* lisp-kernel/lisp-debug.c: Comment out things that don't (yet)
	work.

2003-12-20 05:17  gb

	* level-1/: l1-clos-boot.lisp, l1-clos.lisp: Punt on primary
	accessor methods.

2003-12-20 05:16  gb

	* lib/xref.lisp: Add newline before EOF.

2003-12-20 05:16  gb

	* lib/describe.lisp: Fix dangling close paren.

2003-12-20 03:45  gb

	* lib/describe.lisp: Alanr's fix to closure-inspector.

2003-12-20 00:48  gb

	* lisp-kernel/: spentry.s, thread_manager.c: Remove inline loginfo.

2003-12-20 00:48  gb

	* level-0/: l0-io.lisp, PPC/ppc-symbol.lisp: Add newline before
	EOF.

2003-12-19 17:29  gb

	* examples/: apple-objc.lisp, gnu-objc.lisp: Replaced by
	objc-runtime.lisp

2003-12-19 16:44  gb

	* lib/macros.lisp: A little clearer to say OPTION-NAME instead of
	(CADR OPTION) in DEFCLASS misc-option case.

2003-12-19 16:35  gb

	* lisp-kernel/lisp-debug.c: Change debugger prompt.  Still confuses
	the hell out of ILISP.

2003-12-19 16:34  gb

	* library/splay-tree.lisp: Keep count of splay-tree nodes;
	PRINT-OBJECT methods.

2003-12-19 16:33  gb

	* level-1/version.lisp: Bump the version number.

2003-12-19 16:33  gb

	* examples/process-objc-modules.lisp: Call MAP-OBJC-CLASS on (true)
	classes; MAP-OBJC-CLASS will handle the metaclass.

2003-12-19 16:32  gb

	* examples/objc-support.lisp: Add (commented-out) DBG call.

2003-12-19 16:31  gb

	* examples/objc-runtime.lisp: Some fixes: ensure that the Cocoa
	demo works under OSX.

2003-12-19 15:09  gb

	* lisp-kernel/: lisp-debug.c, lisp-exceptions.c, lisp-exceptions.h,
	lispdcmd.c: New & improved debugger.

2003-12-19 14:47  gb

	* library/splay-tree.lisp: map-splay-tree

2003-12-19 14:37  gb

	* examples/process-objc-modules.lisp: This is all #+apple-objc.

2003-12-19 14:36  gb

	* examples/objc-readtable.lisp: Move readtable stuff out of main
	path; preserve (for a while) for backward- compatibility.

2003-12-19 14:36  gb

	* examples/bridge.lisp: Require (new) OBJC-RUNTIME. Conditionalize
	a little for runtime differences (needs more work.)

2003-12-19 14:33  gb

	* examples/cocoa.lisp: Define bundle/executable paths here.

2003-12-19 14:31  gb

	* examples/objc-runtime.lisp: New file, intended to replace
	apple-objc.lisp.  Try to hide the differences between Apple/GNU
	ObjC runtimes here.

2003-12-19 07:05  beer

	* examples/apple-objc.lisp: Added missing comma to SELF in
	OBJC-METHOD-DEFINITION-FORM

2003-12-16 11:23  gb

	* lib/xref.lisp: use compiler frontend hooks

2003-12-16 11:22  gb

	* compiler/: nx.lisp, nx0.lisp, nx1.lisp: integrate XREF changes

2003-12-16 11:13  gb

	* examples/: apple-objc.lisp, gnu-objc.lisp: minor changes

2003-12-15 15:16  gb

	* library/splay-tree.lisp: new file

2003-12-15 14:12  gb

	* examples/: bridge.lisp, process-objc-modules.lisp: start to
	conditionalize for runtime

2003-12-15 14:11  gb

	* examples/gnu-objc.lisp: get more of this working

2003-12-13 14:53  gb

	* examples/gnu-objc.lisp: Revive efforts to get this working.

2003-12-13 14:51  gb

	* lib/pathnames.lisp: DIRECTORYP.

2003-12-12 16:32  gb

	* level-1/l1-clos.lisp: SETUP-SLOT-LOOKUP does nothing if no slots.

2003-12-12 16:30  gb

	* lib/defstruct.lisp: STRUCTURE isn't a type-specifier; use
	STRUCTURE-OBJECT instead.

2003-12-12 16:29  gb

	* level-1/sysutils.lisp: STRUCTURE isn't a type-specifier.

2003-12-12 16:29  gb

	* level-1/l1-typesys.lisp: TYPE-SPECIFIER does some typechecking.

2003-12-12 16:28  gb

	* level-1/l1-lisp-threads.lisp: FAKE-STACK-FRAME isn't a type
	specifier.

2003-12-12 16:27  gb

	* level-1/l1-clos-boot.lisp: STANDARD-INSTANCE isn't a type
	specifier.

2003-12-12 16:26  gb

	* level-0/l0-pred.lisp: COMPLEX-ARRAY, DISPLACED-ARRAY aren't type
	specifiers.

2003-12-12 14:12  gb

	* library/lispequ.lisp: New wrapper layout.

2003-12-12 14:12  gb

	* lib/ccl-export-syms.lisp: Export METHOD-NAME from CCL,
	OPENMCL-MOP.

2003-12-12 14:12  gb

	* level-1/l1-typesys.lisp: Set TYPE-PREDICATE slot of standard slot
	definition.

2003-12-12 14:10  gb

	* level-1/l1-dcode.lisp: New slot-value scheme.  No more
	reader/writer dcode.

2003-12-12 14:10  gb

	* level-1/: l1-clos-boot.lisp, l1-clos.lisp: New slot-value scheme.

2003-12-12 14:09  gb

	* level-0/PPC/ppc-clos.lisp: New scheme.

2003-12-10 01:25  gb

	* lisp-kernel/thread_manager.c: Don't free() a pointer that was
	just realloc()ed.

2003-12-10 01:25  gb

	* lisp-kernel/spentry.s: Don't reference tlb_pointer until we're
	sure it's big enough.

2003-12-10 01:24  gb

	* library/lispequ.lisp: More wrapper slots for faster slot lookup.

2003-12-10 01:24  gb

	* level-1/version.lisp: New date.

2003-12-10 01:23  gb

	* level-1/l1-clos.lisp: Set things up for faster slot lookup.

2003-12-10 01:22  gb

	* level-1/l1-clos-boot.lisp: SLOT-ID stuff.

2003-12-10 01:21  gb

	* level-0/PPC/ppc-clos.lisp: Some LAP for slot lookup.

2003-12-10 01:20  gb

	* level-0/l0-init.lisp: New PPC32, MOP features.

2003-12-06 22:25  gb

	* level-1/: l1-clos-boot.lisp, l1-clos.lisp: Move
	SLOT-ID-VALUE/SETF-SLOT-ID-VALUE from l1-clos.lisp to
	l1-clos-boot.lisp.

2003-12-06 22:24  gb

	* library/lispequ.lisp: There -will- be more fields in a class
	wrapper soon.

2003-12-06 21:11  gb

	* compiler/optimizers.lisp: First cut at SLOT-VALUE.

2003-12-06 18:44  gb

	* level-1/l1-io.lisp: PRINT-OBJECT method for SLOT-ID.

2003-12-06 18:44  gb

	* level-1/l1-clos-boot.lisp, level-1/l1-clos.lisp,
	library/lispequ.lisp: Start to implement new slot-lookup scheme.

2003-12-06 17:25  gb

	* examples/cocoa-listener.lisp: Return value of insertNewline:
	method is void.

2003-12-06 17:16  gb

	* level-1/l1-clos-boot.lisp: Be more careful about recognizing EQL
	specializers.

2003-12-06 17:15  gb

	* examples/apple-objc.lisp: COLLECT macro moved to CCL package.

2003-12-01 14:44  gb

	* lib/foreign-types.lisp: %foreign-type-or-record: recognize
	(:struct :foo) off the bat.

2003-12-01 14:44  gb

	* level-1/linux-files.lisp: Better %%rusage, since Darwin mucks up
	system/user time.

2003-12-01 14:42  gb

	* level-0/PPC/ppc-symbol.lisp: %SVAR-BINDING-ADDRESS fix.

2003-11-30 01:55  gb

	* lisp-kernel/pmcl-kernel.c: ensure_gc_structures_writable: account
	for entire heap, not just current dynamic area.  Don't try to
	commit a 0-length page range.

2003-11-30 01:54  gb

	* lisp-kernel/lisp-debug.c: Distinguish between read errors
	(especially EINTR) and EOF; terminate on true EOF.

2003-11-19 01:52  gb

	* level-0/l0-cfm-support.lisp, level-0/l0-utils.lisp,
	level-0/nfasload.lisp, level-0/PPC/ppc-array.lisp,
	level-0/PPC/ppc-def.lisp, level-0/PPC/ppc-float.lisp,
	level-0/PPC/ppc-misc.lisp, level-0/PPC/ppc-symbol.lisp,
	level-0/PPC/ppc-utils.lisp, level-1/l1-aprims.lisp,
	level-1/l1-clos-boot.lisp, level-1/l1-dcode.lisp,
	level-1/l1-events.lisp, level-1/l1-lisp-threads.lisp,
	level-1/l1-readloop.lisp, level-1/l1-streams.lisp,
	level-1/l1-utils.lisp, level-1/ppc-callback-support.lisp,
	level-1/ppc-error-signal.lisp, level-1/ppc-threads-utils.lisp,
	level-1/ppc-trap-support.lisp, lib/arrays-fry.lisp,
	lib/backtrace-lds.lisp, lib/backtrace.lisp, lib/dumplisp.lisp,
	lib/eval.lisp, lib/ppc-metering.lisp,
	library/macptr-termination.lisp: remove sparc lap; move all PPC lap
	code to ccl:level-0;PPC;

2003-11-18 08:32  gb

	* compiler/PPC/ppc-lap.lisp: PPC lap macros hash table in backend

2003-11-18 03:10  gb

	* compiler/backend.lisp, compiler/nx.lisp, compiler/vinsn.lisp,
	compiler/PPC/ppc-arch.lisp, compiler/PPC/ppc-asm.lisp,
	compiler/PPC/ppc-backend.lisp, compiler/PPC/ppc-disassemble.lisp,
	compiler/PPC/ppc-lap.lisp, compiler/PPC/PPC32/ppc32-arch.lisp,
	level-0/PPC/ppc-array.lisp, level-0/PPC/ppc-bignum.lisp,
	level-0/PPC/ppc-pred.lisp, level-0/PPC/ppc-symbol.lisp,
	level-1/l1-boot-2.lisp, level-1/runtime.lisp, lib/compile-ccl.lisp,
	lib/nfcomp.lisp, lib/number-macros.lisp, lib/systems.lisp: ppc-arch
	-> ppc32-arch, lap-macros slot in backend

2003-11-18 02:15  gb

	* compiler/PPC/PPC32/ppc32-arch.lisp: rename of ppc-arch.lisp

2003-11-18 01:25  gb

	* compiler/: arch.lisp, PPC/ppc-arch.lisp, PPC/ppc-asm.lisp: missed
	a few DEFENUM stragglers

2003-11-18 00:51  gb

	* compiler/arch.lisp, compiler/vinsn.lisp, level-0/l0-bignum.lisp,
	level-1/l1-clos.lisp, level-1/l1-typesys.lisp,
	lib/foreign-types.lisp, lib/macros.lisp, lib/number-macros.lisp:
	move ONCE-ONLY, COLLECT. ITERATE to CCL package

2003-11-18 00:51  gb

	* level-1/version.lisp: bump version

2003-11-17 23:59  gb

	* compiler/nx0.lisp, compiler/nx1.lisp, compiler/optimizers.lisp,
	compiler/vinsn.lisp, compiler/vreg.lisp, compiler/PPC/ppc-asm.lisp,
	compiler/PPC/ppc-backend.lisp, compiler/PPC/ppc-disassemble.lisp,
	compiler/PPC/ppc-lap.lisp, compiler/PPC/ppc-lapmacros.lisp,
	compiler/PPC/ppc-vinsns.lisp, compiler/PPC/ppc2.lisp,
	level-0/l0-aprims.lisp, level-0/l0-array.lisp,
	level-0/l0-bignum.lisp, level-0/l0-cfm-support.lisp,
	level-0/l0-def.lisp, level-0/l0-float.lisp, level-0/l0-hash.lisp,
	level-0/l0-init.lisp, level-0/l0-int.lisp, level-0/l0-io.lisp,
	level-0/l0-misc.lisp, level-0/l0-numbers.lisp,
	level-0/l0-pred.lisp, level-0/l0-symbol.lisp,
	level-0/l0-utils.lisp, level-0/nfasload.lisp,
	level-0/PPC/ppc-array.lisp, level-0/PPC/ppc-bignum.lisp,
	level-0/PPC/ppc-debug.lisp, level-0/PPC/ppc-def.lisp,
	level-0/PPC/ppc-float.lisp, level-0/PPC/ppc-hash.lisp,
	level-0/PPC/ppc-io.lisp, level-0/PPC/ppc-misc.lisp,
	level-0/PPC/ppc-numbers.lisp, level-0/PPC/ppc-pred.lisp,
	level-0/PPC/ppc-symbol.lisp, level-0/PPC/ppc-utils.lisp,
	level-1/l1-aprims.lisp, level-1/l1-boot-1.lisp,
	level-1/l1-boot-2.lisp, level-1/l1-clos-boot.lisp,
	level-1/l1-clos.lisp, level-1/l1-dcode.lisp,
	level-1/l1-events.lisp, level-1/l1-io.lisp,
	level-1/l1-lisp-threads.lisp, level-1/l1-numbers.lisp,
	level-1/l1-processes.lisp, level-1/l1-readloop.lisp,
	level-1/l1-sockets.lisp, level-1/l1-streams.lisp,
	level-1/l1-typesys.lisp, level-1/l1-utils.lisp,
	level-1/linux-files.lisp, level-1/ppc-callback-support.lisp,
	level-1/ppc-error-signal.lisp, level-1/ppc-threads-utils.lisp,
	level-1/ppc-trap-support.lisp, level-1/sysutils.lisp,
	lib/arrays-fry.lisp, lib/backtrace-lds.lisp, lib/backtrace.lisp,
	lib/defstruct-lds.lisp, lib/defstruct.lisp, lib/describe.lisp,
	lib/eval.lisp, lib/foreign-types.lisp, lib/macros.lisp,
	lib/nfcomp.lisp, lib/number-case-macro.lisp,
	lib/number-macros.lisp, lib/numbers.lisp, lib/ppc-metering.lisp,
	lib/ppcenv.lisp, lib/prepare-mcl-environment.lisp,
	library/macptr-termination.lisp, xdump/hashenv.lisp,
	xdump/xfasload.lisp, xdump/xppcfasload.lisp: rename arch:: ppc::
	refs to ppc32::, for now

2003-11-17 23:52  gb

	* compiler/: arch.lisp, PPC/ppc-arch.lisp: start big package rename
	scheme

2003-11-17 20:52  gb

	* lib/proxy-events.lisp: hasn't been used in a long time ...

2003-11-13 02:19  gb

	* compiler/PPC/ppc2.lisp: PPC2-LOCAL-GO: need to clean up the
	vstack regardless of XFER token.

2003-11-09 18:15  gb

	* compiler/PPC/ppc-asm.lisp: fix handling of immediate operands in
	vector instructions

2003-11-08 12:45  gb

	* lib/dumplisp.lisp: Clear *INTERACTIVE-ABORT-PROCESS* in
	KILL-LISP-POINTERS.

2003-11-08 12:44  gb

	* level-1/l1-events.lisp: Don't try to interrupt
	*INTERACTIVE-ABORT-PROCESS* if it's null.

2003-11-08 12:39  gb

	* level-1/version.lisp: Bump the version.

2003-11-06 01:57  gb

	* lisp-kernel/lisp-exceptions.c: Use symbolic constants in a few
	places.  Check for recent CREATE_LISP_FRAME_INSTRUCTION before
	pc_luser-ing through stack frame initialization, since it may be
	re-initialization.

2003-11-06 01:56  gb

	* lisp-kernel/lisp-exceptions.h: Define a few opcodes, and define
	CREATE_LISP_FRAME_INSTRUCTION.

2003-11-04 12:04  gb

	* level-1/: l1-clos-boot.lisp, l1-clos.lisp: More structure-class
	accessor stuff.

2003-11-04 12:04  gb

	* level-1/version.lisp: Guess ...

2003-11-04 10:15  gb

	* level-1/l1-clos.lisp: Some more work to make STRUCTURE-CLASS have
	real slot definitions.

2003-11-04 10:15  gb

	* level-1/l1-clos-boot.lisp: Define a MAKE-INSTANCES-OBSOLETE
	method for STRUCTURE-CLASS.  Next step: make it do something, like
	warning ...

2003-11-04 10:13  gb

	* level-1/l1-io.lisp: PRINT-OBJECT method for SLOT-DESCRIPTOR,
	whether standard or not.

2003-10-29 17:47  gb

	* level-1/l1-clos.lisp: Fix initialization of early
	effective-slotds.  Start to integrate STRUCTURE-CLASS a bit better.

2003-10-29 16:18  gb

	* lib/: defstruct-lds.lisp, defstruct-macros.lisp, defstruct.lisp:
	Distinguish between inherited structure slots and direct ones.

2003-10-29 16:16  gb

	* level-1/: l1-clos-boot.lisp, l1-clos.lisp: Introduce SLOTS-CLASS;
	make STD-CLASS and STRUCTURE-CLASS (for now) inherit from it.

2003-10-28 18:00  gb

	* hemlock/src/: files.lisp, line.lisp, linimage.lisp,
	rompsite.lisp: More changes/fixes: line-buffered-p stuff.

2003-10-28 17:59  gb

	* examples/compile-hemlock.lisp: new file

2003-10-27 16:48  gb

	* hemlock/src/: files.lisp, macros.lisp, morecoms.lisp,
	rompsite.lisp, window.lisp, winimage.lisp: Suppress some compiler
	warnings.

2003-10-27 16:47  gb

	* hemlock/src/decls.lisp: Declare some special variables.

2003-10-27 15:42  gb

	* hemlock/src/: bit-display.lisp, bit-screen.lisp, cursor.lisp,
	display.lisp, window.lisp, winimage.lisp: Use asterisks in (more)
	special variable names.

2003-10-27 15:28  gb

	* hemlock/src/: bit-screen.lisp, htext1.lisp, htext3.lisp,
	syntax.lisp: More #-clx stuff, fix typos.

2003-10-27 06:22  gb

	* lisp-kernel/gc.c: Fix botch in mark_tcr_tlb().

2003-10-27 06:21  gb

	* lisp-kernel/: Threads.h, lisp-exceptions.c, thread_manager.c:
	Handle tlb extension

2003-10-27 06:21  gb

	* lib/nfcomp.lisp, xdump/faslenv.lisp: Bump the fasl version.

2003-10-27 06:20  gb

	* level-0/l0-error.lisp: Handle XSYMNOBIND.

2003-10-27 04:24  gb

	* level-0/l0-symbol.lisp: Maintain (weak) inverse mapping from idx
	to svar.

2003-10-27 04:23  gb

	* level-1/l1-lisp-threads.lisp: nth-value-in-frame, etc: new
	binding scheme.

2003-10-27 04:18  gb

	* level-1/version.lisp: Bump.

2003-10-26 03:12  gb

	* lisp-kernel/gc.c: Fix typo.

2003-10-26 03:10  gb

	* lisp-kernel/spentry.s: Check for non-bindable symbols without
	trapping.

2003-10-26 03:09  gb

	* lisp-kernel/gc.c: Try to special-case
	NO_THREAD_LOCAL_BINDING_MARKER when walking tlb.

2003-10-26 03:08  gb

	* lisp-kernel/errors.s: XSYMNOBIND

2003-10-26 03:06  gb

	* lib/prepare-mcl-environment.lisp: Look for svar-idx in
	%RESET-OUTERMOST-BINDING.

2003-10-24 10:40  gb

	* lib/prepare-mcl-environment.lisp: (Hopefully) fix
	%RESET-OUTERMOST-BINDING.

2003-10-24 01:33  gb

	* lisp-kernel/spentry.s: Enable/fix shallow-binding stuff.

2003-10-24 01:33  gb

	* lisp-kernel/macros.s: trlle.

2003-10-24 01:32  gb

	* lisp-kernel/gc.c: GC tcr->tlb.

2003-10-24 01:31  gb

	* lisp-kernel/thread_manager.c: Make initial tlb a little bigger.

2003-10-24 01:29  gb

	* lib/db-io.lisp: #$-reader takes more care with constants.

2003-10-24 01:28  gb

	* level-1/l1-readloop.lisp: Cheap evaluator takes more care with
	constants.

2003-10-24 01:28  gb

	* compiler/nx0.lisp: Avoid consing SVARS unnecessarly when
	transforming symbols.

2003-10-23 15:46  gb

	* level-1/l1-utils.lisp: UNDEFINE-CONSTANT.

2003-10-23 15:46  gb

	* level-0/PPC/ppc-symbol.lisp: Low-level symbol/svar accessors.

2003-10-23 15:45  gb

	* level-0/nfasload.lisp: KEYWORD interning sets global value.

2003-10-23 15:45  gb

	* level-0/l0-symbol.lisp: Need an SVAR for symbol-value in general;
	global versions for when we don't.

2003-10-23 15:43  gb

	* compiler/subprims.lisp: Use UNDEFINE-CONSTANT vice MAKUNBOUND

2003-10-23 13:52  gb

	* level-0/l0-symbol.lisp, level-0/PPC/ppc-symbol.lisp,
	lib/backtrace-lds.lisp: New binding stuff.

2003-10-23 13:51  gb

	* compiler/subprims.lisp: Rename old binding subprims.

2003-10-23 13:51  gb

	* compiler/arch.lisp: SVAR-related tcr fields.

2003-10-23 07:37  gb

	* compiler/PPC/: ppc-vinsns.lisp, ppc2.lisp: backend SVAR support

2003-10-23 06:59  gb

	* xdump/xfasload.lisp: SVAR support.

2003-10-23 06:57  gb

	* level-1/sysutils.lisp: More SVAR type stuff.

2003-10-23 06:57  gb

	* level-1/l1-io.lisp: PRINT-OBJECT for svars.

2003-10-23 06:57  gb

	* level-1/l1-clos-boot.lisp: SVAR class.

2003-10-23 06:57  gb

	* level-0/nfasload.lisp: Special-case SVARs in fasl-gvect.

2003-10-23 06:56  gb

	* level-0/l0-symbol.lisp: SVAR binding stuff.

2003-10-23 06:56  gb

	* level-0/l0-pred.lisp: SVAR type support.

2003-10-23 03:51  gb

	* lisp-kernel/: constants.h, constants.s, macros.s, spentry.s,
	spjump.s, thread_manager.c: New svar stuff.  (will need GC
	changes.)

2003-10-23 03:47  gb

	* compiler/nx1.lisp: svar progv support.

2003-10-23 03:47  gb

	* compiler/arch.lisp: svar tag, struct.

2003-10-23 03:47  gb

	* compiler/subprims.lisp: New subprims for svar binding scheme.

2003-10-21 18:09  gb

	* darwin-headers/: carbon/.cvsignore, carbon/C/populate.sh,
	cocoa/.cvsignore, cocoa/C/populate.sh, gl/.cvsignore,
	gl/C/populate.sh, libc/.cvsignore, libc/C/populate.sh: recover
	darwin-headers sources

2003-10-21 18:07  gb

	* headers/: gl/.cvsignore, gl/C/populate.sh, gnome/.cvsignore,
	gnome/C/populate.sh, gtk/.cvsignore, gtk/C/populate.sh,
	libc/.cvsignore, libc/C/populate.sh: recover headers sources

2003-10-21 18:00  gb

	* lisp-kernel/: gc.h, lisp-exceptions.c: Handle new gc-traps for
	egc state changes.

2003-10-21 18:00  gb

	* level-1/l1-dcode.lisp: CLASS-SLOT bugs in dcode/reader-trap.

2003-10-21 17:59  gb

	* level-1/l1-aprims.lisp: Serialize EGC state changes.

2003-10-19 02:57  gb

	* .cvsignore, LGPL, LICENSE, binppc/.cvsignore, compiler/arch.lisp,
	compiler/backend.lisp, compiler/dll-node.lisp,
	compiler/lambda-list.lisp, compiler/nx-base-app.lisp,
	compiler/nx-basic.lisp, compiler/nx.lisp, compiler/nx0.lisp,
	compiler/nx1.lisp, compiler/nxenv.lisp, compiler/optimizers.lisp,
	compiler/reg.lisp, compiler/risc-lap.lisp, compiler/subprims.lisp,
	compiler/vinsn.lisp, compiler/vreg.lisp,
	compiler/PPC/ppc-arch.lisp, compiler/PPC/ppc-asm.lisp,
	compiler/PPC/ppc-backend.lisp, compiler/PPC/ppc-disassemble.lisp,
	compiler/PPC/ppc-lap.lisp, compiler/PPC/ppc-lapmacros.lisp,
	compiler/PPC/ppc-vinsns.lisp, compiler/PPC/ppc2.lisp,
	l1-pfsls/.cvsignore, level-0/l0-aprims.lisp, level-0/l0-array.lisp,
	level-0/l0-cfm-support.lisp, level-0/l0-clos.lisp,
	level-0/l0-complex.lisp, level-0/l0-dcode.lisp,
	level-0/l0-debug.lisp, level-0/l0-def.lisp, level-0/l0-error.lisp,
	level-0/l0-float.lisp, level-0/l0-hash.lisp, level-0/l0-init.lisp,
	level-0/l0-int.lisp, level-0/l0-io.lisp, level-0/l0-misc.lisp,
	level-0/l0-pred.lisp, level-0/l0-symbol.lisp,
	level-0/l0-utils.lisp, level-0/.cvsignore, level-0/l0-bignum.lisp,
	level-0/l0-numbers.lisp, level-0/nfasload.lisp,
	level-0/PPC/.cvsignore, level-0/PPC/ppc-array.lisp,
	level-0/PPC/ppc-bignum.lisp, level-0/PPC/ppc-debug.lisp,
	level-0/PPC/ppc-def.lisp, level-0/PPC/ppc-float.lisp,
	level-0/PPC/ppc-hash.lisp, level-0/PPC/ppc-io.lisp,
	level-0/PPC/ppc-misc.lisp, level-0/PPC/ppc-numbers.lisp,
	level-0/PPC/ppc-pred.lisp, level-0/PPC/ppc-symbol.lisp,
	level-0/PPC/ppc-utils.lisp, level-1/l1-aprims.lisp,
	level-1/l1-boot-1.lisp, level-1/l1-boot-3.lisp,
	level-1/l1-boot-lds.lisp, level-1/l1-callbacks.lisp,
	level-1/l1-cl-package.lisp, level-1/l1-clos.lisp,
	level-1/l1-dcode.lisp, level-1/l1-error-signal.lisp,
	level-1/l1-error-system.lisp, level-1/l1-events.lisp,
	level-1/l1-files.lisp, level-1/l1-format.lisp,
	level-1/l1-init.lisp, level-1/l1-io.lisp,
	level-1/l1-lisp-threads.lisp, level-1/l1-numbers.lisp,
	level-1/l1-processes.lisp, level-1/l1-reader.lisp,
	level-1/l1-readloop-lds.lisp, level-1/l1-readloop.lisp,
	level-1/l1-sockets.lisp, level-1/l1-sort.lisp,
	level-1/l1-streams.lisp, level-1/l1-symhash.lisp,
	level-1/linux-files.lisp, level-1/l1-boot-2.lisp,
	level-1/l1-clos-boot.lisp, level-1/l1-pathnames.lisp,
	level-1/l1-sysio.lisp, level-1/l1-typesys.lisp,
	level-1/l1-utils.lisp, level-1/level-1.lisp,
	level-1/ppc-callback-support.lisp, level-1/ppc-error-signal.lisp,
	level-1/ppc-threads-utils.lisp, level-1/ppc-trap-support.lisp,
	level-1/runtime.lisp, level-1/solaris-files.lisp,
	level-1/sysutils.lisp, level-1/version.lisp, lib/apropos.lisp,
	lib/arglist.lisp, lib/arrays-fry.lisp, lib/backquote.lisp,
	lib/backtrace-lds.lisp, lib/backtrace.lisp, lib/case-error.lisp,
	lib/ccl-export-syms.lisp, lib/chars.lisp, lib/compile-ccl.lisp,
	lib/defstruct-lds.lisp, lib/defstruct-macros.lisp,
	lib/defstruct.lisp, lib/describe.lisp, lib/distrib-inits.lisp,
	lib/dumplisp.lisp, lib/edit-callers.lisp, lib/encapsulate.lisp,
	lib/db-io.lisp, lib/eval.lisp, lib/foreign-types.lisp,
	lib/format.lisp, lib/hash.lisp, lib/level-2.lisp, lib/lists.lisp,
	lib/macros.lisp, lib/mcl-compat.lisp, lib/method-combination.lisp,
	lib/misc.lisp, lib/nfcomp.lisp, lib/number-case-macro.lisp,
	lib/number-macros.lisp, lib/numbers.lisp, lib/pathnames.lisp,
	lib/ppc-init-ccl.lisp, lib/ppc-metering.lisp, lib/ppcenv.lisp,
	lib/pprint.lisp, lib/prepare-mcl-environment.lisp,
	lib/print-db.lisp, lib/proxy-events.lisp, lib/read.lisp,
	lib/sequences.lisp, lib/setf-runtime.lisp, lib/setf.lisp,
	lib/sort.lisp, lib/source-files.lisp, lib/sparcenv.lisp,
	lib/step.lisp, lib/streams.lisp, lib/systems.lisp, lib/time.lisp,
	library/darwin-syscalls.lisp, library/extended-loop.lisp,
	library/lisp-package.lisp, examples/README-OPENMCL-EXAMPLES,
	examples/apple-objc.lisp, examples/cocoa-listener.lisp,
	examples/cocoa-window.lisp, examples/cocoa.lisp,
	examples/finger.lisp, examples/gtk-clock.lisp,
	examples/gtk-minesweeper.lisp, examples/gtk-step.lisp,
	examples/opengl-ffi.lisp, library/.cvsignore,
	library/linux-syscalls.lisp, library/lispequ.lisp,
	library/loop.lisp, library/mac-file-io.lisp,
	library/macptr-termination.lisp, library/mit-loop.lisp,
	library/openmcl-gtk-support.lisp, library/parse-ffi.lisp,
	library/pascal-strings.lisp, library/pty.lisp,
	library/solaris-records.lisp, library/syscall.lisp,
	lisp-kernel/Threads.h, lisp-kernel/area.h, lisp-kernel/asmutils.s,
	lisp-kernel/bits.c, lisp-kernel/bits.h, lisp-kernel/constants.h,
	lisp-kernel/constants.s, lisp-kernel/errors.s, lisp-kernel/gc.c,
	lisp-kernel/gc.h, lisp-kernel/image.c, lisp-kernel/image.h,
	lisp-kernel/imports.s, lisp-kernel/kernel-globals.h,
	lisp-kernel/lisp-debug.c, lisp-kernel/lisp-errors.h,
	lisp-kernel/lisp-exceptions.c, lisp-kernel/lisp-exceptions.h,
	lisp-kernel/lisp.h, lisp-kernel/lisp.s, lisp-kernel/lisp_globals.h,
	lisp-kernel/lispdcmd.c, lisp-kernel/lispdcmd.h,
	lisp-kernel/lisptypes.h, lisp-kernel/m4macros.m4,
	lisp-kernel/macros.h, lisp-kernel/macros.s,
	lisp-kernel/memprotect.h, lisp-kernel/pad.s, lisp-kernel/plbt.c,
	lisp-kernel/plprint.c, lisp-kernel/plsym.c,
	lisp-kernel/pmcl-kernel.c, lisp-kernel/ppc_print.c,
	lisp-kernel/sampler.c, lisp-kernel/sigcontext.h,
	lisp-kernel/spentry.s, lisp-kernel/spjump.s,
	lisp-kernel/subprims.s, lisp-kernel/thread_manager.c,
	lisp-kernel/uuo.s, lisp-kernel/darwin/.gdb_history,
	lisp-kernel/darwin/.gdbinit, lisp-kernel/darwin/Makefile,
	lisp-kernel/darwin/retain, lisp-kernel/linux/.gdbinit,
	lisp-kernel/linux/Makefile, lisp-kernel/linux/elf32ppclinux.x,
	scripts/openmcl, xdump/.cvsignore, xdump/faslenv.lisp,
	xdump/hashenv.lisp, xdump/heap-image.lisp, xdump/xfasload.lisp,
	xdump/xppcfasload.lisp, xdump/xsparcfasload.lisp, xdump/xsym.lisp,
	OpenMCL.app/Contents/Info.plist, OpenMCL.app/Contents/PkgInfo,
	OpenMCL.app/Contents/Resources/OpenMCLKeyBindings.dict,
	OpenMCL.app/Contents/Resources/openmcl-icon.icns,
	OpenMCL.app/Contents/Resources/English.lproj/Credits.rtf,
	OpenMCL.app/Contents/Resources/English.lproj/InfoPlist.strings,
	OpenMCL.app/Contents/Resources/English.lproj/MainMenu.nib/classes.n
	ib,
	OpenMCL.app/Contents/Resources/English.lproj/MainMenu.nib/info.nib,
	OpenMCL.app/Contents/Resources/English.lproj/MainMenu.nib/objects.n
	ib,
	OpenMCL.app/Contents/Resources/English.lproj/MainMenu~.nib/classes.
	nib,
	OpenMCL.app/Contents/Resources/English.lproj/MainMenu~.nib/info.nib
	,
	OpenMCL.app/Contents/Resources/English.lproj/MainMenu~.nib/objects.
	nib,
	OpenMCL.app/Contents/Resources/English.lproj/OpenmclInspector.nib/c
	lasses.nib,
	OpenMCL.app/Contents/Resources/English.lproj/OpenmclInspector.nib/i
	nfo.nib,
	OpenMCL.app/Contents/Resources/English.lproj/OpenmclInspector.nib/o
	bjects.nib,
	OpenMCL.app/Contents/Resources/English.lproj/lispeditor.nib/classes
	.nib,
	OpenMCL.app/Contents/Resources/English.lproj/lispeditor.nib/info.ni
	b,
	OpenMCL.app/Contents/Resources/English.lproj/lispeditor.nib/objects
	.nib,
	OpenMCL.app/Contents/Resources/English.lproj/lispeditor~.nib/classe
	s.nib,
	OpenMCL.app/Contents/Resources/English.lproj/lispeditor~.nib/info.n
	ib,
	OpenMCL.app/Contents/Resources/English.lproj/lispeditor~.nib/object
	s.nib, OpenMCL.app/Contents/Resources/Help/cocoa-notes.html,
	OpenMCL.app/Contents/Resources/Help/index.html,
	bindarwin/.cvsignore, doc/HTML/.cvsignore,
	examples/CocoaBridgeDoc.txt, examples/bridge.lisp,
	examples/cocoa-application.lisp, examples/cocoa-editor.lisp,
	examples/cocoa-inspector.lisp, examples/cocoa-textfind.lisp,
	examples/gnu-objc.lisp, examples/hemlock-textstorage.lisp,
	examples/jni.lisp, examples/name-translation.lisp,
	examples/objc-support.lisp, examples/process-objc-modules.lisp,
	examples/tiny.lisp, examples/webkit.lisp, hemlock/INSTALL,
	hemlock/README, hemlock/TODO, hemlock/hemlock.system,
	hemlock/hemlock11.cursor, hemlock/hemlock11.mask,
	hemlock/bin/openmcl/.cvsignore, hemlock/doc/cim/aux-sys.mss,
	hemlock/doc/cim/cim.mss, hemlock/doc/misc/compilation.order,
	hemlock/doc/misc/hemlock.log, hemlock/doc/misc/hemlock.upd,
	hemlock/doc/misc/notes.txt, hemlock/doc/misc/perq-hemlock.log,
	hemlock/doc/misc/things-to-do.txt,
	hemlock/doc/scribe-converter/NOTES,
	hemlock/doc/scribe-converter/README, hemlock/doc/user/commands.mss,
	hemlock/doc/user/intro.mss, hemlock/doc/user/lisp.mss,
	hemlock/doc/user/mail.mss, hemlock/doc/user/netnews.mss,
	hemlock/doc/user/special-modes.mss, hemlock/doc/user/user.mss,
	hemlock/src/abbrev.lisp, hemlock/src/auto-save.lisp,
	hemlock/src/bindings-gb.lisp, l1-dfsls/.cvsignore,
	hemlock/src/bindings.lisp, hemlock/src/bit-display.lisp,
	hemlock/src/bit-screen.lisp, hemlock/src/bufed.lisp,
	hemlock/src/buffer.lisp, hemlock/src/charmacs.lisp,
	hemlock/src/command.lisp, hemlock/src/comments.lisp,
	hemlock/src/completion.lisp, hemlock/src/cursor.lisp,
	hemlock/src/debug.lisp, hemlock/src/decls.lisp,
	hemlock/src/defsyn.lisp, hemlock/src/dired.lisp,
	hemlock/src/diredcoms.lisp, hemlock/src/display.lisp,
	hemlock/src/doccoms.lisp, hemlock/src/dylan.lisp,
	hemlock/src/echo.lisp, hemlock/src/echocoms.lisp,
	hemlock/src/edit-defs.lisp, hemlock/src/eval-server.lisp,
	hemlock/src/filecoms.lisp, hemlock/src/files.lisp,
	hemlock/src/fill.lisp, hemlock/src/font.lisp,
	hemlock/src/group.lisp, hemlock/src/hemlock-ext.lisp,
	hemlock/src/highlight.lisp, hemlock/src/htext1.lisp,
	hemlock/src/htext2.lisp, hemlock/src/htext3.lisp,
	hemlock/src/htext4.lisp, hemlock/src/hunk-draw.lisp,
	hemlock/src/icom.lisp, hemlock/src/indent.lisp,
	hemlock/src/input.lisp, hemlock/src/interp.lisp,
	hemlock/src/kbdmac.lisp, hemlock/src/key-event.lisp,
	hemlock/src/keysym-defs.lisp, hemlock/src/killcoms.lisp,
	hemlock/src/line.lisp, hemlock/src/linimage.lisp,
	hemlock/src/lisp-lib.lisp, hemlock/src/lispbuf.lisp,
	hemlock/src/lispdep.lisp, hemlock/src/lispeval.lisp,
	hemlock/src/lispmode.lisp, hemlock/src/macros.lisp,
	hemlock/src/main.lisp, hemlock/src/mh.lisp, hemlock/maint/publish,
	hemlock/resources/XKeysymDB, hemlock/resources/mh-scan,
	hemlock/src/morecoms.lisp, hemlock/src/netnews.lisp,
	hemlock/src/overwrite.lisp, hemlock/src/package.lisp,
	hemlock/src/pascal.lisp, hemlock/src/pop-up-stream.lisp,
	hemlock/src/rcs.lisp, hemlock/src/register.lisp,
	hemlock/src/ring.lisp, hemlock/src/rompsite.lisp,
	hemlock/src/screen.lisp, hemlock/src/scribe.lisp,
	hemlock/src/search1.lisp, hemlock/src/search2.lisp,
	hemlock/src/searchcoms.lisp, hemlock/src/shell.lisp,
	hemlock/src/spell-aug.lisp, hemlock/src/spell-corr.lisp,
	hemlock/src/spell-rt.lisp, hemlock/src/spellcoms.lisp,
	hemlock/src/srccom.lisp, hemlock/src/streams.lisp,
	hemlock/src/struct.lisp, hemlock/src/syntax.lisp,
	hemlock/src/table.lisp, hemlock/src/text.lisp,
	hemlock/src/ts-buf.lisp, hemlock/src/ts-stream.lisp,
	hemlock/src/undo.lisp, hemlock/src/unixcoms.lisp,
	hemlock/src/vars.lisp, hemlock/src/window.lisp,
	hemlock/src/winimage.lisp, hemlock/src/xcoms.lisp,
	hemlock/src/elisp/README, hemlock/src/elisp/base.lisp,
	hemlock/src/elisp/cmucl-hemlock-glue.lisp,
	hemlock/src/elisp/codewalker.lisp, hemlock/src/elisp/compile.lisp,
	hemlock/src/elisp/hemlock-shims.lisp,
	hemlock/src/elisp/implementation-needed,
	hemlock/src/elisp/internals.lisp, hemlock/src/elisp/loadup.lisp,
	hemlock/src/elisp/packages.lisp, hemlock/src/elisp/read-table.lisp,
	hemlock/src/spell/README, hemlock/src/spell/build.lisp,
	hemlock/src/spell/classes.lisp, hemlock/src/spell/constants.lisp,
	hemlock/src/spell/correlate.lisp, hemlock/src/spell/flags.lisp,
	hemlock/src/spell/hashing.lisp, hemlock/src/spell/io.lisp,
	hemlock/src/spell/package.lisp, hemlock/src/spell/spell-aug.lisp,
	hemlock/src/spell/spell-dictionary.text,
	hemlock/src/spell/spell.asd, hemlock/src/spell/spellcoms.lisp,
	hemlock/src/tty/termcap.lisp, hemlock/src/tty/tty-disp-rt.lisp,
	hemlock/src/tty/tty-display.lisp, hemlock/src/tty/tty-screen.lisp,
	hemlock/src/wire/Notes, hemlock/src/wire/package.lisp,
	hemlock/src/wire/port.lisp, hemlock/src/wire/remote.lisp,
	hemlock/src/wire/wire.lisp,
	hemlock/resources/spell-dictionary.text,
	hemlock/unused/bit-stream.lisp, hemlock/unused/clx-ext.lisp,
	hemlock/unused/ed-integrity.lisp, hemlock/unused/gosmacs.lisp,
	hemlock/unused/hacks.lisp, hemlock/unused/hemcom.lisp,
	hemlock/unused/hi-integrity.lisp, hemlock/unused/keytran.lisp,
	hemlock/unused/keytrandefs.lisp, hemlock/unused/spell-build.lisp,
	hemlock/unused/struct-ed.lisp, hemlock/unused/tty-stream.lisp,
	hemlock/website/index.html.in: recovered 0.14 sources

2003-10-19 02:57  gb

	* .cvsignore, LGPL, LICENSE, binppc/.cvsignore, compiler/arch.lisp,
	compiler/backend.lisp, compiler/dll-node.lisp,
	compiler/lambda-list.lisp, compiler/nx-base-app.lisp,
	compiler/nx-basic.lisp, compiler/nx.lisp, compiler/nx0.lisp,
	compiler/nx1.lisp, compiler/nxenv.lisp, compiler/optimizers.lisp,
	compiler/reg.lisp, compiler/risc-lap.lisp, compiler/subprims.lisp,
	compiler/vinsn.lisp, compiler/vreg.lisp,
	compiler/PPC/ppc-arch.lisp, compiler/PPC/ppc-asm.lisp,
	compiler/PPC/ppc-backend.lisp, compiler/PPC/ppc-disassemble.lisp,
	compiler/PPC/ppc-lap.lisp, compiler/PPC/ppc-lapmacros.lisp,
	compiler/PPC/ppc-vinsns.lisp, compiler/PPC/ppc2.lisp,
	l1-pfsls/.cvsignore, level-0/l0-aprims.lisp, level-0/l0-array.lisp,
	level-0/l0-cfm-support.lisp, level-0/l0-clos.lisp,
	level-0/l0-complex.lisp, level-0/l0-dcode.lisp,
	level-0/l0-debug.lisp, level-0/l0-def.lisp, level-0/l0-error.lisp,
	level-0/l0-float.lisp, level-0/l0-hash.lisp, level-0/l0-init.lisp,
	level-0/l0-int.lisp, level-0/l0-io.lisp, level-0/l0-misc.lisp,
	level-0/l0-pred.lisp, level-0/l0-symbol.lisp,
	level-0/l0-utils.lisp, level-0/.cvsignore, level-0/l0-bignum.lisp,
	level-0/l0-numbers.lisp, level-0/nfasload.lisp,
	level-0/PPC/.cvsignore, level-0/PPC/ppc-array.lisp,
	level-0/PPC/ppc-bignum.lisp, level-0/PPC/ppc-debug.lisp,
	level-0/PPC/ppc-def.lisp, level-0/PPC/ppc-float.lisp,
	level-0/PPC/ppc-hash.lisp, level-0/PPC/ppc-io.lisp,
	level-0/PPC/ppc-misc.lisp, level-0/PPC/ppc-numbers.lisp,
	level-0/PPC/ppc-pred.lisp, level-0/PPC/ppc-symbol.lisp,
	level-0/PPC/ppc-utils.lisp, level-1/l1-aprims.lisp,
	level-1/l1-boot-1.lisp, level-1/l1-boot-3.lisp,
	level-1/l1-boot-lds.lisp, level-1/l1-callbacks.lisp,
	level-1/l1-cl-package.lisp, level-1/l1-clos.lisp,
	level-1/l1-dcode.lisp, level-1/l1-error-signal.lisp,
	level-1/l1-error-system.lisp, level-1/l1-events.lisp,
	level-1/l1-files.lisp, level-1/l1-format.lisp,
	level-1/l1-init.lisp, level-1/l1-io.lisp,
	level-1/l1-lisp-threads.lisp, level-1/l1-numbers.lisp,
	level-1/l1-processes.lisp, level-1/l1-reader.lisp,
	level-1/l1-readloop-lds.lisp, level-1/l1-readloop.lisp,
	level-1/l1-sockets.lisp, level-1/l1-sort.lisp,
	level-1/l1-streams.lisp, level-1/l1-symhash.lisp,
	level-1/linux-files.lisp, level-1/l1-boot-2.lisp,
	level-1/l1-clos-boot.lisp, level-1/l1-pathnames.lisp,
	level-1/l1-sysio.lisp, level-1/l1-typesys.lisp,
	level-1/l1-utils.lisp, level-1/level-1.lisp,
	level-1/ppc-callback-support.lisp, level-1/ppc-error-signal.lisp,
	level-1/ppc-threads-utils.lisp, level-1/ppc-trap-support.lisp,
	level-1/runtime.lisp, level-1/solaris-files.lisp,
	level-1/sysutils.lisp, level-1/version.lisp, lib/apropos.lisp,
	lib/arglist.lisp, lib/arrays-fry.lisp, lib/backquote.lisp,
	lib/backtrace-lds.lisp, lib/backtrace.lisp, lib/case-error.lisp,
	lib/ccl-export-syms.lisp, lib/chars.lisp, lib/compile-ccl.lisp,
	lib/defstruct-lds.lisp, lib/defstruct-macros.lisp,
	lib/defstruct.lisp, lib/describe.lisp, lib/distrib-inits.lisp,
	lib/dumplisp.lisp, lib/edit-callers.lisp, lib/encapsulate.lisp,
	lib/db-io.lisp, lib/eval.lisp, lib/foreign-types.lisp,
	lib/format.lisp, lib/hash.lisp, lib/level-2.lisp, lib/lists.lisp,
	lib/macros.lisp, lib/mcl-compat.lisp, lib/method-combination.lisp,
	lib/misc.lisp, lib/nfcomp.lisp, lib/number-case-macro.lisp,
	lib/number-macros.lisp, lib/numbers.lisp, lib/pathnames.lisp,
	lib/ppc-init-ccl.lisp, lib/ppc-metering.lisp, lib/ppcenv.lisp,
	lib/pprint.lisp, lib/prepare-mcl-environment.lisp,
	lib/print-db.lisp, lib/proxy-events.lisp, lib/read.lisp,
	lib/sequences.lisp, lib/setf-runtime.lisp, lib/setf.lisp,
	lib/sort.lisp, lib/source-files.lisp, lib/sparcenv.lisp,
	lib/step.lisp, lib/streams.lisp, lib/systems.lisp, lib/time.lisp,
	library/darwin-syscalls.lisp, library/extended-loop.lisp,
	library/lisp-package.lisp, examples/README-OPENMCL-EXAMPLES,
	examples/apple-objc.lisp, examples/cocoa-listener.lisp,
	examples/cocoa-window.lisp, examples/cocoa.lisp,
	examples/finger.lisp, examples/gtk-clock.lisp,
	examples/gtk-minesweeper.lisp, examples/gtk-step.lisp,
	examples/opengl-ffi.lisp, library/.cvsignore,
	library/linux-syscalls.lisp, library/lispequ.lisp,
	library/loop.lisp, library/mac-file-io.lisp,
	library/macptr-termination.lisp, library/mit-loop.lisp,
	library/openmcl-gtk-support.lisp, library/parse-ffi.lisp,
	library/pascal-strings.lisp, library/pty.lisp,
	library/solaris-records.lisp, library/syscall.lisp,
	lisp-kernel/Threads.h, lisp-kernel/area.h, lisp-kernel/asmutils.s,
	lisp-kernel/bits.c, lisp-kernel/bits.h, lisp-kernel/constants.h,
	lisp-kernel/constants.s, lisp-kernel/errors.s, lisp-kernel/gc.c,
	lisp-kernel/gc.h, lisp-kernel/image.c, lisp-kernel/image.h,
	lisp-kernel/imports.s, lisp-kernel/kernel-globals.h,
	lisp-kernel/lisp-debug.c, lisp-kernel/lisp-errors.h,
	lisp-kernel/lisp-exceptions.c, lisp-kernel/lisp-exceptions.h,
	lisp-kernel/lisp.h, lisp-kernel/lisp.s, lisp-kernel/lisp_globals.h,
	lisp-kernel/lispdcmd.c, lisp-kernel/lispdcmd.h,
	lisp-kernel/lisptypes.h, lisp-kernel/m4macros.m4,
	lisp-kernel/macros.h, lisp-kernel/macros.s,
	lisp-kernel/memprotect.h, lisp-kernel/pad.s, lisp-kernel/plbt.c,
	lisp-kernel/plprint.c, lisp-kernel/plsym.c,
	lisp-kernel/pmcl-kernel.c, lisp-kernel/ppc_print.c,
	lisp-kernel/sampler.c, lisp-kernel/sigcontext.h,
	lisp-kernel/spentry.s, lisp-kernel/spjump.s,
	lisp-kernel/subprims.s, lisp-kernel/thread_manager.c,
	lisp-kernel/uuo.s, lisp-kernel/darwin/.gdb_history,
	lisp-kernel/darwin/.gdbinit, lisp-kernel/darwin/Makefile,
	lisp-kernel/darwin/retain, lisp-kernel/linux/.gdbinit,
	lisp-kernel/linux/Makefile, lisp-kernel/linux/elf32ppclinux.x,
	scripts/openmcl, xdump/.cvsignore, xdump/faslenv.lisp,
	xdump/hashenv.lisp, xdump/heap-image.lisp, xdump/xfasload.lisp,
	xdump/xppcfasload.lisp, xdump/xsparcfasload.lisp, xdump/xsym.lisp,
	OpenMCL.app/Contents/Info.plist, OpenMCL.app/Contents/PkgInfo,
	OpenMCL.app/Contents/Resources/OpenMCLKeyBindings.dict,
	OpenMCL.app/Contents/Resources/openmcl-icon.icns,
	OpenMCL.app/Contents/Resources/English.lproj/Credits.rtf,
	OpenMCL.app/Contents/Resources/English.lproj/InfoPlist.strings,
	OpenMCL.app/Contents/Resources/English.lproj/MainMenu.nib/classes.n
	ib,
	OpenMCL.app/Contents/Resources/English.lproj/MainMenu.nib/info.nib,
	OpenMCL.app/Contents/Resources/English.lproj/MainMenu.nib/objects.n
	ib,
	OpenMCL.app/Contents/Resources/English.lproj/MainMenu~.nib/classes.
	nib,
	OpenMCL.app/Contents/Resources/English.lproj/MainMenu~.nib/info.nib
	,
	OpenMCL.app/Contents/Resources/English.lproj/MainMenu~.nib/objects.
	nib,
	OpenMCL.app/Contents/Resources/English.lproj/OpenmclInspector.nib/c
	lasses.nib,
	OpenMCL.app/Contents/Resources/English.lproj/OpenmclInspector.nib/i
	nfo.nib,
	OpenMCL.app/Contents/Resources/English.lproj/OpenmclInspector.nib/o
	bjects.nib,
	OpenMCL.app/Contents/Resources/English.lproj/lispeditor.nib/classes
	.nib,
	OpenMCL.app/Contents/Resources/English.lproj/lispeditor.nib/info.ni
	b,
	OpenMCL.app/Contents/Resources/English.lproj/lispeditor.nib/objects
	.nib,
	OpenMCL.app/Contents/Resources/English.lproj/lispeditor~.nib/classe
	s.nib,
	OpenMCL.app/Contents/Resources/English.lproj/lispeditor~.nib/info.n
	ib,
	OpenMCL.app/Contents/Resources/English.lproj/lispeditor~.nib/object
	s.nib, OpenMCL.app/Contents/Resources/Help/cocoa-notes.html,
	OpenMCL.app/Contents/Resources/Help/index.html,
	bindarwin/.cvsignore, doc/HTML/.cvsignore,
	examples/CocoaBridgeDoc.txt, examples/bridge.lisp,
	examples/cocoa-application.lisp, examples/cocoa-editor.lisp,
	examples/cocoa-inspector.lisp, examples/cocoa-textfind.lisp,
	examples/gnu-objc.lisp, examples/hemlock-textstorage.lisp,
	examples/jni.lisp, examples/name-translation.lisp,
	examples/objc-support.lisp, examples/process-objc-modules.lisp,
	examples/tiny.lisp, examples/webkit.lisp, hemlock/INSTALL,
	hemlock/README, hemlock/TODO, hemlock/hemlock.system,
	hemlock/hemlock11.cursor, hemlock/hemlock11.mask,
	hemlock/bin/openmcl/.cvsignore, hemlock/doc/cim/aux-sys.mss,
	hemlock/doc/cim/cim.mss, hemlock/doc/misc/compilation.order,
	hemlock/doc/misc/hemlock.log, hemlock/doc/misc/hemlock.upd,
	hemlock/doc/misc/notes.txt, hemlock/doc/misc/perq-hemlock.log,
	hemlock/doc/misc/things-to-do.txt,
	hemlock/doc/scribe-converter/NOTES,
	hemlock/doc/scribe-converter/README, hemlock/doc/user/commands.mss,
	hemlock/doc/user/intro.mss, hemlock/doc/user/lisp.mss,
	hemlock/doc/user/mail.mss, hemlock/doc/user/netnews.mss,
	hemlock/doc/user/special-modes.mss, hemlock/doc/user/user.mss,
	hemlock/src/abbrev.lisp, hemlock/src/auto-save.lisp,
	hemlock/src/bindings-gb.lisp, l1-dfsls/.cvsignore,
	hemlock/src/bindings.lisp, hemlock/src/bit-display.lisp,
	hemlock/src/bit-screen.lisp, hemlock/src/bufed.lisp,
	hemlock/src/buffer.lisp, hemlock/src/charmacs.lisp,
	hemlock/src/command.lisp, hemlock/src/comments.lisp,
	hemlock/src/completion.lisp, hemlock/src/cursor.lisp,
	hemlock/src/debug.lisp, hemlock/src/decls.lisp,
	hemlock/src/defsyn.lisp, hemlock/src/dired.lisp,
	hemlock/src/diredcoms.lisp, hemlock/src/display.lisp,
	hemlock/src/doccoms.lisp, hemlock/src/dylan.lisp,
	hemlock/src/echo.lisp, hemlock/src/echocoms.lisp,
	hemlock/src/edit-defs.lisp, hemlock/src/eval-server.lisp,
	hemlock/src/filecoms.lisp, hemlock/src/files.lisp,
	hemlock/src/fill.lisp, hemlock/src/font.lisp,
	hemlock/src/group.lisp, hemlock/src/hemlock-ext.lisp,
	hemlock/src/highlight.lisp, hemlock/src/htext1.lisp,
	hemlock/src/htext2.lisp, hemlock/src/htext3.lisp,
	hemlock/src/htext4.lisp, hemlock/src/hunk-draw.lisp,
	hemlock/src/icom.lisp, hemlock/src/indent.lisp,
	hemlock/src/input.lisp, hemlock/src/interp.lisp,
	hemlock/src/kbdmac.lisp, hemlock/src/key-event.lisp,
	hemlock/src/keysym-defs.lisp, hemlock/src/killcoms.lisp,
	hemlock/src/line.lisp, hemlock/src/linimage.lisp,
	hemlock/src/lisp-lib.lisp, hemlock/src/lispbuf.lisp,
	hemlock/src/lispdep.lisp, hemlock/src/lispeval.lisp,
	hemlock/src/lispmode.lisp, hemlock/src/macros.lisp,
	hemlock/src/main.lisp, hemlock/src/mh.lisp, hemlock/maint/publish,
	hemlock/resources/XKeysymDB, hemlock/resources/mh-scan,
	hemlock/src/morecoms.lisp, hemlock/src/netnews.lisp,
	hemlock/src/overwrite.lisp, hemlock/src/package.lisp,
	hemlock/src/pascal.lisp, hemlock/src/pop-up-stream.lisp,
	hemlock/src/rcs.lisp, hemlock/src/register.lisp,
	hemlock/src/ring.lisp, hemlock/src/rompsite.lisp,
	hemlock/src/screen.lisp, hemlock/src/scribe.lisp,
	hemlock/src/search1.lisp, hemlock/src/search2.lisp,
	hemlock/src/searchcoms.lisp, hemlock/src/shell.lisp,
	hemlock/src/spell-aug.lisp, hemlock/src/spell-corr.lisp,
	hemlock/src/spell-rt.lisp, hemlock/src/spellcoms.lisp,
	hemlock/src/srccom.lisp, hemlock/src/streams.lisp,
	hemlock/src/struct.lisp, hemlock/src/syntax.lisp,
	hemlock/src/table.lisp, hemlock/src/text.lisp,
	hemlock/src/ts-buf.lisp, hemlock/src/ts-stream.lisp,
	hemlock/src/undo.lisp, hemlock/src/unixcoms.lisp,
	hemlock/src/vars.lisp, hemlock/src/window.lisp,
	hemlock/src/winimage.lisp, hemlock/src/xcoms.lisp,
	hemlock/src/elisp/README, hemlock/src/elisp/base.lisp,
	hemlock/src/elisp/cmucl-hemlock-glue.lisp,
	hemlock/src/elisp/codewalker.lisp, hemlock/src/elisp/compile.lisp,
	hemlock/src/elisp/hemlock-shims.lisp,
	hemlock/src/elisp/implementation-needed,
	hemlock/src/elisp/internals.lisp, hemlock/src/elisp/loadup.lisp,
	hemlock/src/elisp/packages.lisp, hemlock/src/elisp/read-table.lisp,
	hemlock/src/spell/README, hemlock/src/spell/build.lisp,
	hemlock/src/spell/classes.lisp, hemlock/src/spell/constants.lisp,
	hemlock/src/spell/correlate.lisp, hemlock/src/spell/flags.lisp,
	hemlock/src/spell/hashing.lisp, hemlock/src/spell/io.lisp,
	hemlock/src/spell/package.lisp, hemlock/src/spell/spell-aug.lisp,
	hemlock/src/spell/spell-dictionary.text,
	hemlock/src/spell/spell.asd, hemlock/src/spell/spellcoms.lisp,
	hemlock/src/tty/termcap.lisp, hemlock/src/tty/tty-disp-rt.lisp,
	hemlock/src/tty/tty-display.lisp, hemlock/src/tty/tty-screen.lisp,
	hemlock/src/wire/Notes, hemlock/src/wire/package.lisp,
	hemlock/src/wire/port.lisp, hemlock/src/wire/remote.lisp,
	hemlock/src/wire/wire.lisp,
	hemlock/resources/spell-dictionary.text,
	hemlock/unused/bit-stream.lisp, hemlock/unused/clx-ext.lisp,
	hemlock/unused/ed-integrity.lisp, hemlock/unused/gosmacs.lisp,
	hemlock/unused/hacks.lisp, hemlock/unused/hemcom.lisp,
	hemlock/unused/hi-integrity.lisp, hemlock/unused/keytran.lisp,
	hemlock/unused/keytrandefs.lisp, hemlock/unused/spell-build.lisp,
	hemlock/unused/struct-ed.lisp, hemlock/unused/tty-stream.lisp,
	hemlock/website/index.html.in: Initial revision

