# -*- coding: unix -*-

# Try to determine the svn revishion
SVNREV = $(shell /usr/bin/svnversion)

# The local stylesheet imports the generic stylesheets and
# sets some custom parameters.

STYLESHEET = xsl/openmcl.xsl

# Obtain a temporary ID to be used as the identifier of this invocation of
# make.

TEMP := build-$(shell date +%s)

# Save the current directory for use in the tarfile target.

CWD := $(shell pwd)

# There's datestamps on the page; let's make sure they're in
# UTC instead of local time.

export TZ = UTC

# Compute some targets.

XMLFILES = $(wildcard *.xml)
XSLFILES = $(shell find xsl -name "*.xsl")
HTMLFILES = ccl-documentation.html

# Save the xsltproc version string for use in debugging.

XSLTPROCVERSION = $(shell $(XSLTPROC) --version | head -n 1)

# Try to determine the svn revishion
SVNREV = $(shell /usr/bin/svnversion)


.PHONY: all clean distclean show


include makehtml

all: ${TEMP} ${HTMLFILES} distclean
	echo ${HTMLFILES}


install: $(HTMLFILES) distclean
	cp $(HTMLFILES) ../

$(TEMP):
	mkdir $(TEMP)

clean:
	rm -rf build-* ${HTMLFILES}

distclean: clean
	rm -f *~

