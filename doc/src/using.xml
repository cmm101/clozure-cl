<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd"[
          <!ENTITY rest "<varname>&amp;rest</varname>">
          <!ENTITY key "<varname>&amp;key</varname>">
          <!ENTITY optional "<varname>&amp;optional</varname>">
          <!ENTITY body "<varname>&amp;body</varname>">
          <!ENTITY aux "<varname>&amp;aux</varname>">
          <!ENTITY allow-other-keys "<varname>&amp;allow-other-keys</varname>">
          <!ENTITY CCL "Clozure CL">
          ]>

<chapter id="using-ccl"><title>Using &CCL;</title>
  
  <!-- ============================================================ -->
  <sect1 id="using-ccl-introduction"><title>Introduction</title>
    
    <para>The Common Lisp standard allows considerable latitude in the
      details of an implementation, and each particular Common Lisp
      system has some idiosyncrasies. This chapter describes ordinary
      user-level features of &CCL;, including features that may be
      part of the Common Lisp standard, but which may have quirks or
      details in the &CCL; implementation that are not described by
      the standard. It also describes extensions to the standard; that
      is, features of &CCL; that are not part of the Common Lisp
      standard at all.</para>

  </sect1>

  <!-- ============================================================ -->
  <sect1 id="Trace"><title>Trace</title>

    <para>
      &CCL;'s tracing facility is invoked by an extended version of the Common Lisp
      <varname>trace</varname> macro.  Extensions allow tracing of methods, as well as finer control
      over tracing actions.
    </para>

    <para>
      <indexterm zone="trace"/>
      <command><varname id="trace">TRACE</varname> {<replaceable>keyword</replaceable>
        <replaceable>global-value</replaceable>}* {<replaceable>spec</replaceable> |
        (<replaceable>spec</replaceable> {<replaceable>keyword</replaceable>
        <replaceable>local-value</replaceable>}*)}* [Macro]</command>
    </para>

    <para>
      The <varname>trace</varname> macro encapsulates the functions named by
      <replaceable>spec</replaceable>s, causing trace actions to take place on entry and
      exit from each function.  The default actions print a message on function entry and
      exit. <replaceable>Keyword</replaceable>/<replaceable>value</replaceable> options
      can be used to specify changes in the default behavior.
    </para>

    <para>
      Invoking <varname>(trace)</varname> without arguments returns a list of functions being traced.
    </para>
    
    <para>
      A <replaceable>spec</replaceable> is either a symbol that is the name of a function, or an
      expression of the form <varname>(setf <replaceable>symbol</replaceable>)</varname>, or a
      specific method of a generic function in the form <varname>(:method
        <replaceable>gf-name</replaceable> {<replaceable>qualifier</replaceable>}*
        ({<replaceable>specializer</replaceable>}*))</varname>, where a
      <replaceable>specializer</replaceable> can be the name of a class or an <varname>EQL</varname>
      specializer.
    </para>

    <para>
      A <replaceable>spec</replaceable> can also be a string naming a package, or equivalently a
      list <varname>(:package <replaceable>package-name</replaceable>)</varname>, in order to
      request that all functions in the package to be traced.
    </para>

    <para>
      By default, whenever a traced function is entered or exited, a short message is
      printed on <varname>*trace-output*</varname> showing the arguments on entry and
      values on exit.  Options specified as key/value pairs can be used to modify this
      behavior.  Options preceding the function <replaceable>spec</replaceable>s apply to
      all the functions being traced.  Options specified along with a
      <replaceable>spec</replaceable> apply to that spec only and override any
      global options. The following options are supported:
    </para>

    <variablelist>

      <varlistentry>
	    <term><varname>:methods {T | nil}</varname></term>
	    <listitem>
	      <para> If true, and if applied to a <replaceable>spec</replaceable> naming a generic
	        function, arranges to trace all the methods of the generic function in addition to the
	        generic function itself.
	      </para>
	    </listitem>
      </varlistentry>

      <varlistentry>
	    <term><varname>:inside <replaceable>outside-spec</replaceable>
	        | ({<replaceable>outside-spec</replaceable>}*)</varname></term>
	    <listitem>
	      <para>Inhibits all trace actions unless the current
	        invocation of the function being traced is inside one of the
	        <replaceable>outside-spec</replaceable>'s, i.e. unless a function named by one of the
	        <replaceable>outside-spec</replaceable>'s is currently on the stack.
	        <replaceable>outside-spec</replaceable> can name a function, a
	        method, or a package, as above.
	      </para>
	    </listitem>
      </varlistentry>

      <varlistentry>
	    <term><varname>:if <replaceable>form</replaceable></varname></term>
	    <term><varname>:condition <replaceable>form</replaceable></varname></term>
	    <listitem>
	      <para> Evaluates <replaceable>form</replaceable> whenever the function being traced is
	        about to be entered, and inhibits all trace actions if <replaceable>form</replaceable>
	        returns nil. The form may reference the lexical variable <varname>ccl::args</varname>,
	        which is a list of the arguments in this call. <varname>:condition</varname> is just a
	        synonym for <varname>:if</varname>, though if both are specified, both must return non-nil.
	      </para>
	    </listitem>
      </varlistentry>

      <varlistentry>
	    <term><varname>:before-if <replaceable>form</replaceable></varname></term>
	    <listitem>
	      <para> Evaluates <replaceable>form</replaceable> whenever the function being traced is
	        about to be entered, and inhibits the entry trace actions if
	        <replaceable>form</replaceable> returns nil.  The form may reference the lexical variable
	        <varname>ccl::args</varname>, which is a list of the arguments in this call. If both
	        <varname>:if</varname> and <varname>:before-if</varname> are specified, both must return
	        non-nil in order for the before entry actions to happen.
	      </para>
	    </listitem>
      </varlistentry>

      <varlistentry>
	    <term><varname>:after-if <replaceable>form</replaceable></varname></term>
	    <listitem>
	      <para> Evaluates <replaceable>form</replaceable> whenever the function being traced has
	        just exited, and inhibits the exit trace actions if <replaceable>form</replaceable>
	        returns nil.  The form may reference the lexical variable <varname>ccl::vals</varname>,
	        which is a list of values returned by this call. If both <varname>:if</varname> and
	        <varname>:after-if</varname> are specified, both must return non-nil in order for the
	        after exit actions to happen.
	      </para>
	    </listitem>
      </varlistentry>

      <varlistentry>
	    <term><varname>:print-before <replaceable>form</replaceable></varname></term>
	    <listitem>
	      <para> Evaluates <replaceable>form</replaceable> whenever the function being traced is
	        about to be entered, and prints the result before printing the standard entry message.
	        The form may reference the lexical variable <varname>ccl::args</varname>, which is a list
	        of the arguments in this call.  To see multiple forms, use <varname>values</varname>:
	        <varname>:print-before (values (one-thing) (another-thing))</varname>.
	      </para>
	    </listitem>
      </varlistentry>

      <varlistentry>
	    <term><varname>:print-after <replaceable>form</replaceable></varname></term>
	    <listitem>
	      <para> Evaluates <replaceable>form</replaceable> whenever the function being traced has
	        just exited, and prints the result after printing the standard exit message.  The form may
	        reference the lexical variable <varname>ccl::vals</varname>, which is a list of values
	        returned by this call. To see multiple forms, use <varname>values</varname>:
	        <varname>:print-after (values (one-thing) (another-thing))</varname>.
	      </para>
	    </listitem>
      </varlistentry>

      <varlistentry>
	    <term><varname>:print <replaceable>form</replaceable></varname></term>
	    <listitem>
	      <para>Equivalent to <varname>:print-before <replaceable>form</replaceable> :print-after <replaceable>form</replaceable></varname>.
	      </para>
	    </listitem>
      </varlistentry>

      <varlistentry>
	    <term><varname>:eval-before <replaceable>form</replaceable></varname></term>
	    <listitem>
	      <para>Evaluates <replaceable>form</replaceable> whenever the function being traced is
	        about to be entered.  The form may reference the lexical variable
	        <varname>ccl::args</varname>, which is a list of the arguments in this call.
	      </para>
	    </listitem>
      </varlistentry>

      <varlistentry>
	    <term><varname>:eval-after <replaceable>form</replaceable></varname></term>
	    <listitem>
	      <para>Evaluates <replaceable>form</replaceable> whenever the function being has just
	        exited.  The form may reference the lexical variable <varname>ccl::vals</varname>, which
	        is a list of values returned by this call.
	      </para>
	    </listitem>
      </varlistentry>

      <varlistentry>
	    <term><varname>:eval <replaceable>form</replaceable></varname></term>
	    <listitem>
	      <para>Equivalent to <varname>:eval-before <replaceable>form</replaceable>
	          :eval-after <replaceable>form</replaceable></varname>.
	      </para>
	    </listitem>
      </varlistentry>

      <varlistentry>
	    <term><varname>:break-before <replaceable>form</replaceable></varname></term>
	    <listitem>
	      <para>Evaluates <replaceable>form</replaceable> whenever the function being traced is
	        about to be entered, and if the result is non-nil, enters a debugger break loop.  The form
	        may reference the lexical variable <varname>ccl::args</varname>, which is a list of the
	        arguments in this call.
	      </para>
	    </listitem>
      </varlistentry>

      <varlistentry>
	    <term><varname>:break-after <replaceable>form</replaceable></varname></term>
	    <listitem>
	      <para>Evaluates <replaceable>form</replaceable> whenever the function being traced has
	        just exited, and if the result is non-nil, enters a debugger break loop. The form may
	        reference the lexical variable <varname>ccl::vals</varname>, which is a list of values
	        returned by this call.
	      </para>
	    </listitem>
      </varlistentry>

      <varlistentry>
	    <term><varname>:break <replaceable>form</replaceable></varname></term>
	    <listitem>
	      <para>Equivalent to <varname>:break-before <replaceable>form</replaceable> :break-after <replaceable>form</replaceable></varname>.
	      </para>
	    </listitem>
      </varlistentry>

      <varlistentry>
	    <term><varname>:backtrace-before <replaceable>form</replaceable></varname></term>
	    <term><varname>:backtrace <replaceable>form</replaceable></varname></term>
	    <listitem>
	      <para>Evaluates <replaceable>form</replaceable> whenever the function being traced is
	        about to be entered.  The form may reference the lexical variable
	        <varname>ccl::args</varname>, which is a list of the arguments in this call. The value
	        returned by <replaceable>form</replaceable> is intepreted as follows:
	      </para>

	      <variablelist>

	        <varlistentry>
	          <term><varname>nil</varname></term>
	          <listitem><para>does nothing</para></listitem>
	        </varlistentry>

	        <varlistentry>
	          <term><varname>:detailed</varname></term>
	          <listitem><para>prints a detailed backtrace to
	              <varname>*trace-output*</varname>.</para></listitem>
	        </varlistentry>

	        <varlistentry>
	          <term><varname>(:detailed <replaceable>integer</replaceable>)</varname></term>
	          <listitem><para>prints the top <replaceable>integer</replaceable> frames of detailed
	              backtrace to <varname>*trace-output*</varname>.
	          </para></listitem>
	        </varlistentry>

	        <varlistentry>
	          <term><replaceable>integer</replaceable></term>
	          <listitem><para>prints top <replaceable>integer</replaceable> frames of a terse
	              backtrace to <varname>*trace-output*</varname>.
	          </para></listitem>
	        </varlistentry>

	        <varlistentry>
	          <term>anything else</term>
	          <listitem><para>prints a terse backtrace to <varname>*trace-output*</varname>.
	          </para></listitem>
	        </varlistentry>
	      </variablelist>
	      <para>
	        Note that unlike with the other options, <varname>:backtrace</varname> is equivalent to
	        <varname>:backtrace-before</varname> only, not both before and after, since it's usually
	        not helpful to print the same backtrace both before and after the function call.
	      </para>
	    </listitem>
      </varlistentry>

      <varlistentry>
	    <term><varname>:backtrace-after <replaceable>form</replaceable></varname></term>
	    <listitem>
	      <para>Evaluates <replaceable>form</replaceable> whenever the function being traced has
	        just exited.  The form may reference the lexical variable <varname>ccl::vals</varname>,
	        which is a list of values returned by this call. The value returned by
	        <replaceable>form</replaceable> is intepreted as follows:
	      </para>

	      <variablelist>

	        <varlistentry>
	          <term><varname>nil</varname></term>
	          <listitem><para>does nothing</para></listitem>
	        </varlistentry>

	        <varlistentry>
	          <term><varname>:detailed</varname></term>
	          <listitem><para>prints a detailed backtrace to
	              <varname>*trace-output*</varname>.</para></listitem>
	        </varlistentry>

	        <varlistentry>
	          <term><varname>(:detailed <replaceable>integer</replaceable>)</varname></term>
	          <listitem><para>prints the top <replaceable>integer</replaceable> frames of detailed
	              backtrace to <varname>*trace-output*</varname>.
	          </para></listitem>
	        </varlistentry>

	        <varlistentry>
	          <term><replaceable>integer</replaceable></term>
	          <listitem><para>prints top <replaceable>integer</replaceable> frames of a terse
	              backtrace to <varname>*trace-output*</varname>.
	          </para></listitem>
	        </varlistentry>

	        <varlistentry>
	          <term>anything else</term>
	          <listitem><para>prints a terse backtrace to <varname>*trace-output*</varname>.
	          </para></listitem>
	        </varlistentry>
	      </variablelist>
	    </listitem>
      </varlistentry>

      <varlistentry>
        <term><varname>:before</varname> <replaceable>action</replaceable></term>
        <listitem>
	      <para>specifies the action to be taken just before the traced function is entered.  <replaceable>action</replaceable> is one of:</para>

	      <variablelist>
	        <varlistentry>
	          <term><varname>:print</varname></term>
	          <listitem>
		        <para>The default, prints a short indented message showing the function name and the invocation arguments</para>
	          </listitem>
	        </varlistentry>

	        <varlistentry>
	          <term><varname>:break</varname></term>
	          <listitem>
		        <para>Equivalent to <varname>:before :print :break-before t</varname></para>
	          </listitem>
	        </varlistentry>

	        <varlistentry>
	          <term><varname>:backtrace</varname></term>
	          <listitem>
		        <para>Equivalent to <varname>:before :print :backtrace-before t</varname></para>
	          </listitem>
	        </varlistentry>


	        <varlistentry>
	          <term><replaceable>function</replaceable></term>
	          <listitem>
		        <para>
                  Any other value is interpreted as a function to call on entry instead of
                  printing the standard entry message.  It is called with its first
                  argument being the name of the function being traced, the remaining
                  arguments being all the arguments to the function being traced, and
                  <varname>ccl:*trace-level*</varname> bound to the current nesting level
                  of trace actions. </para>
	          </listitem>
	        </varlistentry>
	      </variablelist>
	    </listitem>
      </varlistentry>

      <varlistentry>

        <term><varname>:after</varname> <replaceable>action</replaceable></term>
        <listitem>

	      <para>specifies the action to be taken just after the traced function exits.  <replaceable>action</replaceable> is one of:</para>

	      <variablelist>
	        <varlistentry>
	          <term><varname>:print</varname></term>
	          <listitem>
	            <para>The default, prints a short indented message showing the function name and the
	              returned values </para>
	          </listitem>
	        </varlistentry>

	        <varlistentry>
	          <term><varname>:break</varname></term>
	          <listitem>
	            <para>Equivalent to <varname>:after :print :break-after t</varname></para>
	          </listitem>
	        </varlistentry>

		    <varlistentry>
		      <term><varname>:backtrace</varname></term>
		      <listitem>
		        <para>Equivalent to <varname>:after :print :backtrace-after t</varname></para>
		      </listitem>
		    </varlistentry>

	        <varlistentry>
	          <term><replaceable>function</replaceable></term>
	          <listitem>
	            <para>Any other value is interpreted as a function to
	              call on exit instead of printing the standard exit
	              message.  It is called with its first argument being
	              the name of the function being traced, the
	              remaining arguments being all the values returned by the function
	              being traced, and ccl:*trace-level* bound to the current
	              nesting level of trace actions.
	            </para>
	          </listitem>
	        </varlistentry>
	      </variablelist>
        </listitem>
      </varlistentry>

    </variablelist>


    <para>
      <indexterm zone="trace-level"/>
      <command><varname id="trace-level">CCL:*TRACE-LEVEL*</varname>    [Variable]</command>
    </para>

    <para>Variable bound to the current nesting level during execution of before and after trace actions.  The default printing actions use it to determine the amount of indentation.</para>

    <para>
      <indexterm zone="trace-max-indent"/>
      <command><varname id="trace-max-indent">CCL:*TRACE-MAX-INDENT*</varname>    [Variable]</command>
    </para>

    <para>The default before and after print actions will not indent by more than the value of <varname>ccl:*trace-max-indent*</varname> regardless of the current trace level.</para>

    <para>
      <indexterm zone="trace-function"/>
      <command><varname id="trace-function">CCL:TRACE-FUNCTION</varname> <replaceable>spec</replaceable> &key; {<replaceable>keyword</replaceable> <replaceable>value</replaceable>}*    [Function]</command>
    </para>
    
    <para>
      This is a functional version of the TRACE macro.  <replaceable>spec</replaceable> and
      <replaceable>keyword</replaceable>s are as for TRACE, except that all arguments are evaluated.
    </para>

    <para>
      <indexterm zone="trace-print-level"/>
      <command><varname id="trace-print-level">CCL:*TRACE-PRINT-LEVEL*</varname>   [Variable]</command>
    </para>

    <para>The default print actions bind <varname>CL:*PRINT-LEVEL*</varname> to this value while
      printing. Note that this rebinding is only in effect during the default entry and exit messages.
      It does not apply to printing of <varname>:print-before/:print-after</varname> forms or any
      explicit printing done by user code.</para>

    <para>
      <indexterm zone="trace-print-length"/>
      <command><varname id="trace-print-length">CCL:*TRACE-PRINT-LENGTH*</varname>    [Variable]</command>
    </para>
    
    <para>The default print actions bind <varname>CL:*PRINT-LENGTH*</varname> to this value while
      printing. Note that this rebinding is only in effect during the default entry and exit messages.
      It does not apply to printing of <varname>:print-before/:print-after</varname> forms or any
      explicit printing done by user code.</para>

    <para>
      <indexterm zone="trace-bar-frequency"/>
      <command><varname id="trace-bar-frequency">CCL:*TRACE-BAR-FREQUENCY*</varname>    [Variable]</command>
    </para>

    <para>By default, this is nil. If non-nil it should be a integer,
    and the default entry and exit messages will print a | instead of
    space every this many levels of indentation.</para>


  </sect1>

  <sect1 id="Unicode"><title>Unicode</title>

    <para>All characters and strings in &CCL; fully support Unicode by
    using UTF-32. There is only one <literal>CHARACTER</literal> type
    and one <literal>STRING</literal> type in &CCL;.  There has been a
    lot of discussion about this decision which can be found by
    searching the openmcl-devel archives at <ulink
    url="http://clozure.com/pipermail/openmcl-devel/"/>.  Suffice it
    to say that we decided that the simplicity and speed advantages of
    only supporting UTF-32 outweigh the space disadvantage.</para>



  <sect2 id="unicode-characters"><title>Characters</title>
    <para>There is one <literal>CHARACTER</literal> type in &CCL;.
    All <literal>CHARACTER</literal>s are
    <literal>BASE-CHAR</literal>s.  <varname>CHAR-CODE-LIMIT</varname>
    is now <literal>#x110000</literal>, which means that all Unicode
    characters can be directly represented.  As of Unicode 5.0, only
    about 100,000 of 1,114,112 possible <literal>CHAR-CODE</literal>s
    are actually defined. The function <function>CODE-CHAR</function>
    knows that certain ranges of code values (notably
    <literal>#xd800</literal>-<literal>#xddff</literal>) will never be
    valid character codes and will return <literal>NIL</literal> for
    arguments in that range, but may return a
    non-<literal>NIL</literal> value (an undefined/non-standard
    <literal>CHARACTER</literal> object) for other unassigned code
    values.</para>

    <para>&CCL; supports character names of the form
    <literal>u+xxxx</literal>&mdash;where <literal>x</literal> is a
    sequence of one or more hex digits.  The value of the hex digits
    denotes the code of the character.  The <literal>+</literal>
    character is optional, so <literal>#\u+0020</literal>,
    <literal>#\U0020</literal>, and <literal>#\U+20</literal> all
    refer to the <literal>#\Space</literal> character.</para>

    <para>Characters with codes in the range
    <literal>#xa0</literal>-<literal>#x7ff</literal> also have
    symbolic names These are the names from the Unicode standard with
    spaces replaced by underscores.  So
    <literal>#\Greek_Capital_Letter_Epsilon</literal> can be used to
    refer to the character whose <function>CHAR-CODE</function> is
    <literal>#x395</literal>.  To see the complete list of supported
    character names, look just below the definition for
    <function>register-character-name</function> in
    <literal>ccl:level-1;l1-reader.lisp</literal>.</para>
  </sect2>


  <sect2 id="External-Formats"><title>External Formats</title>
    <para><function>OPEN</function>, <function>LOAD</function>, and
    <function>COMPILE-FILE</function> all take an
    <literal>:EXTERNAL-FORMAT</literal> keyword argument.  The value
    of <literal>:EXTERNAL-FORMAT</literal> can be
    <literal>:DEFAULT</literal> (the default value), a line
    termination keyword (see <xref
    linkend="Line-Termination-Keywords"/>), a character encoding
    keyword (see <xref linkend="Character-Encodings"/>), an
    external-format object created using
    <function>CCL::MAKE-EXTERNAL-FORMAT</function> (see <xref
    linkend="f_make-external-format"/>), or a plist with keys:
    <literal>:DOMAIN</literal>, <literal>:CHARACTER-ENCODING</literal>
    and <literal>:LINE-TERMINATION</literal>.  If
    <parameter>argument</parameter> is a plist, the result of
    <literal>(APPLY #'MAKE-EXTERNAL-FORMAT
    <parameter>argument</parameter>)</literal> will be used.</para>

    <para>If <literal>:DEFAULT</literal> is specified, then the value
    of <varname>CCL:*DEFAULT-EXTERNAL-FORMAT*</varname> is used.  If
    no line-termination is specified, then the value of
    <varname>CCL:*DEFAULT-LINE-TERMINATION*</varname> is used, which
    defaults to <literal>:UNIX</literal>.  If no character encoding is
    specified, then
    <varname>CCL:*DEFAULT-FILE-CHARACTER-ENCODING*</varname> is used
    for file streams and
    <varname>CCL:*DEFAULT-SOCKET-CHARACTER-ENCODING*</varname> is used
    for socket streams.  The default, default character encoding is
    <literal>NIL</literal> which is a synonym for
    <literal>:ISO-8859-1</literal>.</para>

    <para>Note that the set of keywords used to denote
    CHARACTER-ENCODINGs and the set of keywords used to denote
    line-termination conventions is disjoint: a keyword denotes at
    most a character encoding or a line termination convention, but
    never both.</para>

    <para>EXTERNAL-FORMATs are objects (structures) with three
    read-only fields that can be accessed via the functions:
    <function>EXTERNAL-FORMAT-DOMAIN</function>,
    <function>EXTERNAL-FORMAT-LINE-TERMINATION</function> and
    <function>EXTERNAL-FORMAT-CHARACTER-ENCODING</function>.</para>

  
    <refentry id="f_make-external-format">
      <indexterm zone="f_make-external-format">
	<primary>make-external-format</primary>
      </indexterm>
      
      <refnamediv>
	<refname>MAKE-EXTERNAL-FORMAT</refname>
	<refpurpose>Either creates a new external format object, or
	return an existing one with the same specified slot
	values.</refpurpose>
	<refclass>Function</refclass>
      </refnamediv>

      <refsynopsisdiv>
	<synopsis>
	  <function>make-external-format</function>
	  &key; domain character-encoding line-termination
	  => external-format
	</synopsis>
      </refsynopsisdiv>

      <refsect1>
	<title>Arguments and Values</title>
	
	<variablelist>
	  <varlistentry>
	    <term>domain</term>
	    <listitem>
	      <para>This is used to indicate where the external
	      format is to be used.  Its value can be almost
	      anything.  It defaults to <literal>NIL</literal>.
	      There are two domains that have a pre-defined meaning in
	      &CCL;: <literal>:FILE</literal> indicates
	      encoding for a file in the file system and
	      <literal>:SOCKET</literal> indicates i/o to/from a
	      socket.  The value of <parameter>domain</parameter>
	      affects the default values for
	      <parameter>character-encoding</parameter> and
	      <parameter>line-termination</parameter>.</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>character-encoding</term>
	    <listitem>
	      <para>A keyword that specifies the character encoding
	      for the external format. <xref
	      linkend="Character-Encodings"/>.  Defaults to
	      <literal>:DEFAULT</literal> which means if
	      <parameter>domain</parameter> is
	      <literal>:FILE</literal> use the value of the variable
	      <varname>CCL:*DEFAULT-FILE-CHARACTER-ENCODING*</varname>
	      and if <parameter>domain</parameter> is
	      <literal>:SOCKET</literal>, use the value of the
	      variable
	      <varname>CCL:*DEFAULT-SOCKET-CHARACTER-ENCODING*</varname>.
	      The initial value of both of these variables is
	      <literal>NIL</literal>, which means the
	      <literal>:ISO-8859-1</literal> encoding.</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>line-termination</term>
	    <listitem>
	      <para>A keyword that indicates a line termination
	      keyword <xref linkend="Line-Termination-Keywords"/>.
	      Defaults to <literal>:DEFAULT</literal> which means
	      use the value of the variable
	      <varname>CCL:*DEFAULT-LINE-TERMINATION*</varname>.</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>external-format</term>
	    <listitem>
	      <para>An external-format object as described above.</para>
	    </listitem>
	  </varlistentry>
	</variablelist>
      </refsect1>
      
      <refsect1>
	<title>Description</title>
	
	<para>Despite the function's name, it doesn't necessarily create a
	new, unique EXTERNAL-FORMAT object: two calls to
	MAKE-EXTERNAL-FORMAT with the same arguments made in the same
	dynamic environment return the same (eq) object.
	</para>
      </refsect1>
    </refentry>

  </sect2>

  <sect2 id="Line-Termination-Keywords"><title>Line Termination Keywords</title>
  <para>Line termination keywords indicate which characters are used
  to indicate the end of a line.  On input, the external line
  termination characters are replaced by <literal>#\Newline</literal>
  and on output, <literal>#\Newline</literal>s are converted to the
  external line termination characters.</para>
  <table id="Line-Termination-Table" frame='all'><title>Line Termination Keywords</title>
  <tgroup cols='2' align='left' colsep='1' rowsep='1'>
    <thead>
      <row>
	<entry>keyword</entry>
	<entry>character(s)</entry>
      </row>
    </thead>
    <tbody>
      <row>
	<entry><literal>:UNIX</literal></entry>
	<entry><literal>#\Linefeed</literal></entry>
      </row>
      <row>
	<entry><literal>:MACOS</literal></entry>
	<entry><literal>#\Return</literal></entry>
      </row>
      <row>
	<entry><literal>:CR</literal></entry>
	<entry><literal>#\Return</literal></entry>
      </row>
      <row>
	<entry><literal>:CRLF</literal></entry>
	<entry><literal>#\Return #\Linefeed</literal></entry>
      </row>
      <row>
	<entry><literal>:CP/M</literal></entry>
	<entry><literal>#\Return #\Linefeed</literal></entry>
      </row>
      <row>
	<entry><literal>:MSDOS</literal></entry>
	<entry><literal>#\Return #\Linefeed</literal></entry>
      </row>
      <row>
	<entry><literal>:DOS</literal></entry>
	<entry><literal>#\Return #\Linefeed</literal></entry>
      </row>
      <row>
	<entry><literal>:WINDOWS</literal></entry>
	<entry><literal>#\Return #\Linefeed</literal></entry>
      </row>
      <row>
	<entry><literal>:INFERRED</literal></entry>
	<entry>see below</entry>
      </row>
      <row>
	<entry><literal>:UNICODE</literal></entry>
	<entry><literal>#\Line_Separator</literal></entry>
      </row>
    </tbody>
  </tgroup>
  </table>
  <para><literal>:INFERRED</literal> means that a stream's
  line-termination convention is determined by looking at the contents
  of a file.  It is only useful for <literal>FILE-STREAM</literal>s
  that're open for <literal>:INPUT</literal> or
  <literal>:IO</literal>.  The first buffer full of data is examined,
  and if a <literal>#\Return</literal> character occurs before any
  <literal>#\Linefeed</literal> character, then the line termination
  type is set to <literal>:MACOS</literal>, otherwise it is set to
  <literal>:UNIX</literal>.</para>
  </sect2>
  


  <sect2 id="Character-Encodings"><title>Character Encodings</title>
    <para>Internally, all characters and strings in &CCL; are in
    UTF-32.  Externally, files or socket streams may encode characters
    in a wide variety of ways.  The International Organization for
    Standardization, widely known as ISO, defines many of these
    character encodings.  &CCL; implements some of these encodings as
    detailed below.  These encodings are part of the specification of
    external formats <xref linkend="External-Formats"/>.  When reading
    from a stream, characters are converted from the specified
    external character encoding to UTF-32.  When writing to a stream,
    characters are converted from UTF-32 to the specified character
    encoding.</para>

    <para>Internally, CHARACTER-ENCODINGs are objects (structures)
    that are named by character encoding keywords (:ISO-8859-1,
    :UTF-8, etc.).  The structures contain attributes of the encoding
    and functions used to encode/decode external data, but unless
    you're trying to define or debug an encoding there's little reason
    to know much about the CHARACTER-ENCODING objects and it's usually
    preferable to refer to a character encoding by its name.
    </para>

    <para>
    </para>

    <sect3><title>Encoding Problems</title>
      <para>On output to streams with character encodings that can
      encode the full range of Unicode&mdash;and on input from any
      stream&mdash;"unencodable characters" are represented using the
      Unicode #\Replacement_Character (= #\U+fffd); the presence of
      such a character usually indicates that something got lost in
      translation.  Either data wasn't encoded properly or there was a
      bug in the decoding process.</para>
    </sect3>

    <sect3><title>Byte Order Marks</title>
      <para>The endianness of a character encoding is sometimes
      explicit, and sometimes not.  For example,
      <literal>:UTF-16BE</literal> indicates big-endian, but
      <literal>:UTF-16</literal> does not specify endianness.  A byte
      order mark is a special character that may appear at the
      beginning of a stream of encoded characters to specify the
      endianness of a multi-byte character encoding.  (It may also be
      used with UTF-8 character encodings, where it is simply used to
      indicate that the encoding is UTF-8.)</para>

      <para>&CCL; writes a byte order mark as the first character
      of a file or socket stream when the endianness of the character
      encoding is not explicit.  &CCL; also expects a byte order
      mark on input from streams where the endianness is not
      explicit. If a byte order mark is missing from input data, that
      data is assumed to be in big-endian order.</para>

      <para>A byte order mark from a UTF-8 encoded input stream is not
      treated specially and just appears as a normal character from
      the input stream.  It is probably a good idea to skip over this
      character.</para>
    </sect3>

  <sect3><title><function>DESCRIBE-CHARACTER-ENCODINGS</function></title>
    <para>The set of character encodings supported by &CCL; can be
    retrieved by calling
    <function>CCL:DESCRIBE-CHARACTER-ENCODINGS</function>.</para>


      <refentry id="f_describe-character-encodings">
	<indexterm zone="f_describe-character-encodings">
	  <primary>[fn-name]</primary>
	</indexterm>

	<refnamediv>
	  <refname>DESCRIBE-CHARACTER-ENCODINGS</refname>
	  <refpurpose>Writes descriptions of defined character
	  encodings to <varname>*terminal-io*</varname>.</refpurpose>
	  <refclass>Function</refclass>
	</refnamediv>

	<refsynopsisdiv>
	  <synopsis>
	    <function>describe-character-encodings</function>
	  </synopsis>
	</refsynopsisdiv>

	<refsect1>
	  <title>Description</title>

	  <para>Writes descriptions of all defined character encodings
	  to <varname>*terminal-io*</varname>.  These descriptions
	  include the names of the encoding's aliases and a doc string
	  which briefly describes each encoding's properties and
	  intended use.</para>
	</refsect1>

	<refsect1>
	  <title>See Also</title>
	 
	  <simplelist type="inline">
	    <member><xref linkend="Character-Encodings"/></member>
	    <member><xref linkend="External-Formats"/></member>
	    <member><xref linkend="Supported-Character-Encodings"/></member>
	  </simplelist>
	</refsect1>
      </refentry>
  </sect3>

  <sect3 id="Supported-Character-Encodings"><title>Supported Character Encodings</title>
     <para>The list of supported encodings is reproduced here.  Most
     encodings have aliases, e.g. the encoding named
     <literal>:ISO-8859-1</literal> can also be referred to by the
     names <literal>:LATIN1</literal> and <literal>:IBM819</literal>,
     among others.  Where possible, the keywordized name of an
     encoding is equivalent to the preferred MIME charset name (and
     the aliases are all registered IANA charset names.)</para>

  <variablelist>
    <varlistentry><term><literal>:ISO-8859-1</literal></term>
       <listitem><para>An 8-bit, fixed-width character encoding in
       which all character codes map to their Unicode
       equivalents. Intended to support most characters used in most
       Western European languages.</para>
       <para>&CCL; uses ISO-8859-1 encoding for
       <varname>*TERMINAL-IO*</varname> and for all streams whose
       EXTERNAL-FORMAT isn't explicitly specified.  The default for
       <varname>*TERMINAL-IO*</varname> can be set via the
       <literal>-K</literal> command-line argument (see <xref
       linkend="Command-Line-Options"/>).
       </para>
       <para>ISO-8859-1 just covers the first 256 Unicode code
       points, where the first 128 code points are equivalent to
       US-ASCII.  That should be pretty much equivalent to what
       earliers versions of &CCL; did that only supported 8-bit characters,
       but it may not be optimal for users working in a particular
       locale.</para>
       <para>Aliases: <literal>:ISO_8859-1, :LATIN1, :L1,
       :IBM819, :CP819, :CSISOLATIN1</literal></para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:ISO-8859-2</literal></term>
       <listitem><para>An 8-bit, fixed-width character encoding in
       which codes #x00-#x9f map to their Unicode equivalents and
       other codes map to other Unicode character values.  Intended to
       provide most characters found in most languages used in
       Central/Eastern Europe.</para>
       <para>Aliases: <literal>:ISO_8859-2, :LATIN-2, :L2,
       :CSISOLATIN2</literal></para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:ISO-8859-3</literal></term>
       <listitem><para>An 8-bit, fixed-width character encoding in
       which codes #x00-#x9f map to their Unicode equivalents and
       other codes map to other Unicode character values.  Intended to
       provide most characters found in most languages used in
       Southern Europe.</para>
       <para>Aliases: <literal>:ISO_8859-3, :LATIN,3 :L3,
       :CSISOLATIN3</literal></para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:ISO-8859-4</literal></term>
       <listitem><para>An 8-bit, fixed-width character encoding in
       which codes #x00-#x9f map to their Unicode equivalents and
       other codes map to other Unicode character values.  Intended to
       provide most characters found in most languages used in
       Northern Europe.</para>
       <para>Aliases: <literal>:ISO_8859-4, :LATIN4, :L4, :CSISOLATIN4</literal></para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:ISO-8859-5</literal></term>
       <listitem><para>An 8-bit, fixed-width character encoding in
       which codes #x00-#x9f map to their Unicode equivalents and
       other codes map to other Unicode character values.  Intended to
       provide most characters found in the Cyrillic
       alphabet.</para>
       <para>Aliases: <literal>:ISO_8859-5, :CYRILLIC, :CSISOLATINCYRILLIC,
       :ISO-IR-144</literal></para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:ISO-8859-6</literal></term>
       <listitem><para>An 8-bit, fixed-width character encoding in
       which codes #x00-#x9f map to their Unicode equivalents and
       other codes map to other Unicode character values.  Intended to
       provide most characters found in the Arabic
       alphabet.</para>
       <para>Aliases: <literal>:ISO_8859-6, :ARABIC, :CSISOLATINARABIC,
       :ISO-IR-127</literal></para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:ISO-8859-7</literal></term>
       <listitem><para>An 8-bit, fixed-width character encoding in
       which codes #x00-#x9f map to their Unicode equivalents and
       other codes map to other Unicode character values.  Intended to
       provide most characters found in the Greek
       alphabet.</para>
       <para>Aliases: <literal>:ISO_8859-7, :GREEK, :GREEK8, :CSISOLATINGREEK,
       :ISO-IR-126, :ELOT_928, :ECMA-118</literal></para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:ISO-8859-8</literal></term>
       <listitem><para>An 8-bit, fixed-width character encoding in
       which codes #x00-#x9f map to their Unicode equivalents and
       other codes map to other Unicode character values.  Intended to
       provide most characters found in the Hebrew
       alphabet.</para>
       <para>Aliases: <literal>:ISO_8859-8, :HEBREW, :CSISOLATINHEBREW,
       :ISO-IR-138</literal></para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:ISO-8859-9</literal></term>
       <listitem><para>An 8-bit, fixed-width character encoding in
       which codes #x00-#xcf map to their Unicode equivalents and
       other codes map to other Unicode character values.  Intended to
       provide most characters found in the Turkish
       alphabet.</para>
       <para>Aliases: <literal>:ISO_8859-9, :LATIN5, :CSISOLATIN5,
       :ISO-IR-148</literal></para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:ISO-8859-10</literal></term>
       <listitem><para>An 8-bit, fixed-width character encoding in
       which codes #x00-#x9f map to their Unicode equivalents and
       other codes map to other Unicode character values.  Intended to
       provide most characters found in Nordic
       alphabets.</para>
       <para>Aliases: <literal>:ISO_8859-10, :LATIN6, :CSISOLATIN6,
       :ISO-IR-157</literal></para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:ISO-8859-11</literal></term>
       <listitem><para>An 8-bit, fixed-width character encoding in
       which codes #x00-#x9f map to their Unicode equivalents and
       other codes map to other Unicode character values.  Intended to
       provide most characters found the Thai
       alphabet.</para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:ISO-8859-13</literal></term>
       <listitem><para>An 8-bit, fixed-width character encoding in
       which codes #x00-#x9f map to their Unicode equivalents and
       other codes map to other Unicode character values.  Intended to
       provide most characters found in Baltic
       alphabets.</para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:ISO-8859-14</literal></term>
       <listitem><para>An 8-bit, fixed-width character encoding in
       which codes #x00-#x9f map to their Unicode equivalents and
       other codes map to other Unicode character values.  Intended to
       provide most characters found in Celtic
       languages.</para>
       <para>Aliases: <literal>:ISO_8859-14, :ISO-IR-199, :LATIN8, :L8,
       :ISO-CELTIC</literal></para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:ISO-8859-15</literal></term>
       <listitem><para>An 8-bit, fixed-width character encoding in
       which codes #x00-#x9f map to their Unicode equivalents and
       other codes map to other Unicode character values.  Intended to
       provide most characters found in Western European languages
       (including the Euro sign and some other characters missing from
       ISO-8859-1.</para>
       <para>Aliases: <literal>:ISO_8859-15, :LATIN9</literal></para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:ISO-8859-16</literal></term>
       <listitem><para>An 8-bit, fixed-width character encoding in
       which codes #x00-#x9f map to their Unicode equivalents and
       other codes map to other Unicode character values.  Intended to
       provide most characters found in Southeast European
       languages.</para>
       <para>Aliases: <literal>:ISO_8859-16, :ISO-IR-199, :LATIN8, :L8,
       :ISO-CELTIC</literal></para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:MACINTOSH</literal></term>
       <listitem><para>An 8-bit, fixed-width character encoding in
       which codes #x00-#x7f map to their Unicode equivalents and
       other codes map to other Unicode character values.
       Traditionally used on Classic MacOS to encode characters used
       in western languages.</para>
       <para>Aliases: <literal>:MACOS-ROMAN, :MACOSROMAN, :MAC-ROMAN,
       :MACROMAN</literal></para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:UCS-2</literal></term>
       <listitem><para>A 16-bit, fixed-length encoding in which
       characters with CHAR-CODEs less than #x10000 can be encoded in
       a single 16-bit word.  The endianness of the encoded data is
       indicated by the endianness of a byte-order-mark character
       (#u+feff) prepended to the data; in the absence of such a
       character on input, the data is assumed to be in big-endian
       order.</para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:UCS-2BE</literal></term>
       <listitem><para>A 16-bit, fixed-length encoding in which
       characters with CHAR-CODEs less than #x10000 can be encoded in
       a single 16-bit big-endian word. The encoded data is implicitly
       big-endian; byte-order-mark characters are not interpreted on
       input or prepended to output.</para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:UCS-2LE</literal></term>
       <listitem><para>A 16-bit, fixed-length encoding in which
       characters with CHAR-CODEs less than #x10000 can be encoded in
       a single 16-bit little-endian word. The encoded data is
       implicitly little-endian; byte-order-mark characters are not
       interpreted on input or prepended to output.</para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:US-ASCII</literal></term>
       <listitem><para>An 7-bit, fixed-width character encoding in
       which all character codes map to their Unicode
       equivalents. </para>
       <para>Aliases: <literal>:CSASCII, :CP63,7 :IBM637, :US,
       :ISO646-US, :ASCII, :ISO-IR-6</literal></para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:UTF-16</literal></term>
       <listitem><para>A 16-bit, variable-length encoding in which
       characters with CHAR-CODEs less than #x10000 can be encoded in
       a single 16-bit word and characters with larger codes can be
       encoded in a pair of 16-bit words.  The endianness of the
       encoded data is indicated by the endianness of a
       byte-order-mark character (#u+feff) prepended to the data; in
       the absence of such a character on input, the data is assumed
       to be in big-endian order. Output is written in native
       byte-order with a leading byte-order mark.</para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:UTF-16BE</literal></term>
       <listitem><para>A 16-bit, variable-length encoding in which
       characters with CHAR-CODEs less than #x10000 can be encoded in
       a single 16-bit big-endian word and characters with larger
       codes can be encoded in a pair of 16-bit big-endian words.  The
       endianness of the encoded data is implicit in the encoding;
       byte-order-mark characters are not interpreted on input or
       prepended to output.</para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:UTF-16LE</literal></term>
       <listitem><para>A 16-bit, variable-length encoding in which
       characters with CHAR-CODEs less than #x10000 can be encoded in
       a single 16-bit little-endian word and characters with larger
       codes can be encoded in a pair of 16-bit little-endian words.
       The endianness of the encoded data is implicit in the encoding;
       byte-order-mark characters are not interpreted on input or
       prepended to output.</para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:UTF-32</literal></term>
       <listitem><para>A 32-bit, fixed-length encoding in which all
       Unicode characters can be encoded in a single 32-bit word.  The
       endianness of the encoded data is indicated by the endianness
       of a byte-order-mark character (#u+feff) prepended to the data;
       in the absence of such a character on input, input data is
       assumed to be in big-endian order.  Output is written in native
       byte order with a leading byte-order mark.</para>
       <para>Alias: <literal>:UTF-4</literal></para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:UTF-32BE</literal></term>
       <listitem><para>A 32-bit, fixed-length encoding in which all
       Unicode characters encoded in a single 32-bit word. The encoded
       data is implicitly big-endian; byte-order-mark characters are
       not interpreted on input or prepended to
       output.</para>
       <para>Alias: <literal>:UCS-4BE</literal></para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:UTF-8</literal></term>
       <listitem><para>An 8-bit, variable-length character encoding in
       which characters with CHAR-CODEs in the range #x00-#x7f can be
       encoded in a single octet; characters with larger code values
       can be encoded in 2 to 4 bytes.</para></listitem>
     </varlistentry>
    <varlistentry><term><literal>:UTF-32LE</literal></term>
       <listitem><para>A 32-bit, fixed-length encoding in which all
       Unicode characters can encoded in a single 32-bit word. The
       encoded data is implicitly little-endian; byte-order-mark
       characters are not interpreted on input or prepended to
       output.</para>
       <para>Alias: <literal>:UCS-4LE</literal></para></listitem>
     </varlistentry>
     <varlistentry><term><literal>:CP932</literal></term>
     <listitem><para>An 8-bit, variable-length character encoding in
     which character code points in the range #x00-#x7f can be encoded
     in a single octet; characters with larger code values can be
     encoded in 2 bytes.</para></listitem>
     </varlistentry>
     <varlistentry><term><literal>:EUCJP</literal></term>
     <listitem><para>An 8-bit, variable-length character encoding in
     which character code points in the range #x00-#x7f can be encoded
     in a single octet; characters with larger code values can be
     encoded in 2 bytes.</para></listitem>
     </varlistentry>
   </variablelist>
 </sect3>

 <sect3><title>Encoding and Decoding Strings</title>
 <para>&CCL; provides functions to encode and decode strings
to and from vectors of type (simple-array (unsigned-byte 8)).</para>

<refentry id="count-characters-in-octet-vector">
  <indexterm zone="count-characters-in-octet-vector">
    <primary>count-characters-in-octet-vector</primary>
  </indexterm>

  <refnamediv>
    <refname>count-characters-in-octet-vector</refname>
    <refpurpose></refpurpose>
    <refclass>Function</refclass>
  </refnamediv>

  <refsynopsisdiv>
    <synopsis>
	<function>count-characters-in-octet-vector</function>
	<parameter>vector</parameter>
	<parameter>&key;</parameter>
	<parameter>start</parameter>
	<parameter>end</parameter>
	<parameter>external-format</parameter>
    </synopsis>
  </refsynopsisdiv>

  <refsect1><title>Description</title>
  <para>
    Returns the number of characters that would be produced by
    decoding <varname>vector</varname> (or the subsequence thereof
    delimited by <varname>start</varname> and <varname>end</varname>)
    according to <varname>external-format</varname>.
  </para>
  </refsect1>
</refentry>

<refentry id="decode-string-from-octets">
  <indexterm zone="decode-string-from-octets">
    <primary>"decode-string-from-octets</primary>
  </indexterm>

  <refnamediv>
    <refname>decode-string-from-octets</refname>
    <refpurpose></refpurpose>
    <refclass>Function</refclass>
  </refnamediv>

  <refsynopsisdiv>
    <synopsis>
	<function>decode-string-from-octets</function>
	<parameter>vector</parameter>
	<parameter>&key;</parameter>
	<parameter>start</parameter>
	<parameter>end</parameter>
	<parameter>external-format</parameter>
	<parameter>string</parameter>
    </synopsis>
  </refsynopsisdiv>


  <refsect1><title>Description</title>
  <para>
    Decodes the octets in <varname>vector</varname> (or the subsequence
    of it delimited by <varname>start</varname> and
    <varname>end</varname>) into a string according
    to <varname>external-format</varname>.
  </para>
  <para>
    If <varname>string</varname> is supplied, output will be written into it.
    It must be large enough to hold the decoded characters.  If <varname>
    string</varname> is not supplied, a new string will be allocated to
    hold the decoded characters.
  </para>
  <para>
    Returns, as multiple values, the decoded string and the position in
    <varname>vector</varname> where the decoding ended.
  </para>
  </refsect1>
</refentry>

<refentry id="encode-string-to-octets">
  <indexterm zone="encode-string-to-octets">
    <primary>encode-string-to-octets</primary>
  </indexterm>

  <refnamediv>
    <refname>encode-string-to-octets</refname>
    <refpurpose></refpurpose>
    <refclass>Function</refclass>
  </refnamediv>

  <refsynopsisdiv>
    <synopsis>
	<function>encode-string-to-octets</function>
	<parameter>string</parameter>
	<parameter>&key;</parameter>
	<parameter>start</parameter>
	<parameter>end</parameter>
	<parameter>external-format</parameter>
	<parameter>use-byte-order-mark</parameter>
	<parameter>vector</parameter>
	<parameter>vector-offset</parameter>
    </synopsis>
  </refsynopsisdiv>


  <refsect1><title>Description</title>
  <para>
    Encodes <varname>string</varname> (or the substring delimited by
    <varname>start</varname> and <varname>end</varname>)
    into <varname>external-format</varname> and returns, as multiple
    values, a vector of octets containing the encoded data and an integer
    that specifies the offset into the vector where the encoded data ends.
  </para>
  <para>
    When <varname>use-byte-order-mark</varname> is true, a byte-order mark
    will be included in the encoded data.
  </para>
  <para>
    If <varname>vector</varname> is supplied, output will be written
    to it.  It must be of type (simple-array (unsigned-byte 8)) and be
    large enough to hold the encoded data.  If it is not supplied, the function
    will allocate a new vector.
  </para>
  <para>
    If <varname>vector-offset</varname> is supplied, data will be written
    into the output vector starting at that offset.
  </para>
  </refsect1>
</refentry>

<refentry id="string-size-in-octets">
  <indexterm zone="string-size-in-octets">
    <primary>string-size-in-octets</primary>
  </indexterm>

  <refnamediv>
    <refname>string-size-in-octets</refname>
    <refpurpose></refpurpose>
    <refclass>Function</refclass>
  </refnamediv>

  <refsynopsisdiv>
    <synopsis>
	<function>string-size-in-octets</function>
	<parameter>string</parameter>
	<parameter>&key;</parameter>
	<parameter>start</parameter>
	<parameter>end</parameter>
	<parameter>external-format</parameter>
	<parameter>use-byte-order-mark</parameter>
    </synopsis>
  </refsynopsisdiv>


  <refsect1><title>Description</title>
  <para>
    Returns the number of octets required to encode
    <varname>string</varname> (or the substring delimited by
    <varname>start</varname> and <varname>end</varname>) into
    <varname>external-format</varname>.
  </para>
  <para>
    When <varname>use-byte-order-mark</varname> is true, the returned
    size will include space for a byte-order marker.
  </para>
  </refsect1>
</refentry>

 </sect3>


  </sect2>

  </sect1>

  <sect1 id="Pathanmes"><title>Pathnames</title>

    <sect2 id="pathname-tilde-expansion">
      <title>Pathname Expansion</title>
      <para>Leading tilde (~) characters in physical pathname namestrings
        are expanded in the way that most shells do:</para>
      
      <para><literal>"~user/..."</literal> can be used to refer to an absolute pathname rooted
        at the home directory of the user named "user".</para>
      
      <para><literal>"~/..."</literal> can be used to refer to an absolute pathname rooted at
        the home directory of the current user.</para>
    </sect2>

    <sect2 id="Predefined-Logical-Hosts"><title>Predefined Logical Hosts</title>

      <para>&CCL; sets up logical pathname translations for logical hosts:  <literal>ccl</literal> and <literal>home</literal></para>

      <indexterm><primary>CCL Logical Host</primary></indexterm>
      <para>The <literal>CCL</literal> logical host should point to the
        <literal>ccl</literal> directory.  It is used for a variety of
        purposes by &CCL; including: locating &CCL; source code,
        <literal>require</literal> and <literal>provide</literal>, accessing
        foreign function information, and the &CCL; build process. It
        is set to the value of the environment variable
        <varname>CCL_DEFAULT_DIRECTORY</varname>, which is set by the
        openmcl shell script <xref linkend="The-ccl-Shell-Script"/>.  If
        <varname>CCL_DEFAULT_DIRECTORY</varname> is not set, then it is set
        to the directory containing the current heap image.</para>
    </sect2>
    
    
    <sect2 id="pathnames-on-darwin">
      <title>OS X (Darwin)</title>
      
      <para>&CCL; assumes that pathname strings are decomposed UTF-8.</para>
    </sect2>
    <sect2 id="pathnames-on-linux">
      <title>Linux</title>
      
      <para>Pathname strings are treated as null-terminated strings
        encoded according to the current locale.</para>
    </sect2>
    <sect2 id="pathnames-on-freebsd">
      <title>FreeBSD</title>
      
      <para>Pathname strings are treated as null-terminated strings
        encoded according to the current locale; a future release may
        change this convention to use UTF-8.</para>
    </sect2>
  </sect1>

  <sect1 id="Memory-Mapped-Files">
    <title>Memory-mapped Files</title>
    <para>In release 1.2 and later, &CCL;
      supports <glossterm linkend="memory_mapped_file">memory-mapped
        files</glossterm>. On operating systems that support memory-mapped
      files (including Mac OS X, Linux, and FreeBSD), the operating
      system can arrange for a range of virtual memory addresses to
      refer to the contents of an open file. As long as the file remains
      open, programs can read values from the file by reading addresses
      in the mapped range.</para>

    <para>Using memory-mapped files may in some cases be more
      efficient than reading the contents of a file into a data
      structure in memory.</para>

    <para>&CCL; provides the
      functions <varname>CCL:MAP-FILE-TO-IVECTOR</varname>
      and <varname>CCL:MAP-FILE-TO-OCTET-VECTOR</varname> to support
      memory-mapping. These functions return vectors whose contents are
      the contents of memory-mapped files. Reading an element of such a
      vector returns data from the corresponding position in the
      file.</para>

    <para>Without memory-mapped files, a common idiom for reading the
      contents of files might be something like this:</para>

    <programlisting>
(let* ((stream (open pathname :direction :input :element-type '(unsigned-byte 8)))
       (vector (make-array (file-size-to-vector-size stream)
                           :element-type '(unsigned-byte 8))))
  (read-sequence vector stream))
    </programlisting>

    <para>Using a memory-mapped files has a result that is the same in
      that, like the above example, it returns a vector whose contents are
      the same as the contents of the file. It differs in that the above
      example creates a new vector in memory and copies the file's
      contents into it; using a memory-mapped file instead arranges for
      the vector's elements to point to the file's contents on disk
      directly, without copying them into memory first.</para>

    <para>The vectors returned by <varname>CCL:MAP-FILE-TO-IVECTOR</varname>
      and <varname>CCL:MAP-FILE-TO-OCTET-VECTOR</varname> are read-only; any
      attempt to change an element of a vector returned by these
      functions results in a memory-access error. &CCL; does not
      currently support writing data to memory-mapped files.</para>

    <para>Vectors created by <varname>CCL:MAP-FILE-TO-IVECTOR</varname>
      and <varname>CCL:MAP-FILE-TO-OCTET-VECTOR</varname> are required to
      respect &CCL;'s limit on the total size of an array. That means
      that you cannot use these functions to create a vector longer
      than <varname>ARRAY-TOTAL-SIZE-LIMIT</varname>, even if the filesystem
      supports file sizes that are larger. The value
      of <varname>ARRAY-TOTAL-SIZE-LIMIT</varname> is <varname>(EXPT 2 24)</varname>
      on 32-but platforms; and <varname>(EXPT 2 56)</varname> on 64-bit
      platforms.</para>

    <para>
      <indexterm zone="map-file-to-ivector"/>
      <command><varname id="map-file-to-ivector">CCL:MAP-FILE-TO-IVECTOR</varname>
        <parameter>pathname</parameter>
        <parameter>element-type</parameter>
        [Function]</command>
    </para>

    <variablelist>
      <varlistentry>
        <term><varname>pathname</varname></term>
        <listitem>
          <para>The pathname of the file to be memory-mapped.</para>
        </listitem>
      </varlistentry>
      
      <varlistentry>
        <term><varname>element-type</varname></term>
        <listitem>
          <para>The element-type of the vector to be
            created. Specified as
            a <glossterm linkend="type-specifier">type-specifier</glossterm>
            that names a subtype of either <varname>SIGNED-BYTE</varname>
            or <varname>UNSIGNED-BYTE</varname>.</para>
        </listitem>
      </varlistentry>
    </variablelist>


    <para>
      The <varname>map-file-to-ivector</varname> function tries to
      open the file at <parameter>pathname</parameter> for reading. If
      successful, the function maps the file's contents to a range of
      virtual addresses. If successful, it returns a read-only vector
      whose element-type is given
      by <parameter>element-type</parameter>, and whose contents are
      the contents of the memory-mapped file.
    </para>

    <para>The returned vector is
      a <glossterm linkend="displaced-array">displaced-array</glossterm>
      whose element-type is <varname>(UPGRADED-ARRAY-ELEMENT-TYPE
        element-type)</varname>. The target of the displaced array is a
      vector of type <varname>(SIMPLE-ARRAY element-type (*))</varname> whose
      elements are the contents of the memory-mapped file.</para>

    <para>Because of alignment issues, the mapped file's contents
      start a few bytes (4 bytes on 32-bit platforms, 8 bytes on
      64-bit platforms) into the vector. The displaced array returned
      by <varname>CCL:MAP-FILE-TO-IVECTOR</varname> hides this overhead, but
      it's usually more efficient to operate on the underlying simple
      1-dimensional array.  Given a displaced array (like the value
      returned by <varname>CCL:MAP-FILE-TO-IVECTOR</varname>), the function
      <varname>ARRAY-DISPLACEMENT</varname> returns the underlying array and
      the displacement index in elements.
    </para>

    <para>Currently, &CCL; supports only read operations on
      memory-mapped files. If you try to change the contents of an array
      returned by <varname>map-file-to-ivector</varname>, &CCL; signals
      a memory error.</para>

    <para>
      <indexterm zone="unmap-ivector"/>
      <command><varname id="unmap-ivector">CCL:UNMAP-IVECTOR</varname>
        <parameter>displaced-array</parameter>
        [Function]</command>
    </para>

    <para>If the argument is a displaced-array returned
      by <varname>map-file-to-ivector</varname>, and if it has not yet
      been unmapped by this function,
      then <varname>unmap-ivector</varname> undoes the memory mapping,
      closes the mapped file, and changes the displaced-array so that its
      target is an empty vector (of length zero).</para>

    <para>
      <indexterm zone="map-file-to-octet-vector"/>
      <command><varname id="map-file-to-octet-vector">CCL:MAP-FILE-TO-OCTET-VECTOR</varname>
        <parameter>pathname</parameter>
        [Function]</command>
    </para>

    <para>This function is a synonym for <varname>(CCL:MAP-FILE-TO-IVECTOR
        pathname '(UNSIGNED-BYTE 8))</varname> It is provided as a convenience
      for the common case of memory-mapping a file as a vector of
      bytes.</para>

    <para>
      <indexterm zone="unmap-octet-vector"/>
      <command><varname id="unmap-octet-vector">CCL:UNMAP-OCTET-VECTOR</varname>
        <parameter>displaced-array</parameter>
        [Function]</command>
    </para>

    <para>This function is a synonym
      for <varname>(CCL:UNMAP-IVECTOR)</varname></para>
  </sect1>

  <!-- ============================================================ -->
  <sect1 id="Static_Variables">
    <title>Static Variables</title>

    <para>&CCL; supports the definition
      of <glossterm linkend="static_variable">static
        variables</glossterm>, whose values are the same across threads,
      and which may not be dynamically bound. The value of a static
      variable is thus the same across all threads; changing the value
      in one thread changes it for all threads.</para> 

    <para>Attempting to dynamically rebind a static variable (for
      instance, by using <varname>LET</varname>, or using the variable name as
      a parameter in a <varname>LAMBDA</varname> form) signals an
      error. Static variables are shared global resources; a dynamic
      binding is private to a single thread.</para>

    <para>Static variables therefore provide a simple way to share
      mutable state across threads. They also provide a simple way to
      introduce race conditions and obscure bugs into your code, since
      every thread reads and writes the same instance of a given static
      variable. You must take care, therefore, in how you change the
      values of static variables, and use normal multithreaded
      programming techniques, such as locks or semaphores, to protect
      against race conditions.</para>

    <para>In &CCL;, access to a static variable is usually faster than
      access to a special variable that has not been declared
      static.</para>

    <para>
      <indexterm zone="defstatic"/>
      <command><varname id="defstatic">DEFSTATIC</varname>
        <parameter>var</parameter>
        <parameter>value</parameter>
        &key;
        <parameter>doc-string</parameter>
        [Macro]</command>
    </para>
    
    <variablelist>
      <varlistentry>
        <term><varname>var</varname></term>
        <listitem>
          <para>The name of the new static variable.</para>
        </listitem>
      </varlistentry>
      
      <varlistentry>
        <term><varname>value</varname></term>
        <listitem>
          <para>The initial value of the new static variable.</para>
        </listitem>
      </varlistentry>
      
      <varlistentry>
        <term><varname>doc-string</varname></term>
        <listitem>
          <para>A documentation string that is assigned to the new
            variable.</para>
        </listitem>
      </varlistentry>
    </variablelist>

    <para>Proclaims the
      variable <glossterm linkend="special_variable">special</glossterm>,
      assigns the variable the supplied value, and assigns
      the <varname>doc-string</varname> to the
      variable's <varname>VARIABLE</varname> documentation. Marks the
      variable static, preventing any attempt to dynamically rebind
      it. Any attempt to dynamically rebind <varname>var</varname>
      signals an error.</para>
  </sect1>

  <!-- ============================================================ -->
  <sect1 id="Saving-Applications">
    <title>Saving Applications</title>
    <indexterm zone="Saving-Applications">
      <primary>save-application</primary>
    </indexterm>

    <para>&CCL; provides the
      function <literal>CCL:SAVE-APPLICATION</literal>, which creates a file
      containing an archived Lisp memory image.</para>

    <para>&CCL; consists of a small executable called the
      Lisp <glossterm linkend="lisp_image">kernel</glossterm>, which
      implements the very lowest level features of the Lisp system, and
      an <glossterm linkend="lisp_image">image</glossterm>, which
      contains the in-memory representation of most of the Lisp system,
      including functions, data structures, variables, and so on. When
      you start &CCL;, you are launching the kernel, which then locates
      and reads an image file, restoring the archived image in
      memory. Once the image is fully restored, the Lisp system is
      running.</para>

    <para>Using <literal>CCL:SAVE-APPLICATION</literal>, you can create a
      file that contains a modified image, one that includes any changes
      you've made to the running Lisp system. If you later pass your
      image file to the &CCL; kernel as a command-line parameter, it
      then loads your image file instead of its default one, and &CCL;
      starts up with your modifications.</para>

    <para>If this scenario seems to you like a convenient way to
      create an application, that's just as intended. You can create an
      application by modifying the running Lisp until it does what you
      want, then use <literal>CCL:SAVE-APPLICATION</literal> to preserve your
      changes and later load them for use.</para>

    <para>In fact, you can go further than that. You can replace
      &CCL;'s <glossterm linkend="toplevel_function">toplevel
        function</glossterm> with your own, and then, when the image is
      loaded, the Lisp system immediately performs your tasks rather
      than the default tasks that make it a Lisp development system. If
      you save an image in which you have done this, the resulting Lisp
      system is your tool rather than a Lisp development system.</para>

    <para>You can go a step further still. You can
      tell <literal>CCL:SAVE-APPLICATION</literal> to prepend the Lisp kernel
      to the image file. Doing this makes the resulting image into a
      self-contained executable binary. When you run the resulting file,
      the Lisp kernel immediately loads the attached image file and runs
      your saved system. The Lisp system that starts up can have any
      behavior you choose. It can be a Lisp development system, but with
      your customizations; or it can immediately perform some task of
      your design, making it a specialized tool rather than a general
      development system.</para>

    <para>In other words, you can develop any application you like by
      interactively modifying &CCL; until it does what you want, then
      using <literal>CCL:SAVE-APPLICATION</literal> to preserve your changes
      in an executable image.</para>

    <para>On Mac OS X,
      the <link linkend="application_builder">application builder</link>
      uses <literal>CCL:SAVE-APPLICATION</literal> to create the executable
      portion of the <glossterm linkend="application_bundle">application
        bundle</glossterm>. Double-clicking the application bundle runs
      the executable image created
      by <literal>CCL:SAVE-APPLICATION</literal>.</para>

    <para>Also on Mac OS X, &CCL; supports an object type
      called <literal>MACPTR</literal>, which is the type of pointers into the
      foreign (Mac OS) heap. Examples of
      commonly-user <literal>MACPTR</literal> objects are Cocoa windows and
      other dynamically-allocated Mac OS system objects.</para>

    <para>Because a <literal>MACPTR</literal> object is a pointer into a
      foreign heap that exists for the lifetime of the running Lisp
      process, and because a saved image is used by loading it into a
      brand new Lisp process, saved <literal>MACPTR</literal> objects cannot
      be relied on to point to the same things when reconstituted from a
      saved image. In fact, a restored <literal>MACPTR</literal> object might
      point to anything at all&mdash;for example an arbitrary location
      in the middle of a block of code, or a completely nonexistent
      virtual address.</para> 

    <para>For that reason, <literal>CCL:SAVE-APPLICATION</literal> converts
      all <literal>MACPTR</literal> objects to <literal>DEAD-MACPTR</literal>
      objects when writing them to an image
      file. A <literal>DEAD-MACPTR</literal> is functionally identical to
      a <literal>MACPTR</literal>, except that code that operates
      on <literal>MACPTR</literal> objects distinguishes them
      from <literal>DEAD-MACPTR</literal> objects and can handle them
      appropriately&mdash;signaling errors, for example.</para>

    <para>As of &CCL; 1.2, there is one exception to the conversion
      of <literal>MACPTR</literal> to <literal>DEAD-MACPTR</literal> objects:
      a <literal>MACPTR</literal> object that points to the address 0 is not
      converted, because address 0 can always be relied upon to refer to
      the same thing.</para>

	<indexterm zone="Saving-Applications">
	  <primary>+NULL-PTR+</primary>
	</indexterm>
    <para>As of &CCL; 1.2, the constant <literal>CCL:+NULL-PTR+</literal>
      refers to a <literal>MACPTR</literal> object that points to address 0.</para>

    <para>On all supported platforms, you can
      use <literal>CCL:SAVE-APPLICATION</literal> to create a command-line
      tool that runs the same way any command-line program
      does. Alternatively, if you choose not to prepend the kernel, you
      can save an image and then later run it by passing it as a
      command-line parameter to the <literal>opencml</literal>
      or <literal>opencml64</literal> script.</para>

    <para>
      <indexterm zone="save-application"/>
      <command><varname id="save-application">SAVE-APPLICATION</varname>
        <parameter>filename</parameter>
        &key;
        <parameter>toplevel-function</parameter>
        <parameter>init-file</parameter>
        <parameter>error-handler</parameter>
        <parameter>application-class</parameter>
        <parameter>clear-clos-caches</parameter>
        <parameter>(purify t)</parameter>
        <parameter>impurify</parameter>
        <parameter>(mode #o644)</parameter>
        <parameter>prepend-kernel</parameter>
        [Function]</command>
    </para>
    
    <variablelist>
      <varlistentry>
        <term><varname>filename</varname></term>
        <listitem>
          <para>The pathname of the file to be created when &CCL;
            saves the application.</para>
        </listitem>
      </varlistentry>
      
      <varlistentry>
        <term><varname>toplevel-function</varname></term>
        <listitem>
          <para>The function to be executed after startup is
            complete. The toplevel is a function of no arguments that
            performs whatever actions the lisp system should perform
            when launched with this image.</para>
          <para>If this parameter is not supplied, &CCL; uses its
            default toplevel. The default toplevel runs
            the <glossterm linkend="REPL">read-eval-print
              loop</glossterm>.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term><varname>init-file</varname></term>
        <listitem>
          <para>The pathname of a Lisp file to be loaded when the
            image starts up. You can place initialization expressions in
            this file, and use it to customize the behavior of the Lisp
            system when it starts up.</para>
        </listitem>
      </varlistentry>
      
      <varlistentry>
        <term><varname>error-handler</varname></term>
        <listitem>
          <para>The error-handling mode for the saved image. The
            supplied value determines what happens when an error is not
            handled by the saved image. Valid values
            are <literal>:quit</literal> (Lisp exits with an error
            message); <literal>:quit-quietly</literal> (Lisp exits without an
            error message); or <literal>:listener</literal> (Lisp enters a
            break loop, enabling you to debug the problem by interacting
            in a listener). If you don't supply this parameter, the
            saved image uses the default error handler
            (<literal>:listener</literal>).</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term><varname>application-class</varname></term>
        <listitem>
          <para>The CLOS class that represents the saved Lisp
            application. Normally you don't need to supply this
            parameter; <literal>CCL:SAVE-APPLICATION</literal> uses the
            class <literal>CCL:LISP-DEVELOPMENT-SYSTEM</literal>. In some
            cases you may choose to create a custom application class;
            in that case, pass the name of the class as the value for
            this parameter.</para>
        </listitem>
      </varlistentry>
      
      <varlistentry>
        <term><varname>clear-clos-caches</varname></term>
        <listitem>
          <para>If true, ensures that CLOS caches are emptied before
            saving the image. Normally you don't need to supply this
            parameter, but if for some reason you want to ensure the
            CLOS caches are clear when the image starts up, you can pass
            any true value.</para>
        </listitem>
      </varlistentry>
      
      
    </variablelist>

    <para></para>
  </sect1>

  <sect1 id="floating-point">
    <title>Floating Point Numbers</title>

    <para>
      In &CCL;, the Common Lisp types short-float and single-float are
      implemented as IEEE single precision values; double-float and
      long-float are IEEE double precision values.  On 64-bit
      platforms, single-floats are immediate values (like fixnums and
      characters).
    </para>

  <para>
    Floating-point exceptions are generally enabled and detected.  By
    default, threads start up with overflow, division-by-zero, and
    invalid enabled, and the rounding mode is set to nearest. The
    functions <varname>SET-FPU-MODE</varname> and
    <varname>GET-FPU-MODE</varname> provide user control over
    floating-point behavior.
  </para>

  <refentry id="f_get-fpu-mode">
    <indexterm zone="f_get-fpu-mode">
      <primary>get-fpu-mode</primary>
    </indexterm>

    <refnamediv>
      <refname>GET-FPU-MODE</refname>
      <refpurpose>
	Return the state of exception-enable and rounding-mode control
	flags for the current thread.
      </refpurpose>
      <refclass>Function</refclass>
    </refnamediv>
    
    <refsynopsisdiv>
      <synopsis><function>get-fpu-mode</function> &optional; mode</synopsis>
    </refsynopsisdiv>

    <refsect1>
      <title>Arguments and Values</title>
      <variablelist>
	<varlistentry>
	  <term>mode</term>
	  <listitem>
	    <para>
	      One of the keywords :rounding-mode, :overflow,
	      :underflow, :division-by-zero, :invalid, :inexact.
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
    </refsect1>
    
    <refsect1>
      <title>Description</title>
      <para>
	If <varname>mode</varname> is supplied, returns the value of
	the corresponding control flag for the current thread.
      </para>
      <para>
	Otherwise, returns a list of keyword/value pairs which
	describe the floating-point exception-enable and rounding-mode
	control flags for the current thread.
      </para>
      <variablelist>
	<varlistentry>
	  <term>rounding-mode</term>
	  <listitem>
	    <para>
	      One of :nearest, :zero, :positive, :negative
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term>overflow, underflow, division-by-zero, invalid, inexact
	  </term>
	  <listitem>
	    <para>
	      If true, the floating-point exception is signaled.
	      If NIL, it is masked.
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
    </refsect1>
  </refentry>

  <refentry id="f_set-fpu-mode">
    <indexterm zone="f_set-fpu-mode">
      <primary>set-fpu-mode</primary>
    </indexterm>

    <refnamediv>
      <refname>SET-FPU-MODE</refname>
      <refpurpose>
	Set the state of exception-enable and rounding-mode control
	flags for the current thread.
      </refpurpose>
      <refclass>Function</refclass>
    </refnamediv>
    
    <refsynopsisdiv>
      <synopsis><function>set-fpu-mode</function> &key;
      rounding-mode overflow underflow division-by-zero
      invalid inexact</synopsis>
    </refsynopsisdiv>

    <refsect1>
      <title>Arguments and Values</title>
      <variablelist>
	<varlistentry>
	  <term>rounding-mode</term>
	  <listitem>
	    <para>
	      If supplied, must be one of :nearest, :zero, :positive, or
	      :negative.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term>overflow, underflow, division-by-zero, invalid, inexact</term>
	  <listitem>
	    <para>NIL to mask the exception, T to signal it.</para>
	  </listitem>
	</varlistentry>
      </variablelist>
    </refsect1>
    
    <refsect1>
      <title>Description</title>
      <para>
	Sets the current thread's exception-enable and rounding-mode
	control flags to the indicated values for arguments that are
	supplied, and preserves the values assoicated with those
	that aren't supplied.
      </para>
    </refsect1>
  </refentry>
  </sect1>
</chapter>
